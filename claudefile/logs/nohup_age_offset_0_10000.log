/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:74: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  Y = torch.load(base_path + 'Y_tensor.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  E = torch.load(base_path + 'E_matrix.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:76: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  G = torch.load(base_path + 'G_matrix.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:79: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  essentials = torch.load(base_path + 'model_essentials.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:98: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  refs = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/reference_trajectories.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
Loading components...
Loaded all components successfully!

=== Predicting for age offset 0 years ===
Clusters match exactly: True
Censoring verification for age offset 0:
  Total event times changed: 3460577
  Max cap applied: 41.0
  Min cap applied: 10.0
  Patient 0: enrollment=69, current=69, cap=39.0, max_event_time=39.0
  Patient 1: enrollment=44, current=44, cap=14.0, max_event_time=14.0
  Patient 100: enrollment=52, current=52, cap=22.0, max_event_time=22.0
Training model for age offset 0...
         90476615 function calls (90455504 primitive calls) in 4858.485 seconds

   Ordered by: cumulative time
   List reduced from 4210 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   41.355   41.355 4858.486 4858.486 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.013    0.000 3809.952   19.050 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 3809.939   19.050 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.003    0.000 3809.928   19.050 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 3809.925   19.050 3809.925   19.050 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  141.425    0.707  975.444    4.877 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  381.663    1.908  749.223    3.746 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  260.224    0.000  260.224    0.000 {built-in method torch.cholesky_solve}
 43531800  115.700    0.000  115.700    0.000 {built-in method torch.sum}
      400   11.058    0.028   53.691    0.134 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.005    0.000   30.413    0.076 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   30.406    0.076   30.406    0.076 {built-in method torch.einsum}
      200    1.057    0.005   29.563    0.148 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   24.205    0.040   24.205    0.040 {built-in method torch.log}
      600   16.658    0.028   16.658    0.028 {built-in method torch.clamp}
      600    0.003    0.000   12.148    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   12.144    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   12.142    0.020   12.142    0.020 {built-in method torch.rsub}
      400    8.057    0.020    8.057    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      400    1.306    0.003    1.306    0.003 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_0_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_0_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 1 years ===
Clusters match exactly: True
Censoring verification for age offset 1:
  Total event times changed: 3457771
  Max cap applied: 42.0
  Min cap applied: 11.0
  Patient 0: enrollment=69, current=70, cap=40.0, max_event_time=40.0
  Patient 1: enrollment=44, current=45, cap=15.0, max_event_time=15.0
  Patient 100: enrollment=52, current=53, cap=23.0, max_event_time=23.0
Training model for age offset 1...
         88903873 function calls (88901873 primitive calls) in 3842.601 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   41.230   41.230 3842.601 3842.601 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2815.403   14.077 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2815.393   14.077 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2815.382   14.077 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2815.380   14.077 2815.380   14.077 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  143.696    0.718  955.338    4.777 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  372.197    1.861  729.064    3.645 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  251.346    0.000  251.346    0.000 {built-in method torch.cholesky_solve}
 43531800  114.637    0.000  114.637    0.000 {built-in method torch.sum}
      400   11.571    0.029   52.495    0.131 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      200    0.912    0.005   28.904    0.145 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      400    0.005    0.000   28.664    0.072 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   28.658    0.072   28.658    0.072 {built-in method torch.einsum}
      600   22.660    0.038   22.660    0.038 {built-in method torch.log}
      600   16.780    0.028   16.780    0.028 {built-in method torch.clamp}
      600    0.003    0.000   11.720    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.717    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.714    0.020   11.714    0.020 {built-in method torch.rsub}
      400    7.761    0.019    7.761    0.019 {method 'float' of 'torch._C.TensorBase' objects}
      200    0.004    0.000    1.350    0.007 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/optim/optimizer.py:467(wrapper)


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_1_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_1_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 2 years ===
Clusters match exactly: True
Censoring verification for age offset 2:
  Total event times changed: 3454504
  Max cap applied: 43.0
  Min cap applied: 12.0
  Patient 0: enrollment=69, current=71, cap=41.0, max_event_time=41.0
  Patient 1: enrollment=44, current=46, cap=16.0, max_event_time=16.0
  Patient 100: enrollment=52, current=54, cap=24.0, max_event_time=24.0
Training model for age offset 2...
         88903873 function calls (88901873 primitive calls) in 3135.855 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   39.479   39.479 3135.855 3135.855 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2144.791   10.724 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2144.781   10.724 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2144.769   10.724 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2144.767   10.724 2144.767   10.724 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  129.346    0.647  924.950    4.625 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  363.537    1.818  719.646    3.598 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  247.945    0.000  247.945    0.000 {built-in method torch.cholesky_solve}
 43531800  117.126    0.000  117.126    0.000 {built-in method torch.sum}
      400   10.130    0.025   46.982    0.117 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.004    0.000   26.412    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   26.407    0.066   26.407    0.066 {built-in method torch.einsum}
      200    0.790    0.004   25.561    0.128 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   20.874    0.035   20.874    0.035 {built-in method torch.log}
      600   14.400    0.024   14.400    0.024 {built-in method torch.clamp}
      600    0.003    0.000   10.879    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   10.876    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   10.873    0.018   10.873    0.018 {built-in method torch.rsub}
      400    7.297    0.018    7.297    0.018 {method 'float' of 'torch._C.TensorBase' objects}
      400    0.964    0.002    0.964    0.002 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_2_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_2_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 3 years ===
Clusters match exactly: True
Censoring verification for age offset 3:
  Total event times changed: 3450897
  Max cap applied: 44.0
  Min cap applied: 13.0
  Patient 0: enrollment=69, current=72, cap=42.0, max_event_time=42.0
  Patient 1: enrollment=44, current=47, cap=17.0, max_event_time=17.0
  Patient 100: enrollment=52, current=55, cap=25.0, max_event_time=25.0
Training model for age offset 3...
         88903873 function calls (88901873 primitive calls) in 3164.845 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   40.312   40.312 3164.845 3164.845 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2167.399   10.837 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2167.389   10.837 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2167.377   10.837 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2167.375   10.837 2167.375   10.837 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  135.639    0.678  929.576    4.648 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  361.491    1.807  717.238    3.586 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  247.423    0.000  247.423    0.000 {built-in method torch.cholesky_solve}
 43531800  117.228    0.000  117.228    0.000 {built-in method torch.sum}
      400   10.833    0.027   48.167    0.120 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      200    0.782    0.004   26.299    0.131 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      400    0.004    0.000   26.083    0.065 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   26.078    0.065   26.078    0.065 {built-in method torch.einsum}
      600   20.754    0.035   20.754    0.035 {built-in method torch.log}
      600   15.560    0.026   15.560    0.026 {built-in method torch.clamp}
      600    0.003    0.000   11.016    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.013    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.010    0.018   11.010    0.018 {built-in method torch.rsub}
      400    7.286    0.018    7.286    0.018 {method 'float' of 'torch._C.TensorBase' objects}
      400    0.968    0.002    0.968    0.002 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_3_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_3_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 4 years ===
Clusters match exactly: True
Censoring verification for age offset 4:
  Total event times changed: 3446983
  Max cap applied: 45.0
  Min cap applied: 14.0
  Patient 0: enrollment=69, current=73, cap=43.0, max_event_time=43.0
  Patient 1: enrollment=44, current=48, cap=18.0, max_event_time=18.0
  Patient 100: enrollment=52, current=56, cap=26.0, max_event_time=26.0
Training model for age offset 4...
         88903873 function calls (88901873 primitive calls) in 3190.959 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   40.507   40.507 3190.959 3190.959 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2187.310   10.937 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2187.300   10.936 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2187.288   10.936 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2187.286   10.936 2187.286   10.936 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  135.682    0.678  935.730    4.679 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  364.283    1.821  722.772    3.614 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  249.182    0.000  249.182    0.000 {built-in method torch.cholesky_solve}
 43531800  118.255    0.000  118.255    0.000 {built-in method torch.sum}
      400   10.577    0.026   48.199    0.120 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.004    0.000   26.409    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   26.404    0.066   26.404    0.066 {built-in method torch.einsum}
      200    0.789    0.004   26.138    0.131 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   20.921    0.035   20.921    0.035 {built-in method torch.log}
      600   15.566    0.026   15.566    0.026 {built-in method torch.clamp}
      600    0.003    0.000   11.086    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.083    0.018 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.081    0.018   11.081    0.018 {built-in method torch.rsub}
      400    7.336    0.018    7.336    0.018 {method 'float' of 'torch._C.TensorBase' objects}
      200    0.004    0.000    0.968    0.005 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/optim/optimizer.py:467(wrapper)


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_4_sex_0_10000_try2_withpcs.pt
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_4_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 5 years ===
Clusters match exactly: True
Censoring verification for age offset 5:
  Total event times changed: 3442990
  Max cap applied: 46.0
  Min cap applied: 15.0
  Patient 0: enrollment=69, current=74, cap=44.0, max_event_time=44.0
  Patient 1: enrollment=44, current=49, cap=19.0, max_event_time=19.0
  Patient 100: enrollment=52, current=57, cap=27.0, max_event_time=27.0
Training model for age offset 5...
         88903873 function calls (88901873 primitive calls) in 3784.839 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   42.237   42.237 3784.839 3784.839 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.011    0.000 2713.407   13.567 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2713.395   13.567 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2713.384   13.567 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2713.381   13.567 2713.381   13.567 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  149.576    0.748  998.452    4.992 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  383.962    1.920  763.750    3.819 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  263.623    0.000  263.623    0.000 {built-in method torch.cholesky_solve}
 43531800  125.547    0.000  125.547    0.000 {built-in method torch.sum}
      400   11.294    0.028   53.549    0.134 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.006    0.000   29.810    0.075 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   29.803    0.075   29.803    0.075 {built-in method torch.einsum}
      200    0.901    0.005   29.230    0.146 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   23.639    0.039   23.639    0.039 {built-in method torch.log}
      600   17.076    0.028   17.076    0.028 {built-in method torch.clamp}
      600    0.003    0.000   12.137    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   12.134    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   12.131    0.020   12.131    0.020 {built-in method torch.rsub}
      400    8.022    0.020    8.022    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      400    1.158    0.003    1.158    0.003 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_5_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_5_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 6 years ===
Clusters match exactly: True
Censoring verification for age offset 6:
  Total event times changed: 3438636
  Max cap applied: 47.0
  Min cap applied: 16.0
  Patient 0: enrollment=69, current=75, cap=45.0, max_event_time=45.0
  Patient 1: enrollment=44, current=50, cap=20.0, max_event_time=20.0
  Patient 100: enrollment=52, current=58, cap=28.0, max_event_time=28.0
Training model for age offset 6...
         88903873 function calls (88901873 primitive calls) in 3629.431 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   40.896   40.896 3629.431 3629.431 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2591.374   12.957 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2591.363   12.957 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2591.352   12.957 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2591.349   12.957 2591.349   12.957 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  143.209    0.716  967.295    4.836 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  374.405    1.872  740.798    3.704 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  255.873    0.000  255.873    0.000 {built-in method torch.cholesky_solve}
 43531800  119.645    0.000  119.645    0.000 {built-in method torch.sum}
      400   10.882    0.027   52.182    0.130 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.005    0.000   29.227    0.073 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   29.221    0.073   29.221    0.073 {built-in method torch.einsum}
      200    0.912    0.005   28.415    0.142 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   23.059    0.038   23.059    0.038 {built-in method torch.log}
      600   16.600    0.028   16.600    0.028 {built-in method torch.clamp}
      600    0.003    0.000   11.807    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.803    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.800    0.020   11.800    0.020 {built-in method torch.rsub}
      400    7.870    0.020    7.870    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      400    1.152    0.003    1.152    0.003 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_6_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_6_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 7 years ===
Clusters match exactly: True
Censoring verification for age offset 7:
  Total event times changed: 3434135
  Max cap applied: 48.0
  Min cap applied: 17.0
  Patient 0: enrollment=69, current=76, cap=46.0, max_event_time=46.0
  Patient 1: enrollment=44, current=51, cap=21.0, max_event_time=21.0
  Patient 100: enrollment=52, current=59, cap=29.0, max_event_time=29.0
Training model for age offset 7...
         88903873 function calls (88901873 primitive calls) in 3638.181 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   41.122   41.122 3638.181 3638.181 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.011    0.000 2599.787   12.999 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2599.776   12.999 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2599.765   12.999 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2599.762   12.999 2599.762   12.999 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  146.414    0.732  966.793    4.834 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  374.375    1.872  736.452    3.682 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  254.268    0.000  254.268    0.000 {built-in method torch.cholesky_solve}
 43531800  116.592    0.000  116.592    0.000 {built-in method torch.sum}
      400   11.053    0.028   52.906    0.132 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.005    0.000   29.706    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   29.700    0.074   29.700    0.074 {built-in method torch.einsum}
      200    0.859    0.004   28.768    0.144 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   23.720    0.040   23.720    0.040 {built-in method torch.log}
      600   16.773    0.028   16.773    0.028 {built-in method torch.clamp}
      600    0.003    0.000   11.837    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.833    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.830    0.020   11.830    0.020 {built-in method torch.rsub}
      400    7.880    0.020    7.880    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      200    0.004    0.000    1.248    0.006 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/optim/optimizer.py:467(wrapper)


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_7_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_7_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 8 years ===
Clusters match exactly: True
Censoring verification for age offset 8:
  Total event times changed: 3429657
  Max cap applied: 49.0
  Min cap applied: 18.0
  Patient 0: enrollment=69, current=77, cap=47.0, max_event_time=47.0
  Patient 1: enrollment=44, current=52, cap=22.0, max_event_time=22.0
  Patient 100: enrollment=52, current=60, cap=30.0, max_event_time=30.0
Training model for age offset 8...
         88903873 function calls (88901873 primitive calls) in 3953.182 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   41.170   41.170 3953.182 3953.182 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.011    0.000 2896.809   14.484 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2896.797   14.484 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2896.786   14.484 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2896.784   14.484 2896.784   14.484 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  153.151    0.766  983.069    4.915 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  377.892    1.889  743.471    3.717 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  256.515    0.000  256.515    0.000 {built-in method torch.cholesky_solve}
 43531800  118.031    0.000  118.031    0.000 {built-in method torch.sum}
      400   11.150    0.028   54.729    0.137 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.005    0.000   30.611    0.077 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   30.605    0.077   30.605    0.077 {built-in method torch.einsum}
      200    1.089    0.005   30.539    0.153 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   24.809    0.041   24.809    0.041 {built-in method torch.log}
      600   17.409    0.029   17.409    0.029 {built-in method torch.clamp}
      600    0.003    0.000   11.969    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   11.965    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   11.962    0.020   11.962    0.020 {built-in method torch.rsub}
      400    7.946    0.020    7.946    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      400    1.319    0.003    1.319    0.003 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_8_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_8_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 9 years ===
Clusters match exactly: True
Censoring verification for age offset 9:
  Total event times changed: 3424745
  Max cap applied: 50.0
  Min cap applied: 19.0
  Patient 0: enrollment=69, current=78, cap=48.0, max_event_time=48.0
  Patient 1: enrollment=44, current=53, cap=23.0, max_event_time=23.0
  Patient 100: enrollment=52, current=61, cap=31.0, max_event_time=31.0
Training model for age offset 9...
         88903873 function calls (88901873 primitive calls) in 4203.061 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   42.336   42.336 4203.061 4203.061 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.012    0.000 3125.585   15.628 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 3125.573   15.628 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 3125.561   15.628 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 3125.559   15.628 3125.559   15.628 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  154.733    0.774 1001.006    5.005 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  382.138    1.911  758.097    3.790 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  259.774    0.000  259.774    0.000 {built-in method torch.cholesky_solve}
 43531800  125.062    0.000  125.062    0.000 {built-in method torch.sum}
      400   11.803    0.030   58.088    0.145 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.006    0.000   32.376    0.081 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   32.369    0.081   32.369    0.081 {built-in method torch.einsum}
      200    1.100    0.006   32.313    0.162 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   24.862    0.041   24.862    0.041 {built-in method torch.log}
      600   18.210    0.030   18.210    0.030 {built-in method torch.clamp}
      600    0.003    0.000   12.143    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   12.140    0.020 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   12.136    0.020   12.136    0.020 {built-in method torch.rsub}
      400    8.039    0.020    8.039    0.020 {method 'float' of 'torch._C.TensorBase' objects}
      400    1.428    0.004    1.428    0.004 {built-in method torch.softmax}


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_9_sex_0_10000_try2_withpcs.pt
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:163: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_psi = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_psi_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/forAWS_test_0_10000.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  initial_clusters = torch.load('/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/initial_clusters_400k.pt')
/Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_9_sex_0_10000_try2_withpcs.pt

=== Predicting for age offset 10 years ===
Clusters match exactly: True
Censoring verification for age offset 10:
  Total event times changed: 3419210
  Max cap applied: 51.0
  Min cap applied: 20.0
  Patient 0: enrollment=69, current=79, cap=49.0, max_event_time=49.0
  Patient 1: enrollment=44, current=54, cap=24.0, max_event_time=24.0
  Patient 100: enrollment=52, current=62, cap=32.0, max_event_time=32.0
Training model for age offset 10...
         88903873 function calls (88901873 primitive calls) in 3186.677 seconds

   Ordered by: cumulative time
   List reduced from 152 to 20 due to restriction <20>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   38.470   38.470 3186.677 3186.677 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:329(fit)
      200    0.010    0.000 2246.055   11.230 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000 2246.045   11.230 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000 2246.033   11.230 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200 2246.031   11.230 2246.031   11.230 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  125.093    0.625  876.203    4.381 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:230(compute_loss)
      200  342.436    1.712  679.103    3.396 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:287(compute_gp_prior_loss)
 43461600  234.089    0.000  234.089    0.000 {built-in method torch.cholesky_solve}
 43531800  110.924    0.000  110.924    0.000 {built-in method torch.sum}
      400    9.462    0.024   44.893    0.112 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:221(forward)
      400    0.004    0.000   25.619    0.064 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)
      400   25.613    0.064   25.613    0.064 {built-in method torch.einsum}
      200    0.776    0.004   24.643    0.123 /Users/sarahurbut/aladynoulli2/pyScripts/clust_huge_amp.py:403(analyze_signature_responses)
      600   19.946    0.033   19.946    0.033 {built-in method torch.log}
      600   13.455    0.022   13.455    0.022 {built-in method torch.clamp}
      600    0.003    0.000   10.370    0.017 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:33(wrapped)
      600    0.003    0.000   10.367    0.017 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:1026(__rsub__)
      600   10.365    0.017   10.365    0.017 {built-in method torch.rsub}
      400    6.903    0.017    6.903    0.017 {method 'float' of 'torch._C.TensorBase' objects}
      200    0.004    0.000    0.992    0.005 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/optim/optimizer.py:467(wrapper)


Generated predictions: pi shape = torch.Size([10000, 348, 52])
Saved predictions to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/pi_enroll_age_offset_10_sex_0_10000_try2_withpcs.pt
Saved model to: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/model_enroll_age_offset_10_sex_0_10000_try2_withpcs.pt
