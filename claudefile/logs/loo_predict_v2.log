================================================================================
LOO PREDICTION â€” REPARAM v2
================================================================================
Prediction batches: 5 (50000 patients)
Output: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/
================================================================================

Loading data...
Y: torch.Size([407878, 348, 52]), E: torch.Size([407878, 348]), G: torch.Size([407878, 36])

Loading v2 training checkpoints...
  Found 40 checkpoints
  Loaded 40 checkpoints
Loaded 40 v2 checkpoints
Full-pool: kappa=5.5382, mean|gamma|=0.0768

================================================================================
BATCH 1/5: samples 0-10000 (LOO: exclude batch 0)
================================================================================
  LOO kappa=5.5450, mean|gamma|=0.0768
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
Pre-calculated phi GP loss: 26.0463
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 5.545047
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Initializing delta (reparam) with 20 disease + 1 healthy
  lambda = mean(gamma) + delta (gamma in forward)
Epoch 0 (REPARAM): Loss=18.6153, LR=1.0e-01
Epoch 10 (REPARAM): Loss=83.5974, LR=9.9e-02
Epoch 20 (REPARAM): Loss=37.8710, LR=9.7e-02
Epoch 30 (REPARAM): Loss=24.2329, LR=9.4e-02
Epoch 40 (REPARAM): Loss=19.1745, LR=9.0e-02
Epoch 50 (REPARAM): Loss=17.2495, LR=8.5e-02
Epoch 60 (REPARAM): Loss=16.4122, LR=7.9e-02
Epoch 70 (REPARAM): Loss=15.9503, LR=7.2e-02
Epoch 80 (REPARAM): Loss=15.6410, LR=6.5e-02
Epoch 90 (REPARAM): Loss=15.4070, LR=5.7e-02
Epoch 100 (REPARAM): Loss=15.2198, LR=5.0e-02
Epoch 110 (REPARAM): Loss=15.0676, LR=4.2e-02
Epoch 120 (REPARAM): Loss=14.9443, LR=3.4e-02
Epoch 130 (REPARAM): Loss=14.8460, LR=2.7e-02
Epoch 140 (REPARAM): Loss=14.7698, LR=2.1e-02
Epoch 150 (REPARAM): Loss=14.7129, LR=1.5e-02
Epoch 160 (REPARAM): Loss=14.6726, LR=1.0e-02
Epoch 170 (REPARAM): Loss=14.6462, LR=6.0e-03
Epoch 180 (REPARAM): Loss=14.6305, LR=3.2e-03
Epoch 190 (REPARAM): Loss=14.6224, LR=1.5e-03
  Loss: 14.6187, Time: 5.5 min
  Saved: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/pi_enroll_fixedphi_sex_0_10000.pt

================================================================================
BATCH 2/5: samples 10000-20000 (LOO: exclude batch 1)
================================================================================
  LOO kappa=5.5402, mean|gamma|=0.0768
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
Pre-calculated phi GP loss: 26.2268
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 5.540187
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Initializing delta (reparam) with 20 disease + 1 healthy
  lambda = mean(gamma) + delta (gamma in forward)
Epoch 0 (REPARAM): Loss=18.7203, LR=1.0e-01
Epoch 10 (REPARAM): Loss=83.4014, LR=9.9e-02
Epoch 20 (REPARAM): Loss=37.8745, LR=9.7e-02
Epoch 30 (REPARAM): Loss=24.2862, LR=9.4e-02
Epoch 40 (REPARAM): Loss=19.2447, LR=9.0e-02
Epoch 50 (REPARAM): Loss=17.3206, LR=8.5e-02
Epoch 60 (REPARAM): Loss=16.4777, LR=7.9e-02
Epoch 70 (REPARAM): Loss=16.0101, LR=7.2e-02
Epoch 80 (REPARAM): Loss=15.6959, LR=6.5e-02
Epoch 90 (REPARAM): Loss=15.4571, LR=5.7e-02
Epoch 100 (REPARAM): Loss=15.2659, LR=5.0e-02
Epoch 110 (REPARAM): Loss=15.1101, LR=4.2e-02
Epoch 120 (REPARAM): Loss=14.9838, LR=3.4e-02
Epoch 130 (REPARAM): Loss=14.8833, LR=2.7e-02
Epoch 140 (REPARAM): Loss=14.8053, LR=2.1e-02
Epoch 150 (REPARAM): Loss=14.7470, LR=1.5e-02
Epoch 160 (REPARAM): Loss=14.7058, LR=1.0e-02
Epoch 170 (REPARAM): Loss=14.6787, LR=6.0e-03
Epoch 180 (REPARAM): Loss=14.6627, LR=3.2e-03
Epoch 190 (REPARAM): Loss=14.6544, LR=1.5e-03
  Loss: 14.6506, Time: 6.0 min
  Saved: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/pi_enroll_fixedphi_sex_10000_20000.pt

================================================================================
BATCH 3/5: samples 20000-30000 (LOO: exclude batch 2)
================================================================================
  LOO kappa=5.5405, mean|gamma|=0.0772
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
Pre-calculated phi GP loss: 26.1357
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 5.540534
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Initializing delta (reparam) with 20 disease + 1 healthy
  lambda = mean(gamma) + delta (gamma in forward)
Epoch 0 (REPARAM): Loss=18.5117, LR=1.0e-01
Epoch 10 (REPARAM): Loss=83.4627, LR=9.9e-02
Epoch 20 (REPARAM): Loss=37.7691, LR=9.7e-02
Epoch 30 (REPARAM): Loss=24.1208, LR=9.4e-02
Epoch 40 (REPARAM): Loss=19.0733, LR=9.0e-02
Epoch 50 (REPARAM): Loss=17.1528, LR=8.5e-02
Epoch 60 (REPARAM): Loss=16.3169, LR=7.9e-02
Epoch 70 (REPARAM): Loss=15.8559, LR=7.2e-02
Epoch 80 (REPARAM): Loss=15.5465, LR=6.5e-02
Epoch 90 (REPARAM): Loss=15.3117, LR=5.7e-02
Epoch 100 (REPARAM): Loss=15.1236, LR=5.0e-02
Epoch 110 (REPARAM): Loss=14.9702, LR=4.2e-02
Epoch 120 (REPARAM): Loss=14.8458, LR=3.4e-02
Epoch 130 (REPARAM): Loss=14.7467, LR=2.7e-02
Epoch 140 (REPARAM): Loss=14.6697, LR=2.1e-02
Epoch 150 (REPARAM): Loss=14.6123, LR=1.5e-02
Epoch 160 (REPARAM): Loss=14.5716, LR=1.0e-02
Epoch 170 (REPARAM): Loss=14.5448, LR=6.0e-03
Epoch 180 (REPARAM): Loss=14.5290, LR=3.2e-03
Epoch 190 (REPARAM): Loss=14.5208, LR=1.5e-03
  Loss: 14.5171, Time: 5.8 min
  Saved: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/pi_enroll_fixedphi_sex_20000_30000.pt

================================================================================
BATCH 4/5: samples 30000-40000 (LOO: exclude batch 3)
================================================================================
  LOO kappa=5.5342, mean|gamma|=0.0768
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
Pre-calculated phi GP loss: 26.0058
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 5.534207
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Initializing delta (reparam) with 20 disease + 1 healthy
  lambda = mean(gamma) + delta (gamma in forward)
Epoch 0 (REPARAM): Loss=18.6665, LR=1.0e-01
Epoch 10 (REPARAM): Loss=83.8259, LR=9.9e-02
Epoch 20 (REPARAM): Loss=38.0083, LR=9.7e-02
Epoch 30 (REPARAM): Loss=24.3657, LR=9.4e-02
Epoch 40 (REPARAM): Loss=19.3176, LR=9.0e-02
Epoch 50 (REPARAM): Loss=17.4056, LR=8.5e-02
Epoch 60 (REPARAM): Loss=16.5795, LR=7.9e-02
Epoch 70 (REPARAM): Loss=16.1282, LR=7.2e-02
Epoch 80 (REPARAM): Loss=15.8286, LR=6.5e-02
Epoch 90 (REPARAM): Loss=15.6026, LR=5.7e-02
Epoch 100 (REPARAM): Loss=15.4221, LR=5.0e-02
Epoch 110 (REPARAM): Loss=15.2752, LR=4.2e-02
Epoch 120 (REPARAM): Loss=15.1560, LR=3.4e-02
Epoch 130 (REPARAM): Loss=15.0610, LR=2.7e-02
Epoch 140 (REPARAM): Loss=14.9873, LR=2.1e-02
Epoch 150 (REPARAM): Loss=14.9322, LR=1.5e-02
Epoch 160 (REPARAM): Loss=14.8932, LR=1.0e-02
Epoch 170 (REPARAM): Loss=14.8675, LR=6.0e-03
Epoch 180 (REPARAM): Loss=14.8523, LR=3.2e-03
Epoch 190 (REPARAM): Loss=14.8445, LR=1.5e-03
  Loss: 14.8409, Time: 5.8 min
  Saved: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/pi_enroll_fixedphi_sex_30000_40000.pt

================================================================================
BATCH 5/5: samples 40000-50000 (LOO: exclude batch 4)
================================================================================
  LOO kappa=5.5428, mean|gamma|=0.0768
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
Pre-calculated phi GP loss: 26.0828
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 5.542798
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Initializing delta (reparam) with 20 disease + 1 healthy
  lambda = mean(gamma) + delta (gamma in forward)
Epoch 0 (REPARAM): Loss=18.7204, LR=1.0e-01
Epoch 10 (REPARAM): Loss=83.6667, LR=9.9e-02
Epoch 20 (REPARAM): Loss=37.9780, LR=9.7e-02
Epoch 30 (REPARAM): Loss=24.3382, LR=9.4e-02
Epoch 40 (REPARAM): Loss=19.2804, LR=9.0e-02
Epoch 50 (REPARAM): Loss=17.3568, LR=8.5e-02
Epoch 60 (REPARAM): Loss=16.5213, LR=7.9e-02
Epoch 70 (REPARAM): Loss=16.0601, LR=7.2e-02
Epoch 80 (REPARAM): Loss=15.7508, LR=6.5e-02
Epoch 90 (REPARAM): Loss=15.5162, LR=5.7e-02
Epoch 100 (REPARAM): Loss=15.3282, LR=5.0e-02
Epoch 110 (REPARAM): Loss=15.1751, LR=4.2e-02
Epoch 120 (REPARAM): Loss=15.0509, LR=3.4e-02
Epoch 130 (REPARAM): Loss=14.9519, LR=2.7e-02
Epoch 140 (REPARAM): Loss=14.8751, LR=2.1e-02
Epoch 150 (REPARAM): Loss=14.8177, LR=1.5e-02
Epoch 160 (REPARAM): Loss=14.7770, LR=1.0e-02
Epoch 170 (REPARAM): Loss=14.7503, LR=6.0e-03
Epoch 180 (REPARAM): Loss=14.7345, LR=3.2e-03
Epoch 190 (REPARAM): Loss=14.7264, LR=1.5e-03
  Loss: 14.7226, Time: 5.8 min
  Saved: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/pi_enroll_fixedphi_sex_40000_50000.pt

================================================================================
LOO PREDICTION COMPLETE in 29 min
Output: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_reparam_v2_loo/
================================================================================
