
============================================================
REPARAM v2 NO KAPPA: samples 0 to 10000
Epochs: 500, LR: 0.1, grad_clip: 5.0
kappa = 1.0 (FIXED, not learned)
============================================================

G_with_sex shape: (10000, 47)
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized_reparam.py:74: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized_reparam.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized_reparam.py:86: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)

Cluster Sizes:
Cluster 0: 14 diseases
Cluster 1: 7 diseases
Cluster 2: 21 diseases
Cluster 3: 15 diseases
Cluster 4: 17 diseases
Cluster 5: 16 diseases
Cluster 6: 57 diseases
Cluster 7: 18 diseases
Cluster 8: 13 diseases
Cluster 9: 11 diseases
Cluster 10: 18 diseases
Cluster 11: 12 diseases
Cluster 12: 26 diseases
Cluster 13: 7 diseases
Cluster 14: 9 diseases
Cluster 15: 8 diseases
Cluster 16: 7 diseases
Cluster 17: 11 diseases
Cluster 18: 6 diseases
Cluster 19: 55 diseases
Initializing with 20 disease states + 1 healthy state (REPARAM)
Reparameterized init complete: gamma, psi in NLL path; delta, epsilon have GP prior.
Initializing with 20 disease states + 1 healthy state (REPARAM)
Reparameterized init complete: gamma, psi in NLL path; delta, epsilon have GP prior.

Training with cosine annealing + gradient clipping (NO KAPPA)...
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized_reparam.py:245: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
Epoch    0: Loss=62.4138, LR=1.0e-01, kappa=1.0 (fixed), |gamma|=0.1007, time=0.0min
Epoch   10: Loss=218.5383, LR=1.0e-01, kappa=1.0 (fixed), |gamma|=0.0694, time=0.2min
Epoch   20: Loss=93.8538, LR=1.0e-01, kappa=1.0 (fixed), |gamma|=0.0662, time=0.5min
Epoch   30: Loss=63.4781, LR=9.9e-02, kappa=1.0 (fixed), |gamma|=0.0680, time=0.7min
Epoch   40: Loss=62.6934, LR=9.8e-02, kappa=1.0 (fixed), |gamma|=0.0711, time=0.9min
Epoch   50: Loss=60.4733, LR=9.7e-02, kappa=1.0 (fixed), |gamma|=0.0774, time=1.2min
Epoch   60: Loss=58.7846, LR=9.6e-02, kappa=1.0 (fixed), |gamma|=0.0837, time=1.4min
Epoch   70: Loss=57.8109, LR=9.5e-02, kappa=1.0 (fixed), |gamma|=0.0902, time=1.6min
Epoch   80: Loss=57.1913, LR=9.4e-02, kappa=1.0 (fixed), |gamma|=0.0964, time=1.9min
Epoch   90: Loss=56.7265, LR=9.2e-02, kappa=1.0 (fixed), |gamma|=0.1027, time=2.1min
Epoch  100: Loss=56.3178, LR=9.0e-02, kappa=1.0 (fixed), |gamma|=0.1087, time=2.4min
Epoch  110: Loss=55.9308, LR=8.8e-02, kappa=1.0 (fixed), |gamma|=0.1145, time=2.6min
Epoch  120: Loss=55.5603, LR=8.6e-02, kappa=1.0 (fixed), |gamma|=0.1206, time=2.9min
Epoch  130: Loss=55.2056, LR=8.4e-02, kappa=1.0 (fixed), |gamma|=0.1272, time=3.2min
Epoch  140: Loss=54.8612, LR=8.2e-02, kappa=1.0 (fixed), |gamma|=0.1340, time=3.4min
Epoch  150: Loss=54.5264, LR=7.9e-02, kappa=1.0 (fixed), |gamma|=0.1407, time=3.7min
Epoch  160: Loss=54.1944, LR=7.7e-02, kappa=1.0 (fixed), |gamma|=0.1484, time=4.0min
Epoch  170: Loss=53.8679, LR=7.4e-02, kappa=1.0 (fixed), |gamma|=0.1557, time=4.3min
Epoch  180: Loss=53.5446, LR=7.1e-02, kappa=1.0 (fixed), |gamma|=0.1631, time=4.7min
Epoch  190: Loss=53.2227, LR=6.8e-02, kappa=1.0 (fixed), |gamma|=0.1700, time=5.0min
Epoch  200: Loss=52.9045, LR=6.6e-02, kappa=1.0 (fixed), |gamma|=0.1757, time=5.3min
Epoch  210: Loss=52.5828, LR=6.3e-02, kappa=1.0 (fixed), |gamma|=0.1801, time=5.6min
Epoch  220: Loss=52.2623, LR=5.9e-02, kappa=1.0 (fixed), |gamma|=0.1833, time=5.9min
Epoch  230: Loss=51.9437, LR=5.6e-02, kappa=1.0 (fixed), |gamma|=0.1853, time=6.2min
Epoch  240: Loss=51.6253, LR=5.3e-02, kappa=1.0 (fixed), |gamma|=0.1864, time=6.6min
Epoch  250: Loss=51.3100, LR=5.0e-02, kappa=1.0 (fixed), |gamma|=0.1867, time=6.9min
Epoch  260: Loss=50.9998, LR=4.7e-02, kappa=1.0 (fixed), |gamma|=0.1863, time=7.2min
Epoch  270: Loss=50.6958, LR=4.4e-02, kappa=1.0 (fixed), |gamma|=0.1854, time=7.5min
Epoch  280: Loss=50.4018, LR=4.1e-02, kappa=1.0 (fixed), |gamma|=0.1840, time=7.8min
Epoch  290: Loss=50.1197, LR=3.8e-02, kappa=1.0 (fixed), |gamma|=0.1829, time=8.1min
Epoch  300: Loss=49.8510, LR=3.5e-02, kappa=1.0 (fixed), |gamma|=0.1815, time=8.4min
Epoch  310: Loss=49.5974, LR=3.2e-02, kappa=1.0 (fixed), |gamma|=0.1799, time=8.7min
Epoch  320: Loss=49.3603, LR=2.9e-02, kappa=1.0 (fixed), |gamma|=0.1783, time=9.0min
Epoch  330: Loss=49.1403, LR=2.6e-02, kappa=1.0 (fixed), |gamma|=0.1769, time=9.3min
Epoch  340: Loss=48.9380, LR=2.4e-02, kappa=1.0 (fixed), |gamma|=0.1754, time=9.6min
Epoch  350: Loss=48.7535, LR=2.1e-02, kappa=1.0 (fixed), |gamma|=0.1740, time=9.9min
Epoch  360: Loss=48.5863, LR=1.9e-02, kappa=1.0 (fixed), |gamma|=0.1728, time=10.2min
Epoch  370: Loss=48.4361, LR=1.6e-02, kappa=1.0 (fixed), |gamma|=0.1717, time=10.6min
Epoch  380: Loss=48.3018, LR=1.4e-02, kappa=1.0 (fixed), |gamma|=0.1707, time=10.9min
Epoch  390: Loss=48.1826, LR=1.2e-02, kappa=1.0 (fixed), |gamma|=0.1699, time=11.2min
Epoch  400: Loss=48.0776, LR=1.0e-02, kappa=1.0 (fixed), |gamma|=0.1691, time=11.6min
Epoch  410: Loss=47.9860, LR=8.5e-03, kappa=1.0 (fixed), |gamma|=0.1685, time=12.0min
Epoch  420: Loss=47.9067, LR=7.0e-03, kappa=1.0 (fixed), |gamma|=0.1680, time=12.4min
Epoch  430: Loss=47.8387, LR=5.6e-03, kappa=1.0 (fixed), |gamma|=0.1676, time=12.7min
Epoch  440: Loss=47.7807, LR=4.4e-03, kappa=1.0 (fixed), |gamma|=0.1672, time=13.1min
Epoch  450: Loss=47.7316, LR=3.3e-03, kappa=1.0 (fixed), |gamma|=0.1670, time=13.4min
Epoch  460: Loss=47.6900, LR=2.5e-03, kappa=1.0 (fixed), |gamma|=0.1668, time=13.8min
Epoch  470: Loss=47.6546, LR=1.8e-03, kappa=1.0 (fixed), |gamma|=0.1666, time=14.1min
Epoch  480: Loss=47.6240, LR=1.4e-03, kappa=1.0 (fixed), |gamma|=0.1665, time=14.5min
Epoch  490: Loss=47.5968, LR=1.1e-03, kappa=1.0 (fixed), |gamma|=0.1665, time=14.9min

Training complete: 500 epochs in 15.2 min
Final loss: 47.5738

Final params: kappa=1.0 (fixed), mean|gamma|=0.1664
Saved to: /Users/sarahurbut/Library/CloudStorage/Dropbox/censor_e_batchrun_vectorized_REPARAM_v2_nokappa/enrollment_model_REPARAM_NOKAPPA_W0.0001_batch_0_10000.pt
