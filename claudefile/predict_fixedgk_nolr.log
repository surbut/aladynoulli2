/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

================================================================================
Aladyn Prediction Script - Fixed Phi/Psi/Gamma/Kappa Mode
================================================================================
Trained model: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt
Pooled gamma/kappa: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma_nolr.pt
Output directory: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/
Batch size: 10000
================================================================================

Loading components...
Loaded all components successfully!
Loading covariates data...
Loaded 407878 samples from covariates file
Loading reference trajectories...
Loading initial_psi...
Loaded initial_psi shape: (20, 348)
Loading master checkpoint from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt...
Master checkpoint description: Pooled phi from all retrospective batches + initial_psi
Loaded pooled phi shape: (21, 348, 52)
Loaded psi_total shape: (21, 348)
Loading pooled gamma and kappa from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma_nolr.pt...
Loaded pooled gamma shape: (47, 21)
Loaded pooled kappa: 2.932930

⚠️  Skipping first 5 batches, starting from batch 5

Will process 36 batches of 10000 samples
Total samples: 407878
Processing samples: 50000 to 407878


================================================================================
BATCH 1/36: Processing samples 50000 to 60000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4102

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.3987

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8194

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6010

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4083

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.8589

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.7288

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.2452

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.0870

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.0264

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.9545

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.8874

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8303

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.7712

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7135

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6558

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.5987

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5422

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.4864

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.4304

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_50000_60000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_50000_60000.pt
Cleaning up memory...
✓ Batch 1/36 complete! (Time: 12.43 minutes)

================================================================================
BATCH 2/36: Processing samples 60000 to 70000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4564

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4383

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8599

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6468

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4530

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9023

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.7712

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.2868

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1277

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.0661

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.9933

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9251

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8669

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8067

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7478

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6890

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6307

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5730

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5162

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.4594

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_60000_70000.pt
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_60000_70000.pt
Cleaning up memory...
✓ Batch 2/36 complete! (Time: 13.92 minutes)

================================================================================
BATCH 3/36: Processing samples 70000 to 80000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4871

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4523

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8974

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6844

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4876

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9378

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8080

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3247

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1667

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.1063

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.0346

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9674

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9102

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8509

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7926

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7345

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6767

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6193

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5627

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.5063

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_70000_80000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_70000_80000.pt
Cleaning up memory...
✓ Batch 3/36 complete! (Time: 14.15 minutes)

================================================================================
BATCH 4/36: Processing samples 80000 to 90000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5053

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4972

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.9106

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6974

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.5041

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9545

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8240

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3403

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1820

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.1211

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.0490

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9814

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9236

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8637

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.8050

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7463

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6879

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6302

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.5733

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.5158

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_80000_90000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_80000_90000.pt
Cleaning up memory...
✓ Batch 4/36 complete! (Time: 13.95 minutes)

================================================================================
BATCH 5/36: Processing samples 90000 to 100000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6526

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6507

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0597

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8413

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6479

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.0985

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9679

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.4839

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.3253

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.2643

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.1920

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.1244

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.0668

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0072

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9488

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.8905

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8327

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7755

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7190

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.6623

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.009
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_90000_100000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_90000_100000.pt
Cleaning up memory...
✓ Batch 5/36 complete! (Time: 13.36 minutes)

================================================================================
BATCH 6/36: Processing samples 100000 to 110000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4344

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4306

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8448

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6239

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4304

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.8805

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.7494

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.2648

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1056

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.0441

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.9712

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9029

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8446

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.7842

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7251

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6659

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6073

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5492

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.4919

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.4345

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_100000_110000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_100000_110000.pt
Cleaning up memory...
✓ Batch 6/36 complete! (Time: 12.38 minutes)

================================================================================
BATCH 7/36: Processing samples 110000 to 120000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4850

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4860

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8940

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6743

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4829

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9345

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8042

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3206

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1624

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.1017

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.0296

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9621

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9044

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8445

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7857

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7267

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6680

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5521

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.4943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_110000_120000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_110000_120000.pt
Cleaning up memory...
✓ Batch 7/36 complete! (Time: 12.57 minutes)

================================================================================
BATCH 8/36: Processing samples 120000 to 130000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2508

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.2608

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6598

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4381

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2474

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6989

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.5685

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.0847

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9262

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.8654

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.7932

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.7255

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.6677

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6077

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5491

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.4904

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4320

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3743

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.3172

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.2600

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.031 ± 0.026
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_120000_130000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_120000_130000.pt
Cleaning up memory...
✓ Batch 8/36 complete! (Time: 11.09 minutes)

================================================================================
BATCH 9/36: Processing samples 130000 to 140000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6231

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6041

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0272

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8128

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6195

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.0697

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9384

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.4540

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.2947

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.2329

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.1598

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.0912

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0324

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.9716

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9118

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.8520

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.7926

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7335

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.6754

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.015
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.6166

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.017
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_130000_140000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_130000_140000.pt
Cleaning up memory...
✓ Batch 9/36 complete! (Time: 11.12 minutes)

================================================================================
BATCH 10/36: Processing samples 140000 to 150000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5303

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.5090

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.9359

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.7207

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.5270

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9773

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8467

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3626

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.2039

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.1428

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.0705

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.0028

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9451

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8852

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.8267

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7683

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.7100

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6525

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5958

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.5389

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.027
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_140000_150000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_140000_150000.pt
Cleaning up memory...
✓ Batch 10/36 complete! (Time: 11.80 minutes)

================================================================================
BATCH 11/36: Processing samples 150000 to 160000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2129

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.2219

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6231

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4026

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2130

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6655

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.5357

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.0528

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.8954

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.8356

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.7644

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.6977

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.6410

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.5822

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5246

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.4669

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3532

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.2972

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.2412

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_150000_160000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_150000_160000.pt
Cleaning up memory...
✓ Batch 11/36 complete! (Time: 12.39 minutes)

================================================================================
BATCH 12/36: Processing samples 160000 to 170000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6546

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6452

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0564

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8418

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6493

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.0986

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9664

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.4811

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.3211

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.2588

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.1851

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.1161

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0572

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.9962

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9366

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.8770

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8179

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7596

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7020

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.6445

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_160000_170000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_160000_170000.pt
Cleaning up memory...
✓ Batch 12/36 complete! (Time: 12.82 minutes)

================================================================================
BATCH 13/36: Processing samples 170000 to 180000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4343

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4153

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8358

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6253

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 40
Loss: 19.4319

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 50
Loss: 17.8821

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 60
Loss: 16.7513

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 70
Loss: 16.2672

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 16.1084

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.0473

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.9750

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9073

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8497

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.7901

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7318

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6735

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6157

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 170
Loss: 15.5585

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.5023

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.4457

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.031 ± 0.025
  Theta for others: 0.027
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_170000_180000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_170000_180000.pt
Cleaning up memory...
✓ Batch 13/36 complete! (Time: 12.71 minutes)

================================================================================
BATCH 14/36: Processing samples 180000 to 190000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7226

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.7008

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.1301

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.9107

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.7152

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1646

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 17.0325

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.5473

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 16.3873

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.3249

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.2512

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.1821

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.1230

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0618

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 16.0020

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.9422

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8828

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.8242

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7665

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.7084

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.027
  Proportion difference: 0.003
Generating predictions...
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_180000_190000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_180000_190000.pt
Cleaning up memory...
✓ Batch 14/36 complete! (Time: 11.47 minutes)

================================================================================
BATCH 15/36: Processing samples 190000 to 200000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6614

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6473

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0605

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8516

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6580

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1075

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9763

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 70
Loss: 16.4920

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 16.3329

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.2715

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.1987

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.1306

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0724

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0123

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9532

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.8943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8357

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7779

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7207

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.6635

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.027
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_190000_200000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_190000_200000.pt
Cleaning up memory...
✓ Batch 15/36 complete! (Time: 11.98 minutes)

================================================================================
BATCH 16/36: Processing samples 200000 to 210000
================================================================================
Subsetting data...
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3788

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.3773

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.7876

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.5716

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.3777

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.8278

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6972

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.2136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.0553

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.9946

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.9226

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.8551

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.7975

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.7379

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.6794

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6211

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.5629

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5056

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.4489

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.3922

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_200000_210000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_200000_210000.pt
Cleaning up memory...
✓ Batch 16/36 complete! (Time: 12.17 minutes)

================================================================================
BATCH 17/36: Processing samples 210000 to 220000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6434

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6127

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0461

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8332

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6384

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.0883

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9571

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.4727

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.3136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.2521

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.1794

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.1114

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0535

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.9936

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9351

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.8767

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8187

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7615

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7049

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.6483

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.015
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_210000_220000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_210000_220000.pt
Cleaning up memory...
✓ Batch 17/36 complete! (Time: 12.17 minutes)

================================================================================
BATCH 18/36: Processing samples 220000 to 230000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.1659

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.1648

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.5711

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.3564

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.1650

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6166

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.4867

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.0035

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.8459

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.7858

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.7144

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.6476

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.5908

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.5320

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.4745

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.4169

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.3597

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3033

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.2478

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.1919

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_220000_230000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_220000_230000.pt
Cleaning up memory...
✓ Batch 18/36 complete! (Time: 12.12 minutes)

================================================================================
BATCH 19/36: Processing samples 230000 to 240000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.1966

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.1877

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6043

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.3904

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.1968

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6469

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.5166

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.0333

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.8753

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.8149

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.7433

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.6764

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.6194

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.5604

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5028

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.4451

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.3880

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3315

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.2758

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.2201

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_230000_240000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_230000_240000.pt
Cleaning up memory...
✓ Batch 19/36 complete! (Time: 12.19 minutes)

================================================================================
BATCH 20/36: Processing samples 240000 to 250000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6911

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6872

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0970

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8804

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6854

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1359

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 17.0048

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.5200

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.3605

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.2985

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.2252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.1564

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0975

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0365

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9769

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.9172

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8581

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7995

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.7417

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.6838

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_240000_250000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_240000_250000.pt
Cleaning up memory...
✓ Batch 20/36 complete! (Time: 13.54 minutes)

================================================================================
BATCH 21/36: Processing samples 250000 to 260000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5744

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.5732

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.9785

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.7637

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.5691

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.0182

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8866

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.4014

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.2415

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.1792

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.1055

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.0365

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9774

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.9164

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.8566

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7970

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.7378

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6795

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.6218

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.5642

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_250000_260000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_250000_260000.pt
Cleaning up memory...
✓ Batch 21/36 complete! (Time: 15.17 minutes)

================================================================================
BATCH 22/36: Processing samples 260000 to 270000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4238

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4410

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8340

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6153

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4227

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 50
Loss: 17.8724

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 60
Loss: 16.7415

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 70
Loss: 16.2574

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 16.0986

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.0373

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.9646

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.8965

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.7777

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7182

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6587

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.5997
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5413

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.4835

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.4255

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_260000_270000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_260000_270000.pt
Cleaning up memory...
✓ Batch 22/36 complete! (Time: 13.00 minutes)

================================================================================
BATCH 23/36: Processing samples 270000 to 280000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4605

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4517

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8657

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6505

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4570

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9081

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.7775

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.2933

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.1346

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.0733

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.0006

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.9325

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.8742

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8137

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7545

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.6953

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6364

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.5783

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5210

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.4638

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.020
  Theta for others: 0.030
  Proportion difference: 0.003

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_270000_280000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_270000_280000.pt
Cleaning up memory...
✓ Batch 23/36 complete! (Time: 12.02 minutes)

================================================================================
BATCH 24/36: Processing samples 280000 to 290000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2923

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.3079

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.7009

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4809

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2910

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.7423

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6124

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.1292

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9715

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.9113

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.8398

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.7729

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.7160

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6569

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5989

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.5409

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4832

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.4261

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.3696

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.3131

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_280000_290000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_280000_290000.pt
Cleaning up memory...
✓ Batch 24/36 complete! (Time: 11.76 minutes)

================================================================================
BATCH 25/36: Processing samples 290000 to 300000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5440

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.5297

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.9532

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.7341

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.5405

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9903

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8594

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3752

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.2163

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.1548

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.0822

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.0142

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.9562

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8962

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8372

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7785

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.7201

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6625

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.6057

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.5486

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_290000_300000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_290000_300000.pt
Cleaning up memory...
✓ Batch 25/36 complete! (Time: 12.55 minutes)

================================================================================
BATCH 26/36: Processing samples 300000 to 310000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.2458

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6509

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4303

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2394

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6922

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.5632

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.0811

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9243

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.8651

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.7945

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.7284

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.6723

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6140

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5569

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.4997

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4428

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3863

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.3304

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.2741

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_300000_310000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_300000_310000.pt
Cleaning up memory...
✓ Batch 26/36 complete! (Time: 11.28 minutes)

================================================================================
BATCH 27/36: Processing samples 310000 to 320000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2068

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.1981

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6140

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.3993

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2070

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.6575

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.5276

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 70
Loss: 16.0444

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 15.8867

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.8264

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.7549

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.6879

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.6308

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.5716

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.4554

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.3978

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.3407

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.2843

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.2279

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_310000_320000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_310000_320000.pt
Cleaning up memory...
✓ Batch 27/36 complete! (Time: 11.70 minutes)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

================================================================================
BATCH 28/36: Processing samples 320000 to 330000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7349

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.7080

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.1355

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.9233

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.7296

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1788

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 17.0471

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.5621

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.4022

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.3400

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.2665

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.1976

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.1387

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0777

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 16.0180

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.9583

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8991

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.8405

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7827

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.7247

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.027
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_320000_330000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_320000_330000.pt
Cleaning up memory...
✓ Batch 28/36 complete! (Time: 11.71 minutes)

================================================================================
BATCH 29/36: Processing samples 330000 to 340000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2895

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.3142

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6976

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4780

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2895

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.7411

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6109

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.1277

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9700

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 15.9098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 15.8382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.7711

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.7140

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6548

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5968

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.5388

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4813

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.4244

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 180
Loss: 15.3686

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.3123

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.008
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.031 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_330000_340000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_330000_340000.pt
Cleaning up memory...
✓ Batch 29/36 complete! (Time: 11.72 minutes)

================================================================================
BATCH 30/36: Processing samples 340000 to 350000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6828

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.6671

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.0839

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.8736

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.6776

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1261

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.9944

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.5092

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.3494

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.2871

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.2134

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.1444

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.0853
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 16.0241

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.9642

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.9043

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.8449

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.7860

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.7280

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.6697

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_340000_350000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_340000_350000.pt
Cleaning up memory...
✓ Batch 30/36 complete! (Time: 11.72 minutes)

================================================================================
BATCH 31/36: Processing samples 350000 to 360000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7359

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.7266

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 50.1458

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.9258

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.7332

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 18.1840

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 17.0537

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.5700

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.4116

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.3510

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.2791

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.2118

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 16.1547

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.002

Epoch 130
Loss: 16.0955

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 16.0375

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.9796

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.9221

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.8651

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.8089

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.7525

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_350000_360000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_350000_360000.pt
Cleaning up memory...
✓ Batch 31/36 complete! (Time: 11.37 minutes)

================================================================================
BATCH 32/36: Processing samples 360000 to 370000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3004

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.2932

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.7120

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4871

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2979

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.7505

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6209

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.1378

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9803

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.9203

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.8491

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.7825

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.7259

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6672

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.6098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.5524

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4954

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.4392

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.3837

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.3282

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_360000_370000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_360000_370000.pt
Cleaning up memory...
✓ Batch 32/36 complete! (Time: 11.45 minutes)

================================================================================
BATCH 33/36: Processing samples 370000 to 380000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4824

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.4968

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8949

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.6697

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.4775

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9287

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.7976

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3132

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 80
Loss: 16.1543

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 90
Loss: 16.0930

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.0205

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.9526

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.8948

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8350

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.7766

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7184

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.6607

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6038

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5479

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.4917

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_370000_380000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_370000_380000.pt
Cleaning up memory...
✓ Batch 33/36 complete! (Time: 11.06 minutes)

================================================================================
BATCH 34/36: Processing samples 380000 to 390000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2840

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.3055

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.6929

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.4715

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.2839

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.7355

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6057

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.1226

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.9651

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.9053

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.8343

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.7679

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7114

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.6528

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.5955

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.5380

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.4809

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.4244

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.3686

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.3127

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_380000_390000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_380000_390000.pt
Cleaning up memory...
✓ Batch 34/36 complete! (Time: 11.33 minutes)

================================================================================
BATCH 35/36: Processing samples 390000 to 400000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.0597

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.0906

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.4722

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.2520

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.0635

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.5165

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.3880

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 15.9064

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 15.7504

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.6920

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.6222

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 15.5570

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.5019

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.4446

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.3885

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.3323

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.2766

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.2214

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.1669

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.003

Epoch 190
Loss: 15.1123

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_390000_400000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_390000_400000.pt
Cleaning up memory...
✓ Batch 35/36 complete! (Time: 10.88 minutes)

================================================================================
BATCH 36/36: Processing samples 400000 to 407878
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([7878, 348, 52]), E=torch.Size([7878, 348]), G=(7878, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932930
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932930)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5268

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 10
Loss: 174.9126

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 20
Loss: 49.8288

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 30
Loss: 19.7015

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 40
Loss: 19.5524

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.9914

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.8531

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.3662

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.2070

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.1473

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.002

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.026 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.003

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 100
Loss: 16.0768

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 110
Loss: 16.0105

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 120
Loss: 15.9543

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 130
Loss: 15.8961

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 140
Loss: 15.8390

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 150
Loss: 15.7820

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 160
Loss: 15.7253

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.027 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 170
Loss: 15.6692

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.6137

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.016 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.5580

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.017 ± 0.007
  Theta for others: 0.014
  Proportion difference: 0.003

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.027 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.004

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.028 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.005

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.003
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_400000_407878.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/model_enroll_fixedphi_sex_400000_407878.pt
Cleaning up memory...
✓ Batch 36/36 complete! (Time: 8.10 minutes)

================================================================================
ALL BATCHES COMPLETE!
================================================================================
Processed: 36 batches
Skipped (already existed): 0 batches
Total successful: 36 batches

Concatenating all predictions into single file...
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_50000_60000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_60000_70000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_70000_80000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_80000_90000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_90000_100000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_100000_110000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_110000_120000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_120000_130000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_130000_140000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_140000_150000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_150000_160000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_160000_170000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_170000_180000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_180000_190000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_190000_200000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_200000_210000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_210000_220000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_220000_230000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_230000_240000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_240000_250000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_250000_260000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_260000_270000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_270000_280000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_280000_290000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_290000_300000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_300000_310000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_310000_320000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_320000_330000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_330000_340000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_340000_350000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_350000_360000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_360000_370000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_370000_380000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_380000_390000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_390000_400000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_400000_407878.pt, shape: torch.Size([7878, 348, 52])

Concatenating 36 batches...
Final shape: torch.Size([357878, 348, 52])
✓ Saved combined predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/pi_enroll_fixedphi_sex_FULL.pt
✓ Saved batch info to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_nolr_vectorized/batch_info.pt

================================================================================
DONE! Predictions use fixed gamma and kappa (only lambda was learned).
================================================================================
