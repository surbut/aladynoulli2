/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized.py:76: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized.py:88: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

============================================================
Running Aladyn batch: samples 0 to 1000
============================================================

Loading components...
Loaded all components successfully!
Subsetting data from 0 to 1000...
Loading covariates data...
G_with_sex shape: (1000, 47)
Covariates loaded: 407878 total samples
Loading reference trajectories...

Initializing model with K=20 clusters...

Cluster Sizes:
Cluster 0: 32 diseases
Cluster 1: 16 diseases
Cluster 2: 10 diseases
Cluster 3: 13 diseases
Cluster 4: 14 diseases
Cluster 5: 18 diseases
Cluster 6: 10 diseases
Cluster 7: 25 diseases
Cluster 8: 11 diseases
Cluster 9: 13 diseases
Cluster 10: 18 diseases
Cluster 11: 21 diseases
Cluster 12: 8 diseases
Cluster 13: 74 diseases
Cluster 14: 10 diseases
Cluster 15: 12 diseases
Cluster 16: 17 diseases
Cluster 17: 6 diseases
Cluster 18: 12 diseases
Cluster 19: 8 diseases

Calculating gamma for k=0:
Number of diseases in cluster: 32
Base value (first 5): tensor([-13.1978, -13.8155, -13.5066, -13.5066, -12.2712])
Base value centered (first 5): tensor([ 0.2801, -0.3376, -0.0287, -0.0287,  1.2067])
Base value centered mean: -1.1596679314607172e-06
Gamma init for k=0 (first 5): tensor([ 0.0007, -0.0006, -0.0249,  0.0236, -0.0338])

Calculating gamma for k=1:
Number of diseases in cluster: 16
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.2026, -0.2026, -0.2026, -0.2026, -0.2026])
Base value centered mean: -4.4536591303767636e-07
Gamma init for k=1 (first 5): tensor([ 0.0011,  0.0251,  0.0265,  0.0265, -0.0162])

Calculating gamma for k=2:
Number of diseases in cluster: 10
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1206, -0.1206, -0.1206, -0.1206, -0.1206])
Base value centered mean: -1.629829398552829e-06
Gamma init for k=2 (first 5): tensor([ 0.0037, -0.0288,  0.0009,  0.0082, -0.0319])

Calculating gamma for k=3:
Number of diseases in cluster: 13
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.0552])
Base value centered (first 5): tensor([-0.7116, -0.7116, -0.7116, -0.7116,  0.0487])
Base value centered mean: -7.438659821445981e-08
Gamma init for k=3 (first 5): tensor([-0.0286,  0.0977, -0.0175, -0.0369,  0.0164])

Calculating gamma for k=4:
Number of diseases in cluster: 14
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.1095])
Base value centered (first 5): tensor([-0.1666, -0.1666, -0.1666, -0.1666,  0.5394])
Base value centered mean: -1.1043548511224799e-06
Gamma init for k=4 (first 5): tensor([-0.0019,  0.0041,  0.0020, -0.0316,  0.0109])

Calculating gamma for k=5:
Number of diseases in cluster: 18
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1268, -0.1268, -0.1268, -0.1268, -0.1268])
Base value centered mean: -1.0271072596879094e-06
Gamma init for k=5 (first 5): tensor([ 0.0309, -0.0073, -0.0081, -0.0007,  0.0051])

Calculating gamma for k=6:
Number of diseases in cluster: 10
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -11.8388])
Base value centered (first 5): tensor([-0.2066, -0.2066, -0.2066, -0.2066,  1.7702])
Base value centered mean: -1.6651154055580264e-06
Gamma init for k=6 (first 5): tensor([-0.0381,  0.0345, -0.0178,  0.0051, -0.0467])

Calculating gamma for k=7:
Number of diseases in cluster: 25
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -12.6295, -13.0248])
Base value centered (first 5): tensor([-0.2261, -0.2261, -0.2261,  0.9599,  0.5646])
Base value centered mean: -1.4200210216586129e-06
Gamma init for k=7 (first 5): tensor([ 0.0131,  0.0203, -0.0173,  0.0194, -0.0214])

Calculating gamma for k=8:
Number of diseases in cluster: 11
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -12.0185, -13.8155])
Base value centered (first 5): tensor([-0.2309, -0.2309, -0.2309,  1.5661, -0.2309])
Base value centered mean: 6.38008145870117e-07
Gamma init for k=8 (first 5): tensor([-0.0174,  0.0279,  0.0066,  0.0016, -0.0013])

Calculating gamma for k=9:
Number of diseases in cluster: 13
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.0552])
Base value centered (first 5): tensor([-0.2235, -0.2235, -0.2235, -0.2235,  0.5368])
Base value centered mean: 2.8610228852699038e-08
Gamma init for k=9 (first 5): tensor([ 0.0428,  0.0236, -0.0405, -0.0312, -0.0225])

Calculating gamma for k=10:
Number of diseases in cluster: 18
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1581, -0.1581, -0.1581, -0.1581, -0.1581])
Base value centered mean: -2.3136140043789055e-06
Gamma init for k=10 (first 5): tensor([ 0.0057,  0.0145, -0.0106,  0.0110,  0.0019])

Calculating gamma for k=11:
Number of diseases in cluster: 21
Base value (first 5): tensor([-13.8155, -12.8742, -13.3449, -13.3449, -11.4623])
Base value centered (first 5): tensor([-0.4241,  0.5172,  0.0466,  0.0466,  1.9292])
Base value centered mean: -1.754760745598105e-07
Gamma init for k=11 (first 5): tensor([-0.0113,  0.0296, -0.0208,  0.0660, -0.0162])

Calculating gamma for k=12:
Number of diseases in cluster: 8
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1211, -0.1211, -0.1211, -0.1211, -0.1211])
Base value centered mean: -1.5640258652638295e-06
Gamma init for k=12 (first 5): tensor([ 0.0253, -0.0197,  0.0007, -0.0208, -0.0304])

Calculating gamma for k=13:
Number of diseases in cluster: 74
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.4148, -13.5484])
Base value centered (first 5): tensor([-0.1020, -0.1020, -0.1020,  0.2986,  0.1651])
Base value centered mean: 1.3923644814894942e-07
Gamma init for k=13 (first 5): tensor([-0.0075,  0.0019,  0.0002,  0.0023, -0.0012])

Calculating gamma for k=14:
Number of diseases in cluster: 10
Base value (first 5): tensor([-13.8155, -13.8155, -12.8271, -11.8388, -11.8388])
Base value centered (first 5): tensor([-0.5011, -0.5011,  0.4873,  1.4756,  1.4756])
Base value centered mean: 4.863738922722405e-08
Gamma init for k=14 (first 5): tensor([-0.0363,  0.0645,  0.0540,  0.0905,  0.0090])

Calculating gamma for k=15:
Number of diseases in cluster: 12
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -10.5209, -12.9919])
Base value centered (first 5): tensor([-0.1853, -0.1853, -0.1853,  3.1092,  0.6383])
Base value centered mean: 9.622573315937188e-07
Gamma init for k=15 (first 5): tensor([-0.0096, -0.0027, -0.0222, -0.0095, -0.0124])

Calculating gamma for k=16:
Number of diseases in cluster: 17
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -12.0713, -13.2341])
Base value centered (first 5): tensor([-0.2029, -0.2029, -0.2029,  1.5413,  0.3785])
Base value centered mean: -2.225875959993573e-06
Gamma init for k=16 (first 5): tensor([-0.0101,  0.0404,  0.0181, -0.0161, -0.0060])

Calculating gamma for k=17:
Number of diseases in cluster: 6
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1219, -0.1219, -0.1219, -0.1219, -0.1219])
Base value centered mean: -1.820564307308814e-06
Gamma init for k=17 (first 5): tensor([ 0.0166, -0.0147,  0.0036, -0.0152, -0.0006])

Calculating gamma for k=18:
Number of diseases in cluster: 12
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155,  -8.8737, -12.9919])
Base value centered (first 5): tensor([-0.2380, -0.2380, -0.2380,  4.7038,  0.5856])
Base value centered mean: -4.482269275740691e-07
Gamma init for k=18 (first 5): tensor([ 0.0137,  0.0134, -0.0107, -0.0126,  0.0191])

Calculating gamma for k=19:
Number of diseases in cluster: 8
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -12.5800, -13.8155])
Base value centered (first 5): tensor([-0.1347, -0.1347, -0.1347,  1.1008, -0.1347])
Base value centered mean: -1.363754222438729e-06
Gamma init for k=19 (first 5): tensor([ 0.0221,  0.0151, -0.0066,  0.0034, -0.0120])
/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized.py:238: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  event_times_tensor = torch.tensor(event_times, dtype=torch.long)
Initializing with 20 disease states + 1 healthy state
Initialization complete!
Loading initial psi and clusters...

Calculating gamma for k=0:
Number of diseases in cluster: 16.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -11.9623, -13.8155])
Base value centered (first 5): tensor([-0.1804, -0.1804, -0.1804,  1.6728, -0.1804])
Base value centered mean: -9.307861432716891e-07
Gamma init for k=0 (first 5): tensor([-0.0166,  0.0374, -0.0082, -0.0261,  0.0099])

Calculating gamma for k=1:
Number of diseases in cluster: 21.0
Base value (first 5): tensor([-13.3449, -13.8155, -13.3449, -13.3449, -12.4036])
Base value centered (first 5): tensor([ 0.1450, -0.3257,  0.1450,  0.1450,  1.0863])
Base value centered mean: -4.587173521031218e-07
Gamma init for k=1 (first 5): tensor([-0.0062, -0.0106, -0.0314,  0.0051, -0.0130])

Calculating gamma for k=2:
Number of diseases in cluster: 15.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.1566, -11.8388, -12.4977])
Base value centered (first 5): tensor([-0.4171, -0.4171,  0.2418,  1.5596,  0.9007])
Base value centered mean: -1.506805489270846e-07
Gamma init for k=2 (first 5): tensor([-0.0404,  0.0611,  0.0512,  0.0792,  0.0079])

Calculating gamma for k=3:
Number of diseases in cluster: 82.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.6950, -13.5744])
Base value centered (first 5): tensor([-0.1033, -0.1033, -0.1033,  0.0172,  0.1378])
Base value centered mean: 2.717971767651761e-07
Gamma init for k=3 (first 5): tensor([-0.0024,  0.0049, -0.0012, -0.0030, -0.0015])

Calculating gamma for k=4:
Number of diseases in cluster: 5.0
Base value (first 5): tensor([-13.8155,  -9.8620, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1265,  3.8270, -0.1265, -0.1265, -0.1265])
Base value centered mean: -1.4333725175674772e-06
Gamma init for k=4 (first 5): tensor([-0.0161,  0.0130,  0.0006,  0.0343, -0.0259])

Calculating gamma for k=5:
Number of diseases in cluster: 7.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.6537, -0.6537, -0.6537, -0.6537, -0.6537])
Base value centered mean: -5.207061803957913e-07
Gamma init for k=5 (first 5): tensor([-0.0609,  0.1075, -0.0334, -0.0455, -0.0036])

Calculating gamma for k=6:
Number of diseases in cluster: 8.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1804, -0.1804, -0.1804, -0.1804, -0.1804])
Base value centered mean: 1.0013580009626821e-07
Gamma init for k=6 (first 5): tensor([ 0.0155, -0.0013,  0.0059,  0.0191, -0.0506])

Calculating gamma for k=7:
Number of diseases in cluster: 22.0
Base value (first 5): tensor([-13.3663, -13.8155, -13.3663, -13.8155, -11.1200])
Base value centered (first 5): tensor([-0.1051, -0.5544, -0.1051, -0.5544,  2.1412])
Base value centered mean: -3.900528042777296e-07
Gamma init for k=7 (first 5): tensor([ 0.0018,  0.0117, -0.0209,  0.0657, -0.0289])

Calculating gamma for k=8:
Number of diseases in cluster: 28.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1123, -0.1123, -0.1123, -0.1123, -0.1123])
Base value centered mean: -8.420944368481287e-07
Gamma init for k=8 (first 5): tensor([ 0.0207, -0.0064, -0.0017, -0.0026,  0.0026])

Calculating gamma for k=9:
Number of diseases in cluster: 12.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -12.9919])
Base value centered (first 5): tensor([-0.2001, -0.2001, -0.2001, -0.2001,  0.6235])
Base value centered mean: -3.156661989578424e-07
Gamma init for k=9 (first 5): tensor([ 0.0471,  0.0245, -0.0414, -0.0422, -0.0277])

Calculating gamma for k=10:
Number of diseases in cluster: 11.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.2489, -0.2489, -0.2489, -0.2489, -0.2489])
Base value centered mean: -1.1062621751989354e-07
Gamma init for k=10 (first 5): tensor([ 0.0130,  0.0044,  0.0283,  0.0079, -0.0208])

Calculating gamma for k=11:
Number of diseases in cluster: 8.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1112, -0.1112, -0.1112, -0.1112, -0.1112])
Base value centered mean: -3.8623809928139963e-07
Gamma init for k=11 (first 5): tensor([ 0.0083, -0.0102,  0.0124, -0.0206, -0.0054])

Calculating gamma for k=12:
Number of diseases in cluster: 7.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.0748, -0.0748, -0.0748, -0.0748, -0.0748])
Base value centered mean: -3.461837820850633e-07
Gamma init for k=12 (first 5): tensor([ 0.0143,  0.0034, -0.0063,  0.0159, -0.0069])

Calculating gamma for k=13:
Number of diseases in cluster: 13.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -10.7744, -12.2949])
Base value centered (first 5): tensor([-0.1886, -0.1886, -0.1886,  2.8526,  1.3320])
Base value centered mean: -8.268356168628088e-07
Gamma init for k=13 (first 5): tensor([-0.0168,  0.0589,  0.0164, -0.0065, -0.0145])

Calculating gamma for k=14:
Number of diseases in cluster: 10.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -11.8388, -12.8271])
Base value centered (first 5): tensor([-0.2461, -0.2461, -0.2461,  1.7306,  0.7423])
Base value centered mean: -6.265640308811271e-07
Gamma init for k=14 (first 5): tensor([ 0.0280,  0.0262, -0.0317,  0.0503, -0.0307])

Calculating gamma for k=15:
Number of diseases in cluster: 5.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -11.8388])
Base value centered (first 5): tensor([-0.2471, -0.2471, -0.2471, -0.2471,  1.7296])
Base value centered mean: -2.2068022644816665e-06
Gamma init for k=15 (first 5): tensor([ 0.0053, -0.0058, -0.0175,  0.0297,  0.0120])

Calculating gamma for k=16:
Number of diseases in cluster: 29.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -11.7706, -13.1339])
Base value centered (first 5): tensor([-0.2522, -0.2522, -0.2522,  1.7927,  0.4294])
Base value centered mean: 6.103515488575795e-07
Gamma init for k=16 (first 5): tensor([-0.0003,  0.0258, -0.0183,  0.0075, -0.0264])

Calculating gamma for k=17:
Number of diseases in cluster: 17.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -10.3272, -12.0713])
Base value centered (first 5): tensor([-0.4169, -0.4169, -0.4169,  3.0715,  1.3273])
Base value centered mean: -5.97000109792134e-07
Gamma init for k=17 (first 5): tensor([ 0.0154,  0.0233, -0.0272,  0.0054,  0.0062])

Calculating gamma for k=18:
Number of diseases in cluster: 9.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.8155])
Base value centered (first 5): tensor([-0.1428, -0.1428, -0.1428, -0.1428, -0.1428])
Base value centered mean: -1.7776488903109566e-06
Gamma init for k=18 (first 5): tensor([-0.0231, -0.0138,  0.0102,  0.0272,  0.0096])

Calculating gamma for k=19:
Number of diseases in cluster: 23.0
Base value (first 5): tensor([-13.8155, -13.8155, -13.8155, -13.8155, -13.3858])
Base value centered (first 5): tensor([-0.1336, -0.1336, -0.1336, -0.1336,  0.2961])
Base value centered mean: -1.4963150078983745e-06
Gamma init for k=19 (first 5): tensor([-0.0086,  0.0101,  0.0033, -0.0128, -0.0119])
Initializing with 20 disease states + 1 healthy state
Initialization complete!
Clusters match exactly: True

Training model for 200 epochs...
Learning rate: 0.1, Lambda: 0.01

Epoch 0
Loss: 65.6272

Monitoring signature responses:

Disease 161 (signature 7, LR=32.25):
  Theta for diagnosed: 0.159 ± 0.045
  Theta for others: 0.146
  Proportion difference: 0.014

Disease 76 (signature 7, LR=30.66):
  Theta for diagnosed: 0.152 ± 0.039
  Theta for others: 0.147
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.45):
  Theta for diagnosed: 0.107 ± 0.088
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.43):
  Theta for diagnosed: 0.148 ± 0.070
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.88):
  Theta for diagnosed: 0.014 ± 0.006
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 1
Loss: 712.0661

Monitoring signature responses:

Disease 161 (signature 7, LR=32.35):
  Theta for diagnosed: 0.160 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.014

Disease 76 (signature 7, LR=30.67):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.47):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.45):
  Theta for diagnosed: 0.148 ± 0.069
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.85):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 2
Loss: 118.5183

Monitoring signature responses:

Disease 161 (signature 7, LR=32.43):
  Theta for diagnosed: 0.159 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.013

Disease 76 (signature 7, LR=30.66):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.49):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.48):
  Theta for diagnosed: 0.148 ± 0.070
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.83):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 3
Loss: 210.3657

Monitoring signature responses:

Disease 161 (signature 7, LR=32.52):
  Theta for diagnosed: 0.159 ± 0.044
  Theta for others: 0.146
  Proportion difference: 0.013

Disease 76 (signature 7, LR=30.64):
  Theta for diagnosed: 0.152 ± 0.038
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.50):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.50):
  Theta for diagnosed: 0.148 ± 0.070
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.82):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 4
Loss: 424.4003

Monitoring signature responses:

Disease 161 (signature 7, LR=32.60):
  Theta for diagnosed: 0.159 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.013

Disease 76 (signature 7, LR=30.61):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.50):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.52):
  Theta for diagnosed: 0.148 ± 0.070
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.84):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 5
Loss: 334.2465

Monitoring signature responses:

Disease 161 (signature 7, LR=32.68):
  Theta for diagnosed: 0.160 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.013

Disease 76 (signature 7, LR=30.58):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.50):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.53):
  Theta for diagnosed: 0.148 ± 0.069
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 6
Loss: 150.6600

Monitoring signature responses:

Disease 161 (signature 7, LR=32.75):
  Theta for diagnosed: 0.160 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.014

Disease 76 (signature 7, LR=30.54):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.50):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.54):
  Theta for diagnosed: 0.148 ± 0.069
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 50 (signature 15, LR=28.88):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: -0.000

Epoch 7
Loss: 80.8788

Monitoring signature responses:

Disease 161 (signature 7, LR=32.79):
  Theta for diagnosed: 0.160 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.014

Disease 76 (signature 7, LR=30.51):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.148
  Proportion difference: 0.005

Disease 260 (signature 8, LR=30.49):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.020

Disease 347 (signature 3, LR=29.56):
  Theta for diagnosed: 0.148 ± 0.069
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 283 (signature 8, LR=28.92):
  Theta for diagnosed: 0.107 ± 0.090
  Theta for others: 0.086
  Proportion difference: 0.021

Epoch 8
Loss: 149.5113

Monitoring signature responses:

Disease 161 (signature 7, LR=32.81):
  Theta for diagnosed: 0.160 ± 0.043
  Theta for others: 0.146
  Proportion difference: 0.014

Disease 260 (signature 8, LR=30.49):
  Theta for diagnosed: 0.107 ± 0.087
  Theta for others: 0.087
  Proportion difference: 0.021

Disease 76 (signature 7, LR=30.46):
  Theta for diagnosed: 0.152 ± 0.037
  Theta for others: 0.147
  Proportion difference: 0.005

Disease 347 (signature 3, LR=29.57):
  Theta for diagnosed: 0.148 ± 0.069
  Theta for others: 0.149
  Proportion difference: -0.001

Disease 283 (signature 8, LR=28.96):
  Theta for diagnosed: 0.107 ± 0.090
  Theta for others: 0.086
  Proportion difference: 0.021
Traceback (most recent call last):
  File "/Users/sarahurbut/aladynoulli2/claudefile/run_aladyn_batch_vectorized_sameE.py", line 217, in <module>
    main()
  File "/Users/sarahurbut/aladynoulli2/claudefile/run_aladyn_batch_vectorized_sameE.py", line 180, in main
    history = model.fit(E_batch,
  File "/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized.py", line 379, in fit
    loss = self.compute_loss(event_times)
  File "/Users/sarahurbut/aladynoulli2/pyScripts_forPublish/clust_huge_amp_vectorized.py", line 245, in compute_loss
    loss_censored = -torch.sum(torch.log(1 - pi) * mask_before_event)
KeyboardInterrupt
