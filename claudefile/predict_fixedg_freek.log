/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:56: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:115: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

================================================================================
Aladyn Prediction Script - Fixed Phi/Psi/Gamma Mode (Kappa Free)
================================================================================
Trained model: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt
Pooled gamma: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma.pt
Output directory: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/
Batch size: 10000
================================================================================

Loading components...
Loaded all components successfully!
Loading covariates data...
Loaded 407878 samples from covariates file
Loading reference trajectories...
Loading initial_psi...
Loaded initial_psi shape: (20, 348)
Loading master checkpoint from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt...
Master checkpoint description: Pooled phi from all retrospective batches + initial_psi
Loaded pooled phi shape: (21, 348, 52)
Loaded psi_total shape: (21, 348)
Loading pooled gamma from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma.pt...
Loaded pooled gamma shape: (47, 21)
⚠️  Limiting to 5 batches

Will process 5 batches of 10000 samples
Total samples: 407878
Processing samples: 0 to 50000


================================================================================
BATCH 1/5: Processing samples 0 to 10000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma (kappa free)...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma is fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa is free (will be learned per batch), initial value: 1.000000
Training model (estimating lambda and kappa, gamma is fixed)...
Kappa gradient: -1.053e+00

Epoch 0
Loss: 16.8995

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -8.769e-01
Kappa gradient: -7.306e-01
Kappa gradient: -6.084e-01
Kappa gradient: -5.053e-01
Kappa gradient: -4.177e-01
Kappa gradient: -3.428e-01
Kappa gradient: -2.784e-01
Kappa gradient: -2.227e-01
Kappa gradient: -1.743e-01
Kappa gradient: -1.323e-01

Epoch 10
Loss: 174.4674

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -9.569e-02
Kappa gradient: -6.377e-02
Kappa gradient: -3.601e-02
Kappa gradient: -1.189e-02
Kappa gradient: 8.981e-03
Kappa gradient: 2.697e-02
Kappa gradient: 4.239e-02
Kappa gradient: 5.549e-02
Kappa gradient: 6.652e-02
Kappa gradient: 7.568e-02

Epoch 20
Loss: 49.8560

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 8.314e-02
Kappa gradient: 8.907e-02
Kappa gradient: 9.358e-02
Kappa gradient: 9.679e-02
Kappa gradient: 9.879e-02
Kappa gradient: 9.967e-02
Kappa gradient: 9.951e-02
Kappa gradient: 9.841e-02
Kappa gradient: 9.644e-02
Kappa gradient: 9.368e-02

Epoch 30
Loss: 19.6382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 9.020e-02
Kappa gradient: 8.608e-02
Kappa gradient: 8.140e-02
Kappa gradient: 7.623e-02
Kappa gradient: 7.062e-02
Kappa gradient: 6.465e-02
Kappa gradient: 5.839e-02
Kappa gradient: 5.190e-02
Kappa gradient: 4.526e-02
Kappa gradient: 3.855e-02

Epoch 40
Loss: 19.4338

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 3.185e-02
Kappa gradient: 2.524e-02
Kappa gradient: 1.879e-02
Kappa gradient: 1.258e-02
Kappa gradient: 6.688e-03
Kappa gradient: 1.160e-03
Kappa gradient: -3.944e-03
Kappa gradient: -8.579e-03
Kappa gradient: -1.270e-02
Kappa gradient: -1.629e-02

Epoch 50
Loss: 17.8837

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.932e-02
Kappa gradient: -2.177e-02
Kappa gradient: -2.364e-02
Kappa gradient: -2.496e-02
Kappa gradient: -2.573e-02
Kappa gradient: -2.599e-02
Kappa gradient: -2.577e-02
Kappa gradient: -2.514e-02
Kappa gradient: -2.412e-02
Kappa gradient: -2.278e-02

Epoch 60
Loss: 16.7532

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -2.117e-02
Kappa gradient: -1.934e-02
Kappa gradient: -1.734e-02
Kappa gradient: -1.523e-02
Kappa gradient: -1.304e-02
Kappa gradient: -1.084e-02
Kappa gradient: -8.651e-03
Kappa gradient: -6.525e-03
Kappa gradient: -4.491e-03
Kappa gradient: -2.577e-03

Epoch 70
Loss: 16.2682

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -8.038e-04
Kappa gradient: 8.105e-04
Kappa gradient: 2.253e-03
Kappa gradient: 3.514e-03
Kappa gradient: 4.589e-03
Kappa gradient: 5.473e-03
Kappa gradient: 6.168e-03
Kappa gradient: 6.678e-03
Kappa gradient: 7.010e-03
Kappa gradient: 7.175e-03

Epoch 80
Loss: 16.1091

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 7.185e-03
Kappa gradient: 7.055e-03
Kappa gradient: 6.799e-03
Kappa gradient: 6.432e-03
Kappa gradient: 5.972e-03
Kappa gradient: 5.434e-03
Kappa gradient: 4.836e-03
Kappa gradient: 4.194e-03
Kappa gradient: 3.524e-03
Kappa gradient: 2.844e-03

Epoch 90
Loss: 16.0472

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 2.167e-03
Kappa gradient: 1.507e-03
Kappa gradient: 8.759e-04
Kappa gradient: 2.840e-04
Kappa gradient: -2.605e-04
Kappa gradient: -7.505e-04
Kappa gradient: -1.180e-03
Kappa gradient: -1.546e-03
Kappa gradient: -1.846e-03
Kappa gradient: -2.078e-03

Epoch 100
Loss: 15.9740

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.245e-03
Kappa gradient: -2.348e-03
Kappa gradient: -2.390e-03
Kappa gradient: -2.378e-03
Kappa gradient: -2.316e-03
Kappa gradient: -2.209e-03
Kappa gradient: -2.065e-03
Kappa gradient: -1.890e-03
Kappa gradient: -1.690e-03
Kappa gradient: -1.472e-03

Epoch 110
Loss: 15.9053

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.244e-03
Kappa gradient: -1.011e-03
Kappa gradient: -7.786e-04
Kappa gradient: -5.529e-04
Kappa gradient: -3.381e-04
Kappa gradient: -1.379e-04
Kappa gradient: 4.433e-05
Kappa gradient: 2.061e-04
Kappa gradient: 3.453e-04
Kappa gradient: 4.608e-04

Epoch 120
Loss: 15.8464

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 5.519e-04
Kappa gradient: 6.187e-04
Kappa gradient: 6.622e-04
Kappa gradient: 6.834e-04
Kappa gradient: 6.839e-04
Kappa gradient: 6.657e-04
Kappa gradient: 6.307e-04
Kappa gradient: 5.815e-04
Kappa gradient: 5.203e-04
Kappa gradient: 4.500e-04

Epoch 130
Loss: 15.7854

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 3.731e-04
Kappa gradient: 2.921e-04
Kappa gradient: 2.095e-04
Kappa gradient: 1.275e-04
Kappa gradient: 4.809e-05
Kappa gradient: -2.711e-05
Kappa gradient: -9.648e-05
Kappa gradient: -1.589e-04
Kappa gradient: -2.133e-04
Kappa gradient: -2.590e-04

Epoch 140
Loss: 15.7255

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:56: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:115: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.956e-04
Kappa gradient: -3.232e-04
Kappa gradient: -3.417e-04
Kappa gradient: -3.516e-04
Kappa gradient: -3.534e-04
Kappa gradient: -3.478e-04
Kappa gradient: -3.357e-04
Kappa gradient: -3.179e-04
Kappa gradient: -2.956e-04
Kappa gradient: -2.695e-04

Epoch 150
Loss: 15.6656

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.409e-04
Kappa gradient: -2.107e-04
Kappa gradient: -1.799e-04
Kappa gradient: -1.495e-04
Kappa gradient: -1.200e-04
Kappa gradient: -9.224e-05
Kappa gradient: -6.688e-05
Kappa gradient: -4.423e-05
Kappa gradient: -2.478e-05
Kappa gradient: -8.756e-06

Epoch 160
Loss: 15.6062

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 3.777e-06
Kappa gradient: 1.274e-05
Kappa gradient: 1.835e-05
Kappa gradient: 2.062e-05
Kappa gradient: 1.988e-05
Kappa gradient: 1.649e-05
Kappa gradient: 1.073e-05
Kappa gradient: 3.011e-06
Kappa gradient: -6.304e-06
Kappa gradient: -1.676e-05

Epoch 170
Loss: 15.5475

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.795e-05
Kappa gradient: -3.942e-05
Kappa gradient: -5.092e-05
Kappa gradient: -6.206e-05
Kappa gradient: -7.259e-05
Kappa gradient: -8.210e-05
Kappa gradient: -9.056e-05
Kappa gradient: -9.767e-05
Kappa gradient: -1.035e-04
Kappa gradient: -1.080e-04

Epoch 180
Loss: 15.4896

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -1.111e-04
Kappa gradient: -1.128e-04
Kappa gradient: -1.132e-04
Kappa gradient: -1.125e-04
Kappa gradient: -1.107e-04
Kappa gradient: -1.079e-04
Kappa gradient: -1.045e-04
Kappa gradient: -1.004e-04
Kappa gradient: -9.592e-05
Kappa gradient: -9.129e-05

Epoch 190
Loss: 15.4316

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -8.647e-05
Kappa gradient: -8.181e-05
Kappa gradient: -7.742e-05
Kappa gradient: -7.322e-05
Kappa gradient: -6.952e-05
Kappa gradient: -6.629e-05
Kappa gradient: -6.358e-05
Kappa gradient: -6.139e-05
Kappa gradient: -5.987e-05
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_0_10000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/model_enroll_fixedphi_sex_0_10000.pt
  Learned kappa for this batch: 2.190919
Cleaning up memory...
✓ Batch 1/5 complete! (Time: 9.94 minutes)

================================================================================
BATCH 2/5: Processing samples 10000 to 20000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma (kappa free)...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma is fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa is free (will be learned per batch), initial value: 1.000000
Training model (estimating lambda and kappa, gamma is fixed)...
Kappa gradient: -1.023e+00

Epoch 0
Loss: 16.7192

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -8.484e-01
Kappa gradient: -7.034e-01
Kappa gradient: -5.823e-01
Kappa gradient: -4.803e-01
Kappa gradient: -3.936e-01
Kappa gradient: -3.196e-01
Kappa gradient: -2.560e-01
Kappa gradient: -2.011e-01
Kappa gradient: -1.537e-01
Kappa gradient: -1.125e-01

Epoch 10
Loss: 174.3338

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -7.669e-02
Kappa gradient: -4.563e-02
Kappa gradient: -1.872e-02
Kappa gradient: 4.507e-03
Kappa gradient: 2.448e-02
Kappa gradient: 4.155e-02
Kappa gradient: 5.602e-02
Kappa gradient: 6.817e-02
Kappa gradient: 7.821e-02
Kappa gradient: 8.637e-02

Epoch 20
Loss: 49.7073

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 9.281e-02
Kappa gradient: 9.769e-02
Kappa gradient: 1.011e-01
Kappa gradient: 1.033e-01
Kappa gradient: 1.042e-01
Kappa gradient: 1.039e-01
Kappa gradient: 1.026e-01
Kappa gradient: 1.004e-01
Kappa gradient: 9.730e-02
Kappa gradient: 9.340e-02

Epoch 30
Loss: 19.4852

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 8.879e-02
Kappa gradient: 8.356e-02
Kappa gradient: 7.780e-02
Kappa gradient: 7.157e-02
Kappa gradient: 6.495e-02
Kappa gradient: 5.803e-02
Kappa gradient: 5.089e-02
Kappa gradient: 4.360e-02
Kappa gradient: 3.626e-02
Kappa gradient: 2.897e-02

Epoch 40
Loss: 19.2865

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 2.180e-02
Kappa gradient: 1.485e-02
Kappa gradient: 8.215e-03
Kappa gradient: 1.970e-03
Kappa gradient: -3.813e-03
Kappa gradient: -9.072e-03
Kappa gradient: -1.376e-02
Kappa gradient: -1.783e-02
Kappa gradient: -2.126e-02
Kappa gradient: -2.404e-02

Epoch 50
Loss: 17.7382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -2.616e-02
Kappa gradient: -2.763e-02
Kappa gradient: -2.846e-02
Kappa gradient: -2.870e-02
Kappa gradient: -2.839e-02
Kappa gradient: -2.758e-02
Kappa gradient: -2.633e-02
Kappa gradient: -2.471e-02
Kappa gradient: -2.278e-02
Kappa gradient: -2.061e-02

Epoch 60
Loss: 16.6085

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.827e-02
Kappa gradient: -1.580e-02
Kappa gradient: -1.328e-02
Kappa gradient: -1.075e-02
Kappa gradient: -8.255e-03
Kappa gradient: -5.849e-03
Kappa gradient: -3.568e-03
Kappa gradient: -1.442e-03
Kappa gradient: 5.014e-04
Kappa gradient: 2.243e-03

Epoch 70
Loss: 16.1252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 3.770e-03
Kappa gradient: 5.075e-03
Kappa gradient: 6.154e-03
Kappa gradient: 7.007e-03
Kappa gradient: 7.639e-03
Kappa gradient: 8.057e-03
Kappa gradient: 8.271e-03
Kappa gradient: 8.295e-03
Kappa gradient: 8.145e-03
Kappa gradient: 7.840e-03

Epoch 80
Loss: 15.9680

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 7.399e-03
Kappa gradient: 6.844e-03
Kappa gradient: 6.196e-03
Kappa gradient: 5.477e-03
Kappa gradient: 4.706e-03
Kappa gradient: 3.904e-03
Kappa gradient: 3.089e-03
Kappa gradient: 2.280e-03
Kappa gradient: 1.495e-03
Kappa gradient: 7.480e-04

Epoch 90
Loss: 15.9082

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 5.284e-05
Kappa gradient: -5.798e-04
Kappa gradient: -1.141e-03
Kappa gradient: -1.626e-03
Kappa gradient: -2.030e-03
Kappa gradient: -2.350e-03
Kappa gradient: -2.589e-03
Kappa gradient: -2.746e-03
Kappa gradient: -2.825e-03
Kappa gradient: -2.832e-03

Epoch 100
Loss: 15.8371

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.772e-03
Kappa gradient: -2.654e-03
Kappa gradient: -2.485e-03
Kappa gradient: -2.275e-03
Kappa gradient: -2.032e-03
Kappa gradient: -1.765e-03
Kappa gradient: -1.483e-03
Kappa gradient: -1.193e-03
Kappa gradient: -9.033e-04
Kappa gradient: -6.210e-04

Epoch 110
Loss: 15.7704

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -3.523e-04
Kappa gradient: -1.028e-04
Kappa gradient: 1.230e-04
Kappa gradient: 3.221e-04
Kappa gradient: 4.918e-04
Kappa gradient: 6.311e-04
Kappa gradient: 7.390e-04
Kappa gradient: 8.159e-04
Kappa gradient: 8.625e-04
Kappa gradient: 8.805e-04

Epoch 120
Loss: 15.7136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 8.718e-04
Kappa gradient: 8.393e-04
Kappa gradient: 7.860e-04
Kappa gradient: 7.153e-04
Kappa gradient: 6.308e-04
Kappa gradient: 5.358e-04
Kappa gradient: 4.337e-04
Kappa gradient: 3.278e-04
Kappa gradient: 2.212e-04
Kappa gradient: 1.168e-04

Epoch 130
Loss: 15.6547

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 1.742e-05
Kappa gradient: -7.492e-05
Kappa gradient: -1.582e-04
Kappa gradient: -2.311e-04
Kappa gradient: -2.927e-04
Kappa gradient: -3.424e-04
Kappa gradient: -3.798e-04
Kappa gradient: -4.052e-04
Kappa gradient: -4.187e-04
Kappa gradient: -4.213e-04

Epoch 140
Loss: 15.5966

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -4.138e-04
Kappa gradient: -3.973e-04
Kappa gradient: -3.732e-04
Kappa gradient: -3.430e-04
Kappa gradient: -3.079e-04
Kappa gradient: -2.695e-04
Kappa gradient: -2.292e-04
Kappa gradient: -1.881e-04
Kappa gradient: -1.476e-04
Kappa gradient: -1.088e-04

Epoch 150
Loss: 15.5386

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -7.268e-05
Kappa gradient: -4.004e-05
Kappa gradient: -1.154e-05
Kappa gradient: 1.250e-05
Kappa gradient: 3.171e-05
Kappa gradient: 4.606e-05
Kappa gradient: 5.565e-05
Kappa gradient: 6.047e-05
Kappa gradient: 6.096e-05
Kappa gradient: 5.739e-05

Epoch 160
Loss: 15.4808

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 5.032e-05
Kappa gradient: 4.033e-05
Kappa gradient: 2.805e-05
Kappa gradient: 1.394e-05
Kappa gradient: -1.275e-06
Kappa gradient: -1.714e-05
Kappa gradient: -3.306e-05
Kappa gradient: -4.857e-05
Kappa gradient: -6.321e-05
Kappa gradient: -7.647e-05

Epoch 170
Loss: 15.4236

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -8.838e-05
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:56: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:115: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Kappa gradient: -9.835e-05
Kappa gradient: -1.064e-04
Kappa gradient: -1.125e-04
Kappa gradient: -1.166e-04
Kappa gradient: -1.188e-04
Kappa gradient: -1.192e-04
Kappa gradient: -1.178e-04
Kappa gradient: -1.150e-04
Kappa gradient: -1.109e-04

Epoch 180
Loss: 15.3667

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.058e-04
Kappa gradient: -1.001e-04
Kappa gradient: -9.371e-05
Kappa gradient: -8.720e-05
Kappa gradient: -8.060e-05
Kappa gradient: -7.420e-05
Kappa gradient: -6.819e-05
Kappa gradient: -6.263e-05
Kappa gradient: -5.788e-05
Kappa gradient: -5.385e-05

Epoch 190
Loss: 15.3095

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -5.049e-05
Kappa gradient: -4.804e-05
Kappa gradient: -4.649e-05
Kappa gradient: -4.559e-05
Kappa gradient: -4.559e-05
Kappa gradient: -4.617e-05
Kappa gradient: -4.745e-05
Kappa gradient: -4.919e-05
Kappa gradient: -5.124e-05
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_10000_20000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/model_enroll_fixedphi_sex_10000_20000.pt
  Learned kappa for this batch: 2.139516
Cleaning up memory...
✓ Batch 2/5 complete! (Time: 10.93 minutes)

================================================================================
BATCH 3/5: Processing samples 20000 to 30000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma (kappa free)...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma is fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa is free (will be learned per batch), initial value: 1.000000
Training model (estimating lambda and kappa, gamma is fixed)...
Kappa gradient: -1.030e+00

Epoch 0
Loss: 16.6915

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -8.556e-01
Kappa gradient: -7.111e-01
Kappa gradient: -5.903e-01
Kappa gradient: -4.885e-01
Kappa gradient: -4.020e-01
Kappa gradient: -3.280e-01
Kappa gradient: -2.645e-01
Kappa gradient: -2.096e-01
Kappa gradient: -1.621e-01
Kappa gradient: -1.208e-01

Epoch 10
Loss: 174.2995

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -8.485e-02
Kappa gradient: -5.361e-02
Kappa gradient: -2.649e-02
Kappa gradient: -3.008e-03
Kappa gradient: 1.725e-02
Kappa gradient: 3.463e-02
Kappa gradient: 4.945e-02
Kappa gradient: 6.196e-02
Kappa gradient: 7.240e-02
Kappa gradient: 8.096e-02

Epoch 20
Loss: 49.6645

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 8.784e-02
Kappa gradient: 9.318e-02
Kappa gradient: 9.710e-02
Kappa gradient: 9.972e-02
Kappa gradient: 1.011e-01
Kappa gradient: 1.014e-01
Kappa gradient: 1.007e-01
Kappa gradient: 9.898e-02
Kappa gradient: 9.643e-02
Kappa gradient: 9.309e-02

Epoch 30
Loss: 19.4460

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 8.904e-02
Kappa gradient: 8.437e-02
Kappa gradient: 7.914e-02
Kappa gradient: 7.344e-02
Kappa gradient: 6.734e-02
Kappa gradient: 6.090e-02
Kappa gradient: 5.420e-02
Kappa gradient: 4.732e-02
Kappa gradient: 4.035e-02
Kappa gradient: 3.335e-02

Epoch 40
Loss: 19.2462

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 2.643e-02
Kappa gradient: 1.966e-02
Kappa gradient: 1.313e-02
Kappa gradient: 6.916e-03
Kappa gradient: 1.086e-03
Kappa gradient: -4.297e-03
Kappa gradient: -9.181e-03
Kappa gradient: -1.352e-02
Kappa gradient: -1.729e-02
Kappa gradient: -2.046e-02

Epoch 50
Loss: 17.6982

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.301e-02
Kappa gradient: -2.495e-02
Kappa gradient: -2.629e-02
Kappa gradient: -2.704e-02
Kappa gradient: -2.724e-02
Kappa gradient: -2.694e-02
Kappa gradient: -2.618e-02
Kappa gradient: -2.502e-02
Kappa gradient: -2.352e-02
Kappa gradient: -2.173e-02

Epoch 60
Loss: 16.5683

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.973e-02
Kappa gradient: -1.755e-02
Kappa gradient: -1.526e-02
Kappa gradient: -1.291e-02
Kappa gradient: -1.055e-02
Kappa gradient: -8.221e-03
Kappa gradient: -5.970e-03
Kappa gradient: -3.828e-03
Kappa gradient: -1.827e-03
Kappa gradient: 1.089e-05

Epoch 70
Loss: 16.0841

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 1.668e-03
Kappa gradient: 3.131e-03
Kappa gradient: 4.393e-03
Kappa gradient: 5.449e-03
Kappa gradient: 6.299e-03
Kappa gradient: 6.944e-03
Kappa gradient: 7.390e-03
Kappa gradient: 7.646e-03
Kappa gradient: 7.725e-03
Kappa gradient: 7.641e-03

Epoch 80
Loss: 15.9259

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 7.411e-03
Kappa gradient: 7.052e-03
Kappa gradient: 6.584e-03
Kappa gradient: 6.023e-03
Kappa gradient: 5.390e-03
Kappa gradient: 4.701e-03
Kappa gradient: 3.977e-03
Kappa gradient: 3.234e-03
Kappa gradient: 2.489e-03
Kappa gradient: 1.759e-03

Epoch 90
Loss: 15.8649

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 1.058e-03
Kappa gradient: 3.987e-04
Kappa gradient: -2.093e-04
Kappa gradient: -7.575e-04
Kappa gradient: -1.240e-03
Kappa gradient: -1.651e-03
Kappa gradient: -1.989e-03
Kappa gradient: -2.252e-03
Kappa gradient: -2.442e-03
Kappa gradient: -2.559e-03

Epoch 100
Loss: 15.7926

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.608e-03
Kappa gradient: -2.594e-03
Kappa gradient: -2.524e-03
Kappa gradient: -2.404e-03
Kappa gradient: -2.242e-03
Kappa gradient: -2.044e-03
Kappa gradient: -1.820e-03
Kappa gradient: -1.576e-03
Kappa gradient: -1.320e-03
Kappa gradient: -1.059e-03

Epoch 110
Loss: 15.7245

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -7.993e-04
Kappa gradient: -5.480e-04
Kappa gradient: -3.097e-04
Kappa gradient: -8.928e-05
Kappa gradient: 1.101e-04
Kappa gradient: 2.857e-04
Kappa gradient: 4.353e-04
Kappa gradient: 5.579e-04
Kappa gradient: 6.527e-04
Kappa gradient: 7.200e-04

Epoch 120
Loss: 15.6662

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 7.606e-04
Kappa gradient: 7.759e-04
Kappa gradient: 7.681e-04
Kappa gradient: 7.397e-04
Kappa gradient: 6.931e-04
Kappa gradient: 6.312e-04
Kappa gradient: 5.570e-04
Kappa gradient: 4.734e-04
Kappa gradient: 3.833e-04
Kappa gradient: 2.898e-04

Epoch 130
Loss: 15.6058
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:56: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:115: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 1.955e-04
Kappa gradient: 1.030e-04
Kappa gradient: 1.463e-05
Kappa gradient: -6.784e-05
Kappa gradient: -1.427e-04
Kappa gradient: -2.087e-04
Kappa gradient: -2.652e-04
Kappa gradient: -3.111e-04
Kappa gradient: -3.466e-04
Kappa gradient: -3.715e-04

Epoch 140
Loss: 15.5465

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -3.860e-04
Kappa gradient: -3.908e-04
Kappa gradient: -3.867e-04
Kappa gradient: -3.747e-04
Kappa gradient: -3.557e-04
Kappa gradient: -3.311e-04
Kappa gradient: -3.019e-04
Kappa gradient: -2.693e-04
Kappa gradient: -2.346e-04
Kappa gradient: -1.990e-04

Epoch 150
Loss: 15.4870

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.634e-04
Kappa gradient: -1.290e-04
Kappa gradient: -9.663e-05
Kappa gradient: -6.694e-05
Kappa gradient: -4.042e-05
Kappa gradient: -1.769e-05
Kappa gradient: 1.177e-06
Kappa gradient: 1.574e-05
Kappa gradient: 2.624e-05
Kappa gradient: 3.260e-05

Epoch 160
Loss: 15.4278

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 3.504e-05
Kappa gradient: 3.402e-05
Kappa gradient: 2.974e-05
Kappa gradient: 2.273e-05
Kappa gradient: 1.343e-05
Kappa gradient: 2.299e-06
Kappa gradient: -1.014e-05
Kappa gradient: -2.342e-05
Kappa gradient: -3.700e-05
Kappa gradient: -5.057e-05

Epoch 170
Loss: 15.3693

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -6.360e-05
Kappa gradient: -7.581e-05
Kappa gradient: -8.691e-05
Kappa gradient: -9.660e-05
Kappa gradient: -1.048e-04
Kappa gradient: -1.114e-04
Kappa gradient: -1.162e-04
Kappa gradient: -1.194e-04
Kappa gradient: -1.210e-04
Kappa gradient: -1.209e-04

Epoch 180
Loss: 15.3117

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -1.196e-04
Kappa gradient: -1.171e-04
Kappa gradient: -1.135e-04
Kappa gradient: -1.091e-04
Kappa gradient: -1.040e-04
Kappa gradient: -9.866e-05
Kappa gradient: -9.303e-05
Kappa gradient: -8.748e-05
Kappa gradient: -8.202e-05
Kappa gradient: -7.694e-05

Epoch 190
Loss: 15.2538

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -7.232e-05
Kappa gradient: -6.812e-05
Kappa gradient: -6.462e-05
Kappa gradient: -6.181e-05
Kappa gradient: -5.957e-05
Kappa gradient: -5.812e-05
Kappa gradient: -5.736e-05
Kappa gradient: -5.713e-05
Kappa gradient: -5.768e-05
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_20000_30000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/model_enroll_fixedphi_sex_20000_30000.pt
  Learned kappa for this batch: 2.163558
Cleaning up memory...
✓ Batch 3/5 complete! (Time: 10.28 minutes)

================================================================================
BATCH 4/5: Processing samples 30000 to 40000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma (kappa free)...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma is fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa is free (will be learned per batch), initial value: 1.000000
Training model (estimating lambda and kappa, gamma is fixed)...
Kappa gradient: -1.089e+00

Epoch 0
Loss: 17.2917

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -9.085e-01
Kappa gradient: -7.590e-01
Kappa gradient: -6.340e-01
Kappa gradient: -5.287e-01
Kappa gradient: -4.391e-01
Kappa gradient: -3.623e-01
Kappa gradient: -2.963e-01
Kappa gradient: -2.392e-01
Kappa gradient: -1.896e-01
Kappa gradient: -1.464e-01

Epoch 10
Loss: 174.8387

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.087e-01
Kappa gradient: -7.573e-02
Kappa gradient: -4.700e-02
Kappa gradient: -2.199e-02
Kappa gradient: -2.605e-04
Kappa gradient: 1.855e-02
Kappa gradient: 3.475e-02
Kappa gradient: 4.861e-02
Kappa gradient: 6.037e-02
Kappa gradient: 7.024e-02

Epoch 20
Loss: 50.2184

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 7.840e-02
Kappa gradient: 8.501e-02
Kappa gradient: 9.019e-02
Kappa gradient: 9.405e-02
Kappa gradient: 9.669e-02
Kappa gradient: 9.821e-02
Kappa gradient: 9.868e-02
Kappa gradient: 9.819e-02
Kappa gradient: 9.683e-02
Kappa gradient: 9.466e-02

Epoch 30
Loss: 20.0081

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 9.176e-02
Kappa gradient: 8.820e-02
Kappa gradient: 8.407e-02
Kappa gradient: 7.941e-02
Kappa gradient: 7.430e-02
Kappa gradient: 6.880e-02
Kappa gradient: 6.296e-02
Kappa gradient: 5.686e-02
Kappa gradient: 5.056e-02
Kappa gradient: 4.414e-02

Epoch 40
Loss: 19.8039

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 3.766e-02
Kappa gradient: 3.122e-02
Kappa gradient: 2.487e-02
Kappa gradient: 1.869e-02
Kappa gradient: 1.274e-02
Kappa gradient: 7.094e-03
Kappa gradient: 1.793e-03
Kappa gradient: -3.110e-03
Kappa gradient: -7.574e-03
Kappa gradient: -1.156e-02

Epoch 50
Loss: 18.2526

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.504e-02
Kappa gradient: -1.799e-02
Kappa gradient: -2.041e-02
Kappa gradient: -2.229e-02
Kappa gradient: -2.364e-02
Kappa gradient: -2.448e-02
Kappa gradient: -2.485e-02
Kappa gradient: -2.477e-02
Kappa gradient: -2.429e-02
Kappa gradient: -2.344e-02

Epoch 60
Loss: 17.1231

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -2.229e-02
Kappa gradient: -2.086e-02
Kappa gradient: -1.922e-02
Kappa gradient: -1.740e-02
Kappa gradient: -1.546e-02
Kappa gradient: -1.344e-02
Kappa gradient: -1.138e-02
Kappa gradient: -9.325e-03
Kappa gradient: -7.313e-03
Kappa gradient: -5.371e-03

Epoch 70
Loss: 16.6389

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -3.526e-03
Kappa gradient: -1.800e-03
Kappa gradient: -2.100e-04
Kappa gradient: 1.230e-03
Kappa gradient: 2.508e-03
Kappa gradient: 3.616e-03
Kappa gradient: 4.551e-03
Kappa gradient: 5.311e-03
Kappa gradient: 5.900e-03
Kappa gradient: 6.322e-03

Epoch 80
Loss: 16.4805

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 6.586e-03
Kappa gradient: 6.703e-03
Kappa gradient: 6.683e-03
Kappa gradient: 6.539e-03
Kappa gradient: 6.284e-03
Kappa gradient: 5.931e-03
Kappa gradient: 5.496e-03
Kappa gradient: 4.993e-03
Kappa gradient: 4.439e-03
Kappa gradient: 3.848e-03

Epoch 90
Loss: 16.4194

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 3.235e-03
Kappa gradient: 2.615e-03
Kappa gradient: 2.000e-03
Kappa gradient: 1.400e-03
Kappa gradient: 8.259e-04
Kappa gradient: 2.868e-04
Kappa gradient: -2.098e-04
Kappa gradient: -6.574e-04
Kappa gradient: -1.051e-03
Kappa gradient: -1.387e-03

Epoch 100
Loss: 16.3470

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.663e-03
Kappa gradient: -1.880e-03
Kappa gradient: -2.039e-03
Kappa gradient: -2.141e-03
Kappa gradient: -2.190e-03
Kappa gradient: -2.189e-03
Kappa gradient: -2.143e-03
Kappa gradient: -2.057e-03
Kappa gradient: -1.936e-03
Kappa gradient: -1.785e-03

Epoch 110
Loss: 16.2789

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.612e-03
Kappa gradient: -1.422e-03
Kappa gradient: -1.221e-03
Kappa gradient: -1.015e-03
Kappa gradient: -8.070e-04
Kappa gradient: -6.034e-04
Kappa gradient: -4.075e-04
Kappa gradient: -2.233e-04
Kappa gradient: -5.384e-05
Kappa gradient: 9.840e-05

Epoch 120
Loss: 16.2206

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 2.315e-04
Kappa gradient: 3.442e-04
Kappa gradient: 4.359e-04
Kappa gradient: 5.066e-04
Kappa gradient: 5.567e-04
Kappa gradient: 5.869e-04
Kappa gradient: 5.983e-04
Kappa gradient: 5.923e-04
Kappa gradient: 5.705e-04
Kappa gradient: 5.350e-04

Epoch 130
Loss: 16.1600

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: 4.880e-04
Kappa gradient: 4.317e-04
Kappa gradient: 3.684e-04
Kappa gradient: 3.001e-04
Kappa gradient: 2.290e-04
Kappa gradient: 1.569e-04
Kappa gradient: 8.562e-05
Kappa gradient: 1.688e-05
Kappa gradient: -4.780e-05
Kappa gradient: -1.073e-04

Epoch 140
Loss: 16.1005

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.605e-04
Kappa gradient: -2.067e-04
Kappa gradient: -2.454e-04
Kappa gradient: -2.766e-04
Kappa gradient: -2.999e-04
Kappa gradient: -3.156e-04
Kappa gradient: -3.241e-04
Kappa gradient: -3.256e-04
Kappa gradient: -3.208e-04
Kappa gradient: -3.104e-04

Epoch 150
Loss: 16.0407

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.953e-04
Kappa gradient: -2.764e-04
Kappa gradient: -2.543e-04
Kappa gradient: -2.299e-04
Kappa gradient: -2.042e-04
Kappa gradient: -1.779e-04
Kappa gradient: -1.517e-04
Kappa gradient: -1.264e-04
Kappa gradient: -1.024e-04
Kappa gradient: -8.038e-05

Epoch 160
Loss: 15.9814

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:56: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma.py:115: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -6.059e-05
Kappa gradient: -4.333e-05
Kappa gradient: -2.893e-05
Kappa gradient: -1.738e-05
Kappa gradient: -8.845e-06
Kappa gradient: -3.151e-06
Kappa gradient: -3.059e-07
Kappa gradient: 4.657e-09
Kappa gradient: -2.135e-06
Kappa gradient: -6.265e-06

Epoch 170
Loss: 15.9225

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.215e-05
Kappa gradient: -1.946e-05
Kappa gradient: -2.781e-05
Kappa gradient: -3.693e-05
Kappa gradient: -4.646e-05
Kappa gradient: -5.612e-05
Kappa gradient: -6.559e-05
Kappa gradient: -7.469e-05
Kappa gradient: -8.306e-05
Kappa gradient: -9.071e-05

Epoch 180
Loss: 15.8642

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -9.744e-05
Kappa gradient: -1.030e-04
Kappa gradient: -1.076e-04
Kappa gradient: -1.109e-04
Kappa gradient: -1.130e-04
Kappa gradient: -1.141e-04
Kappa gradient: -1.142e-04
Kappa gradient: -1.132e-04
Kappa gradient: -1.116e-04
Kappa gradient: -1.092e-04

Epoch 190
Loss: 15.8057

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
Kappa gradient: -1.063e-04
Kappa gradient: -1.031e-04
Kappa gradient: -9.928e-05
Kappa gradient: -9.548e-05
Kappa gradient: -9.160e-05
Kappa gradient: -8.780e-05
Kappa gradient: -8.422e-05
Kappa gradient: -8.087e-05
Kappa gradient: -7.793e-05
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_30000_40000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/model_enroll_fixedphi_sex_30000_40000.pt
  Learned kappa for this batch: 2.221474
Cleaning up memory...
✓ Batch 4/5 complete! (Time: 10.25 minutes)

================================================================================
BATCH 5/5: Processing samples 40000 to 50000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma (kappa free)...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma is fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa is free (will be learned per batch), initial value: 1.000000
Training model (estimating lambda and kappa, gamma is fixed)...
Kappa gradient: -1.065e+00

Epoch 0
Loss: 16.9724

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: -8.878e-01
Kappa gradient: -7.410e-01
Kappa gradient: -6.182e-01
Kappa gradient: -5.148e-01
Kappa gradient: -4.268e-01
Kappa gradient: -3.514e-01
Kappa gradient: -2.866e-01
Kappa gradient: -2.306e-01
Kappa gradient: -1.820e-01
Kappa gradient: -1.396e-01

Epoch 10
Loss: 174.5483

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: -1.027e-01
Kappa gradient: -7.043e-02
Kappa gradient: -4.234e-02
Kappa gradient: -1.791e-02
Kappa gradient: 3.290e-03
Kappa gradient: 2.161e-02
Kappa gradient: 3.736e-02
Kappa gradient: 5.081e-02
Kappa gradient: 6.218e-02
Kappa gradient: 7.169e-02

Epoch 20
Loss: 49.9180

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: 7.951e-02
Kappa gradient: 8.580e-02
Kappa gradient: 9.067e-02
Kappa gradient: 9.425e-02
Kappa gradient: 9.663e-02
Kappa gradient: 9.789e-02
Kappa gradient: 9.812e-02
Kappa gradient: 9.740e-02
Kappa gradient: 9.582e-02
Kappa gradient: 9.345e-02

Epoch 30
Loss: 19.6952

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: 9.036e-02
Kappa gradient: 8.663e-02
Kappa gradient: 8.232e-02
Kappa gradient: 7.752e-02
Kappa gradient: 7.227e-02
Kappa gradient: 6.663e-02
Kappa gradient: 6.069e-02
Kappa gradient: 5.449e-02
Kappa gradient: 4.812e-02
Kappa gradient: 4.165e-02

Epoch 40
Loss: 19.4966

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: 3.514e-02
Kappa gradient: 2.869e-02
Kappa gradient: 2.236e-02
Kappa gradient: 1.622e-02
Kappa gradient: 1.034e-02
Kappa gradient: 4.779e-03
Kappa gradient: -4.079e-04
Kappa gradient: -5.174e-03
Kappa gradient: -9.478e-03
Kappa gradient: -1.328e-02

Epoch 50
Loss: 17.9463

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: -1.657e-02
Kappa gradient: -1.931e-02
Kappa gradient: -2.151e-02
Kappa gradient: -2.316e-02
Kappa gradient: -2.429e-02
Kappa gradient: -2.490e-02
Kappa gradient: -2.505e-02
Kappa gradient: -2.476e-02
Kappa gradient: -2.408e-02
Kappa gradient: -2.306e-02

Epoch 60
Loss: 16.8159

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000
Kappa gradient: -2.173e-02
Kappa gradient: -2.016e-02
Kappa gradient: -1.839e-02
Kappa gradient: -1.647e-02
Kappa gradient: -1.445e-02
Kappa gradient: -1.237e-02
Kappa gradient: -1.027e-02
Kappa gradient: -8.204e-03
Kappa gradient: -6.194e-03
Kappa gradient: -4.273e-03

Epoch 70
Loss: 16.3310

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -2.464e-03
Kappa gradient: -7.881e-04
Kappa gradient: 7.389e-04
Kappa gradient: 2.104e-03
Kappa gradient: 3.299e-03
Kappa gradient: 4.318e-03
Kappa gradient: 5.158e-03
Kappa gradient: 5.820e-03
Kappa gradient: 6.309e-03
Kappa gradient: 6.632e-03

Epoch 80
Loss: 16.1720

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 6.799e-03
Kappa gradient: 6.821e-03
Kappa gradient: 6.712e-03
Kappa gradient: 6.484e-03
Kappa gradient: 6.151e-03
Kappa gradient: 5.729e-03
Kappa gradient: 5.233e-03
Kappa gradient: 4.679e-03
Kappa gradient: 4.082e-03
Kappa gradient: 3.458e-03

Epoch 90
Loss: 16.1103

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 2.822e-03
Kappa gradient: 2.187e-03
Kappa gradient: 1.566e-03
Kappa gradient: 9.696e-04
Kappa gradient: 4.070e-04
Kappa gradient: -1.135e-04
Kappa gradient: -5.848e-04
Kappa gradient: -1.001e-03
Kappa gradient: -1.359e-03
Kappa gradient: -1.656e-03

Epoch 100
Loss: 16.0372

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.891e-03
Kappa gradient: -2.065e-03
Kappa gradient: -2.180e-03
Kappa gradient: -2.239e-03
Kappa gradient: -2.245e-03
Kappa gradient: -2.204e-03
Kappa gradient: -2.120e-03
Kappa gradient: -2.000e-03
Kappa gradient: -1.848e-03
Kappa gradient: -1.671e-03

Epoch 110
Loss: 15.9684

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: -1.476e-03
Kappa gradient: -1.269e-03
Kappa gradient: -1.055e-03
Kappa gradient: -8.402e-04
Kappa gradient: -6.288e-04
Kappa gradient: -4.253e-04
Kappa gradient: -2.335e-04
Kappa gradient: -5.688e-05
Kappa gradient: 1.020e-04
Kappa gradient: 2.411e-04

Epoch 120
Loss: 15.9095

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 3.590e-04
Kappa gradient: 4.548e-04
Kappa gradient: 5.287e-04
Kappa gradient: 5.809e-04
Kappa gradient: 6.123e-04
Kappa gradient: 6.241e-04
Kappa gradient: 6.177e-04
Kappa gradient: 5.949e-04
Kappa gradient: 5.578e-04
Kappa gradient: 5.085e-04

Epoch 130
Loss: 15.8484

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000
Kappa gradient: 4.495e-04
Kappa gradient: 3.830e-04
Kappa gradient: 3.116e-04
Kappa gradient: 2.372e-04
Kappa gradient: 1.620e-04
Kappa gradient: 8.784e-05
Kappa gradient: 1.638e-05
Kappa gradient: -5.076e-05
Kappa gradient: -1.124e-04
Kappa gradient: -1.673e-04

Epoch 140
Loss: 15.7885

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.149e-04
Kappa gradient: -2.545e-04
Kappa gradient: -2.861e-04
Kappa gradient: -3.095e-04
Kappa gradient: -3.249e-04
Kappa gradient: -3.327e-04
Kappa gradient: -3.333e-04
Kappa gradient: -3.274e-04
Kappa gradient: -3.157e-04
Kappa gradient: -2.992e-04

Epoch 150
Loss: 15.7284

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -2.785e-04
Kappa gradient: -2.548e-04
Kappa gradient: -2.290e-04
Kappa gradient: -2.017e-04
Kappa gradient: -1.740e-04
Kappa gradient: -1.466e-04
Kappa gradient: -1.201e-04
Kappa gradient: -9.524e-05
Kappa gradient: -7.252e-05
Kappa gradient: -5.236e-05

Epoch 160
Loss: 15.6688

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -3.500e-05
Kappa gradient: -2.067e-05
Kappa gradient: -9.393e-06
Kappa gradient: -1.212e-06
Kappa gradient: 3.844e-06
Kappa gradient: 6.135e-06
Kappa gradient: 5.637e-06
Kappa gradient: 2.742e-06
Kappa gradient: -2.302e-06
Kappa gradient: -9.093e-06

Epoch 170
Loss: 15.6098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.726e-05
Kappa gradient: -2.637e-05
Kappa gradient: -3.627e-05
Kappa gradient: -4.642e-05
Kappa gradient: -5.665e-05
Kappa gradient: -6.668e-05
Kappa gradient: -7.602e-05
Kappa gradient: -8.474e-05
Kappa gradient: -9.232e-05
Kappa gradient: -9.903e-05

Epoch 180
Loss: 15.5515

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.045e-04
Kappa gradient: -1.087e-04
Kappa gradient: -1.119e-04
Kappa gradient: -1.137e-04
Kappa gradient: -1.143e-04
Kappa gradient: -1.140e-04
Kappa gradient: -1.126e-04
Kappa gradient: -1.105e-04
Kappa gradient: -1.077e-04
Kappa gradient: -1.042e-04

Epoch 190
Loss: 15.4929

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
Kappa gradient: -1.005e-04
Kappa gradient: -9.654e-05
Kappa gradient: -9.234e-05
Kappa gradient: -8.828e-05
Kappa gradient: -8.425e-05
Kappa gradient: -8.050e-05
Kappa gradient: -7.707e-05
Kappa gradient: -7.405e-05
Kappa gradient: -7.140e-05
Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_40000_50000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/model_enroll_fixedphi_sex_40000_50000.pt
  Learned kappa for this batch: 2.209823
Cleaning up memory...
✓ Batch 5/5 complete! (Time: 10.26 minutes)

================================================================================
ALL BATCHES COMPLETE!
================================================================================

Concatenating all predictions into single file...
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_0_10000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_10000_20000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_20000_30000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_30000_40000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_40000_50000.pt, shape: torch.Size([10000, 348, 52])

Concatenating 5 batches...
Final shape: torch.Size([50000, 348, 52])
✓ Saved combined predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/pi_enroll_fixedphi_sex_FULL.pt
✓ Saved batch info to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedg_freek_vectorized/batch_info.pt

================================================================================
DONE! Predictions use fixed gamma (kappa was learned per batch).
================================================================================
