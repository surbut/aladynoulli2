============================================================
ABLATION: SINGLE-PHASE SLOPE TRAINING
Batches 8 to 39
Total epochs: 300 (all params free from start)
Warm-starting gamma_level from POOLED 40-batch gamma
============================================================
Pooled gamma from 40 batches: shape (47, 21), mean|gamma|=0.1091
Pooled psi from 40 batches: shape (21, 348)
Data loaded: Y torch.Size([407878, 348, 52]), E torch.Size([407878, 348]), G (407878, 47)

--- Batch 8/39 ---
  Batch 8: already exists, skipping.
  Completed batch 8; 1/32 done.

--- Batch 9/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0043, range=[-0.0378, 0.0143]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.61, NLL=52.37, |gamma_slope|=3.0659
  Epoch   50: loss=46.05, NLL=44.53, |gamma_slope|=4.6317
  Epoch  100: loss=43.64, NLL=43.08, |gamma_slope|=5.8994
  Epoch  150: loss=42.52, NLL=41.92, |gamma_slope|=7.2161
  Epoch  200: loss=41.62, NLL=40.97, |gamma_slope|=7.6121
  Epoch  250: loss=40.87, NLL=40.18, |gamma_slope|=8.1480
  Epoch  299: loss=40.29, NLL=39.56, |gamma_slope|=8.8216
  Batch 9: done in 1428s (23.8min), final_loss=40.29, |gamma_slope|=0.1539
  Completed batch 9; 2/32 done.

--- Batch 10/39 ---
  Batch 10: already exists, skipping.
  Completed batch 10; 3/32 done.

--- Batch 11/39 ---
  Batch 11: already exists, skipping.
  Completed batch 11; 4/32 done.

--- Batch 12/39 ---
  Batch 12: already exists, skipping.
  Completed batch 12; 5/32 done.

--- Batch 13/39 ---
  Batch 13: already exists, skipping.
  Completed batch 13; 6/32 done.

--- Batch 14/39 ---
  Batch 14: already exists, skipping.
  Completed batch 14; 7/32 done.

--- Batch 15/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0045, range=[-0.0228, 0.0389]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.65, NLL=51.04, |gamma_slope|=3.0659
  Epoch   50: loss=45.66, NLL=44.16, |gamma_slope|=4.7606
  Epoch  100: loss=43.21, NLL=42.66, |gamma_slope|=6.0555
  Epoch  150: loss=42.04, NLL=41.44, |gamma_slope|=7.7709
  Epoch  200: loss=41.09, NLL=40.44, |gamma_slope|=9.0779
  Epoch  250: loss=40.32, NLL=39.63, |gamma_slope|=9.8552
  Epoch  299: loss=39.71, NLL=38.98, |gamma_slope|=10.3127
  Batch 15: done in 998s (16.6min), final_loss=39.71, |gamma_slope|=0.1671
  Completed batch 15; 8/32 done.

--- Batch 16/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0045, range=[-0.0328, 0.0163]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.23, NLL=51.28, |gamma_slope|=3.0659
  Epoch   50: loss=45.45, NLL=43.95, |gamma_slope|=4.4194
  Epoch  100: loss=43.21, NLL=42.66, |gamma_slope|=5.6978
  Epoch  150: loss=42.17, NLL=41.57, |gamma_slope|=6.5770
  Epoch  200: loss=41.29, NLL=40.66, |gamma_slope|=7.5214
  Epoch  250: loss=40.57, NLL=39.89, |gamma_slope|=8.3279
  Epoch  299: loss=39.98, NLL=39.26, |gamma_slope|=9.1266
  Batch 16: done in 967s (16.1min), final_loss=39.98, |gamma_slope|=0.1481
  Completed batch 16; 9/32 done.

--- Batch 17/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0047, range=[-0.0158, 0.0332]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.84, NLL=51.69, |gamma_slope|=3.0659
  Epoch   50: loss=45.70, NLL=44.19, |gamma_slope|=4.3146
  Epoch  100: loss=43.34, NLL=42.78, |gamma_slope|=5.5109
  Epoch  150: loss=42.20, NLL=41.60, |gamma_slope|=6.7647
  Epoch  200: loss=41.33, NLL=40.68, |gamma_slope|=8.1399
  Epoch  250: loss=40.54, NLL=39.85, |gamma_slope|=9.1110
  Epoch  299: loss=39.94, NLL=39.21, |gamma_slope|=9.6105
  Batch 17: done in 981s (16.4min), final_loss=39.94, |gamma_slope|=0.1451
  Completed batch 17; 10/32 done.

--- Batch 18/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0042, range=[-0.0221, 0.0218]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.03, NLL=51.77, |gamma_slope|=3.0659
  Epoch   50: loss=46.24, NLL=44.73, |gamma_slope|=4.6506
  Epoch  100: loss=43.90, NLL=43.35, |gamma_slope|=6.4652
  Epoch  150: loss=42.81, NLL=42.22, |gamma_slope|=7.5950
  Epoch  200: loss=41.93, NLL=41.30, |gamma_slope|=8.7869
  Epoch  250: loss=41.20, NLL=40.52, |gamma_slope|=9.7141
  Epoch  299: loss=40.61, NLL=39.89, |gamma_slope|=10.5129
  Batch 18: done in 978s (16.3min), final_loss=40.61, |gamma_slope|=0.1728
  Completed batch 18; 11/32 done.

--- Batch 19/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0046, range=[-0.0237, 0.0235]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.16, NLL=51.69, |gamma_slope|=3.0659
  Epoch   50: loss=46.27, NLL=44.75, |gamma_slope|=4.8735
  Epoch  100: loss=43.87, NLL=43.31, |gamma_slope|=6.0295
  Epoch  150: loss=42.75, NLL=42.15, |gamma_slope|=7.4720
  Epoch  200: loss=41.84, NLL=41.20, |gamma_slope|=8.8047
  Epoch  250: loss=41.14, NLL=40.44, |gamma_slope|=9.4268
  Epoch  299: loss=40.51, NLL=39.79, |gamma_slope|=9.9924
  Batch 19: done in 987s (16.4min), final_loss=40.51, |gamma_slope|=0.1663
  Completed batch 19; 12/32 done.

--- Batch 20/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0052, range=[-0.0239, 0.0356]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.95, NLL=51.70, |gamma_slope|=3.0659
  Epoch   50: loss=46.05, NLL=44.53, |gamma_slope|=4.8428
  Epoch  100: loss=43.60, NLL=43.05, |gamma_slope|=5.8042
  Epoch  150: loss=42.45, NLL=41.86, |gamma_slope|=7.2424
  Epoch  200: loss=41.53, NLL=40.89, |gamma_slope|=8.5806
  Epoch  250: loss=40.77, NLL=40.10, |gamma_slope|=9.2090
  Epoch  299: loss=40.18, NLL=39.47, |gamma_slope|=9.5392
  Batch 20: done in 989s (16.5min), final_loss=40.18, |gamma_slope|=0.1565
  Completed batch 20; 13/32 done.

--- Batch 21/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0053, range=[-0.0240, 0.0411]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.18, NLL=51.76, |gamma_slope|=3.0659
  Epoch   50: loss=45.73, NLL=44.22, |gamma_slope|=4.9225
  Epoch  100: loss=43.34, NLL=42.78, |gamma_slope|=5.8212
  Epoch  150: loss=42.23, NLL=41.62, |gamma_slope|=6.9808
  Epoch  200: loss=41.36, NLL=40.70, |gamma_slope|=7.6992
  Epoch  250: loss=40.63, NLL=39.93, |gamma_slope|=8.1196
  Epoch  299: loss=40.05, NLL=39.31, |gamma_slope|=8.6175
  Batch 21: done in 989s (16.5min), final_loss=40.05, |gamma_slope|=0.1480
  Completed batch 21; 14/32 done.

--- Batch 22/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0050, range=[-0.0678, 0.0295]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.76, NLL=51.71, |gamma_slope|=3.0659
  Epoch   50: loss=46.01, NLL=44.51, |gamma_slope|=4.4192
  Epoch  100: loss=43.59, NLL=43.04, |gamma_slope|=5.6000
  Epoch  150: loss=42.44, NLL=41.84, |gamma_slope|=6.7416
  Epoch  200: loss=41.53, NLL=40.89, |gamma_slope|=7.7374
  Epoch  250: loss=40.80, NLL=40.12, |gamma_slope|=8.6180
  Epoch  299: loss=40.21, NLL=39.50, |gamma_slope|=9.1962
  Batch 22: done in 995s (16.6min), final_loss=40.21, |gamma_slope|=0.1524
  Completed batch 22; 15/32 done.

--- Batch 23/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0052, range=[-0.0217, 0.0239]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.40, NLL=50.96, |gamma_slope|=3.0659
  Epoch   50: loss=45.59, NLL=44.08, |gamma_slope|=4.5051
  Epoch  100: loss=43.28, NLL=42.73, |gamma_slope|=5.8084
  Epoch  150: loss=42.22, NLL=41.62, |gamma_slope|=7.2328
  Epoch  200: loss=41.34, NLL=40.71, |gamma_slope|=8.3775
  Epoch  250: loss=40.62, NLL=39.95, |gamma_slope|=9.4535
  Epoch  299: loss=40.06, NLL=39.34, |gamma_slope|=10.0883
  Batch 23: done in 964s (16.1min), final_loss=40.06, |gamma_slope|=0.1634
  Completed batch 23; 16/32 done.

--- Batch 24/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0048, range=[-0.0237, 0.0207]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.03, NLL=52.32, |gamma_slope|=3.0659
  Epoch   50: loss=46.28, NLL=44.77, |gamma_slope|=4.1993
  Epoch  100: loss=44.00, NLL=43.45, |gamma_slope|=5.5375
  Epoch  150: loss=42.94, NLL=42.34, |gamma_slope|=6.2410
  Epoch  200: loss=42.07, NLL=41.43, |gamma_slope|=6.9245
  Epoch  250: loss=41.36, NLL=40.68, |gamma_slope|=7.5185
  Epoch  299: loss=40.78, NLL=40.06, |gamma_slope|=8.0521
  Batch 24: done in 935s (15.6min), final_loss=40.78, |gamma_slope|=0.1480
  Completed batch 24; 17/32 done.

--- Batch 25/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0046, range=[-0.0276, 0.0263]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.44, NLL=51.44, |gamma_slope|=3.0659
  Epoch   50: loss=45.78, NLL=44.28, |gamma_slope|=4.4699
  Epoch  100: loss=43.47, NLL=42.93, |gamma_slope|=5.4014
  Epoch  150: loss=42.41, NLL=41.83, |gamma_slope|=6.5582
  Epoch  200: loss=41.54, NLL=40.91, |gamma_slope|=7.7036
  Epoch  250: loss=40.82, NLL=40.15, |gamma_slope|=8.8812
  Epoch  299: loss=40.24, NLL=39.53, |gamma_slope|=9.9786
  Batch 25: done in 925s (15.4min), final_loss=40.24, |gamma_slope|=0.1690
  Completed batch 25; 18/32 done.

--- Batch 26/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0059, range=[-0.0257, 0.0230]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.61, NLL=51.56, |gamma_slope|=3.0659
  Epoch   50: loss=45.85, NLL=44.35, |gamma_slope|=4.0294
  Epoch  100: loss=43.57, NLL=43.02, |gamma_slope|=5.3782
  Epoch  150: loss=42.50, NLL=41.91, |gamma_slope|=6.8089
  Epoch  200: loss=41.63, NLL=40.99, |gamma_slope|=7.8774
  Epoch  250: loss=40.91, NLL=40.23, |gamma_slope|=8.7922
  Epoch  299: loss=40.36, NLL=39.64, |gamma_slope|=9.5666
  Batch 26: done in 924s (15.4min), final_loss=40.36, |gamma_slope|=0.1637
  Completed batch 26; 19/32 done.

--- Batch 27/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0051, range=[-0.0267, 0.0271]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.55, NLL=52.00, |gamma_slope|=3.0659
  Epoch   50: loss=46.12, NLL=44.62, |gamma_slope|=4.5482
  Epoch  100: loss=43.73, NLL=43.17, |gamma_slope|=5.5573
  Epoch  150: loss=42.61, NLL=42.01, |gamma_slope|=6.4351
  Epoch  200: loss=41.74, NLL=41.07, |gamma_slope|=7.1423
  Epoch  250: loss=40.98, NLL=40.29, |gamma_slope|=7.7600
  Epoch  299: loss=40.46, NLL=39.67, |gamma_slope|=8.4251
  Batch 27: done in 903s (15.1min), final_loss=40.46, |gamma_slope|=0.1518
  Completed batch 27; 20/32 done.

--- Batch 28/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0055, range=[-0.0311, 0.0280]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.10, NLL=51.87, |gamma_slope|=3.0659
  Epoch   50: loss=46.26, NLL=44.75, |gamma_slope|=4.3300
  Epoch  100: loss=43.86, NLL=43.30, |gamma_slope|=5.5906
  Epoch  150: loss=42.74, NLL=42.13, |gamma_slope|=6.9720
  Epoch  200: loss=41.83, NLL=41.19, |gamma_slope|=8.1510
  Epoch  250: loss=41.14, NLL=40.45, |gamma_slope|=8.9246
  Epoch  299: loss=40.55, NLL=39.84, |gamma_slope|=9.6075
  Batch 28: done in 873s (14.5min), final_loss=40.55, |gamma_slope|=0.1523
  Completed batch 28; 21/32 done.

--- Batch 29/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0056, range=[-0.0314, 0.0191]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.66, NLL=51.58, |gamma_slope|=3.0659
  Epoch   50: loss=45.89, NLL=44.38, |gamma_slope|=4.8733
  Epoch  100: loss=43.57, NLL=43.02, |gamma_slope|=6.0846
  Epoch  150: loss=42.50, NLL=41.91, |gamma_slope|=7.4236
  Epoch  200: loss=41.62, NLL=40.98, |gamma_slope|=8.4815
  Epoch  250: loss=40.91, NLL=40.23, |gamma_slope|=9.0406
  Epoch  299: loss=40.33, NLL=39.61, |gamma_slope|=9.6305
  Batch 29: done in 874s (14.6min), final_loss=40.33, |gamma_slope|=0.1564
  Completed batch 29; 22/32 done.

--- Batch 30/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0040, range=[-0.0257, 0.0160]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.14, NLL=51.62, |gamma_slope|=3.0659
  Epoch   50: loss=45.47, NLL=43.97, |gamma_slope|=4.6252
  Epoch  100: loss=43.16, NLL=42.62, |gamma_slope|=6.0489
  Epoch  150: loss=42.10, NLL=41.51, |gamma_slope|=7.0823
  Epoch  200: loss=41.22, NLL=40.59, |gamma_slope|=7.6529
  Epoch  250: loss=40.50, NLL=39.82, |gamma_slope|=8.1619
  Epoch  299: loss=39.90, NLL=39.19, |gamma_slope|=8.8931
  Batch 30: done in 857s (14.3min), final_loss=39.90, |gamma_slope|=0.1532
  Completed batch 30; 23/32 done.

--- Batch 31/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0058, range=[-0.0294, 0.0549]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.60, NLL=51.54, |gamma_slope|=3.0659
  Epoch   50: loss=45.65, NLL=44.15, |gamma_slope|=4.4744
  Epoch  100: loss=43.34, NLL=42.79, |gamma_slope|=6.0102
  Epoch  150: loss=42.26, NLL=41.66, |gamma_slope|=7.7100
  Epoch  200: loss=41.35, NLL=40.70, |gamma_slope|=8.8630
  Epoch  250: loss=40.59, NLL=39.91, |gamma_slope|=9.6873
  Epoch  299: loss=39.98, NLL=39.25, |gamma_slope|=10.3141
  Batch 31: done in 852s (14.2min), final_loss=39.98, |gamma_slope|=0.1608
  Completed batch 31; 24/32 done.

--- Batch 32/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0043, range=[-0.0304, 0.0190]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.02, NLL=52.42, |gamma_slope|=3.0659
  Epoch   50: loss=46.27, NLL=44.76, |gamma_slope|=4.2608
  Epoch  100: loss=44.00, NLL=43.44, |gamma_slope|=5.9966
  Epoch  150: loss=42.96, NLL=42.36, |gamma_slope|=6.6358
  Epoch  200: loss=42.10, NLL=41.45, |gamma_slope|=7.0796
  Epoch  250: loss=41.38, NLL=40.69, |gamma_slope|=7.7709
  Epoch  299: loss=40.80, NLL=40.07, |gamma_slope|=8.5161
  Batch 32: done in 843s (14.0min), final_loss=40.80, |gamma_slope|=0.1498
  Completed batch 32; 25/32 done.

--- Batch 33/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0053, range=[-0.0588, 0.0274]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.05, NLL=51.78, |gamma_slope|=3.0659
  Epoch   50: loss=46.21, NLL=44.70, |gamma_slope|=4.2273
  Epoch  100: loss=43.88, NLL=43.32, |gamma_slope|=5.4809
  Epoch  150: loss=42.81, NLL=42.21, |gamma_slope|=7.0058
  Epoch  200: loss=41.93, NLL=41.29, |gamma_slope|=8.4233
  Epoch  250: loss=41.25, NLL=40.58, |gamma_slope|=9.8453
  Epoch  299: loss=40.63, NLL=39.91, |gamma_slope|=10.6447
  Batch 33: done in 824s (13.7min), final_loss=40.63, |gamma_slope|=0.1649
  Completed batch 33; 26/32 done.

--- Batch 34/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0049, range=[-0.0199, 0.0183]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.51, NLL=51.66, |gamma_slope|=3.0658
  Epoch   50: loss=45.71, NLL=44.20, |gamma_slope|=4.3001
  Epoch  100: loss=43.42, NLL=42.87, |gamma_slope|=5.7949
  Epoch  150: loss=42.36, NLL=41.77, |gamma_slope|=7.0293
  Epoch  200: loss=41.50, NLL=40.87, |gamma_slope|=8.0219
  Epoch  250: loss=40.77, NLL=40.10, |gamma_slope|=8.8904
  Epoch  299: loss=40.18, NLL=39.47, |gamma_slope|=9.7958
  Batch 34: done in 810s (13.5min), final_loss=40.18, |gamma_slope|=0.1588
  Completed batch 34; 27/32 done.

--- Batch 35/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0051, range=[-0.0367, 0.0200]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.81, NLL=51.98, |gamma_slope|=3.0659
  Epoch   50: loss=45.95, NLL=44.46, |gamma_slope|=4.6586
  Epoch  100: loss=43.66, NLL=43.12, |gamma_slope|=5.6248
  Epoch  150: loss=42.60, NLL=42.01, |gamma_slope|=6.5133
  Epoch  200: loss=41.72, NLL=41.09, |gamma_slope|=7.2647
  Epoch  250: loss=40.99, NLL=40.31, |gamma_slope|=8.0522
  Epoch  299: loss=40.39, NLL=39.68, |gamma_slope|=8.9520
  Batch 35: done in 821s (13.7min), final_loss=40.39, |gamma_slope|=0.1626
  Completed batch 35; 28/32 done.

--- Batch 36/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0048, range=[-0.0244, 0.0167]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=46.80, NLL=51.20, |gamma_slope|=3.0659
  Epoch   50: loss=45.21, NLL=43.71, |gamma_slope|=5.0647
  Epoch  100: loss=42.88, NLL=42.34, |gamma_slope|=6.1709
  Epoch  150: loss=41.82, NLL=41.23, |gamma_slope|=7.6893
  Epoch  200: loss=40.96, NLL=40.33, |gamma_slope|=8.7183
  Epoch  250: loss=40.27, NLL=39.58, |gamma_slope|=9.6009
  Epoch  299: loss=39.68, NLL=38.97, |gamma_slope|=10.2583
  Batch 36: done in 821s (13.7min), final_loss=39.68, |gamma_slope|=0.1639
  Completed batch 36; 29/32 done.

--- Batch 37/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=0.0000, std=0.0049, range=[-0.0249, 0.0241]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=48.04, NLL=52.10, |gamma_slope|=3.0659
  Epoch   50: loss=46.03, NLL=44.53, |gamma_slope|=5.0439
  Epoch  100: loss=43.62, NLL=43.07, |gamma_slope|=5.7633
  Epoch  150: loss=42.47, NLL=41.87, |gamma_slope|=6.7356
  Epoch  200: loss=41.53, NLL=40.89, |gamma_slope|=7.8370
  Epoch  250: loss=40.76, NLL=40.07, |gamma_slope|=8.6747
  Epoch  299: loss=40.17, NLL=39.44, |gamma_slope|=9.5202
  Batch 37: done in 822s (13.7min), final_loss=40.17, |gamma_slope|=0.1570
  Completed batch 37; 30/32 done.

--- Batch 38/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0046, range=[-0.0511, 0.0314]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.57, NLL=51.74, |gamma_slope|=3.0659
  Epoch   50: loss=45.94, NLL=44.43, |gamma_slope|=4.3728
  Epoch  100: loss=43.64, NLL=43.08, |gamma_slope|=5.7667
  Epoch  150: loss=42.58, NLL=41.98, |gamma_slope|=6.8124
  Epoch  200: loss=41.71, NLL=41.07, |gamma_slope|=7.7685
  Epoch  250: loss=41.00, NLL=40.32, |gamma_slope|=8.5778
  Epoch  299: loss=40.41, NLL=39.70, |gamma_slope|=9.2018
  Batch 38: done in 827s (13.8min), final_loss=40.41, |gamma_slope|=0.1669
  Completed batch 38; 31/32 done.

--- Batch 39/39 ---
Warm-starting from pretrained gamma (torch.Size([47, 21])), psi (torch.Size([21, 348]))
Estimated gamma_health from pretrained delta (health sig mean -> G regression)
  alpha_i: mean=-0.0000, std=0.0049, range=[-0.0229, 0.0209]
Slope model init: gamma_level torch.Size([47, 21]), gamma_slope torch.Size([47, 21]) (zeros), delta torch.Size([10000, 21, 52]), epsilon torch.Size([21, 348, 52])
============================================================
SINGLE PHASE: all params train together (300 epochs)
============================================================
  Epoch    0: loss=47.52, NLL=51.69, |gamma_slope|=3.0659
  Epoch   50: loss=45.10, NLL=43.59, |gamma_slope|=4.7000
  Epoch  100: loss=42.76, NLL=42.21, |gamma_slope|=5.7430
  Epoch  150: loss=41.71, NLL=41.12, |gamma_slope|=7.1257
  Epoch  200: loss=40.82, NLL=40.18, |gamma_slope|=8.1079
  Epoch  250: loss=40.12, NLL=39.43, |gamma_slope|=8.9413
  Epoch  299: loss=39.53, NLL=38.81, |gamma_slope|=9.7405
  Batch 39: done in 892s (14.9min), final_loss=39.53, |gamma_slope|=0.1553
  Completed batch 39; 32/32 done.

All done! Total time: 24090s (6.7h)
