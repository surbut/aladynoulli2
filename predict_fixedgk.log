/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

================================================================================
Aladyn Prediction Script - Fixed Phi/Psi/Gamma/Kappa Mode
================================================================================
Trained model: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt
Pooled gamma/kappa: /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma.pt
Output directory: /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/
Batch size: 10000
================================================================================

Loading components...
Loaded all components successfully!
Loading covariates data...
Loaded 407878 samples from covariates file
Loading reference trajectories...
Loading initial_psi...
Loaded initial_psi shape: (20, 348)
Loading master checkpoint from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/master_for_fitting_pooled_correctedE.pt...
Master checkpoint description: Pooled phi from all retrospective batches + initial_psi
Loaded pooled phi shape: (21, 348, 52)
Loaded psi_total shape: (21, 348)
Loading pooled gamma and kappa from /Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/data_for_running/pooled_kappa_gamma.pt...
Loaded pooled gamma shape: (47, 21)
Loaded pooled kappa: 2.932933
⚠️  Limiting to 40 batches

Will process 40 batches of 10000 samples
Total samples: 407878
Processing samples: 0 to 400000


================================================================================
BATCH 1/40: Processing samples 0 to 10000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5297

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.5140

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.9357

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.7233

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5259

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9764

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8453

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3607

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2012

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1391

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.0656

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.9965

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.9373

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8759

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8157

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7555

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6957

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6367

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 180
Loss: 15.5784

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.5200

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         1692496 function calls (1671385 primitive calls) in 648.826 seconds

   Ordered by: cumulative time
   List reduced from 4206 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.179    0.179  648.827  648.827 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  141.661    0.708  365.632    1.828 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  278.158    1.391 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  278.157    1.391 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  278.147    1.391 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  278.144    1.391  278.144    1.391 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.744    0.674  138.181    0.691 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.657    0.030   30.459    0.138 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   24.974    0.042   24.974    0.042 {built-in method torch.log}
      220    0.003    0.000   16.351    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_0_10000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_0_10000.pt
Cleaning up memory...
✓ Batch 1/40 complete!

================================================================================
BATCH 2/40: Processing samples 10000 to 20000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3932

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4036

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.8020

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.5859

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.3947

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.8461

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7163

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.2333

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.0757

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.0156

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.9442

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.8772

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.8201

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.7608

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7025

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.6441

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5859

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5283

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4713

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 657.965 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.162    0.162  657.965  657.965 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  143.651    0.718  368.035    1.840 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  285.643    1.428 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  285.641    1.428 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  285.633    1.428 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  285.631    1.428  285.631    1.428 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.857    0.674  138.131    0.691 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.784    0.031   29.935    0.136 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   24.526    0.041   24.526    0.041 {built-in method torch.log}
      220    0.003    0.000   15.513    0.071 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_10000_20000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_10000_20000.pt
Cleaning up memory...
✓ Batch 2/40 complete!

================================================================================
BATCH 3/40: Processing samples 20000 to 30000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3476

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.3514

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.7530

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.5381

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.3460

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 50
Loss: 17.7981

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 60
Loss: 16.6680

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 70
Loss: 16.1842

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 80
Loss: 16.0255

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 15.9643

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 15.8916

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.8232

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7646

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.7038

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.6441

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5843

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5249

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4660

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4078

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.3498

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 592.819 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.155    0.155  592.819  592.819 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  130.888    0.654  338.458    1.692 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  250.646    1.253 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  250.644    1.253 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  250.637    1.253 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  250.635    1.253  250.635    1.253 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.959    0.625  128.046    0.640 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.003    0.027   27.370    0.124 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.820    0.038   22.820    0.038 {built-in method torch.log}
      220    0.002    0.000   14.895    0.068 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_20000_30000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_20000_30000.pt
Cleaning up memory...
✓ Batch 3/40 complete!

================================================================================
BATCH 4/40: Processing samples 30000 to 40000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.8897

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.8641

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.2943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 20.0852

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.8876

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.3383

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.2081

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.7242

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.5655

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.5043

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.4315

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.3632

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.3046

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.2438

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.1839

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 16.1239

Monitoring signature responses:
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 16.0642

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 16.0050

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.9465

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.8876

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 600.374 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.145    0.145  600.374  600.374 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  131.560    0.658  337.107    1.686 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  259.674    1.298 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  259.673    1.298 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  259.666    1.298 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  259.664    1.298  259.664    1.298 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  123.721    0.619  126.724    0.634 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    5.942    0.027   26.603    0.121 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.171    0.035   21.171    0.035 {built-in method torch.log}
      220    0.002    0.000   14.338    0.065 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_30000_40000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_30000_40000.pt
Cleaning up memory...
✓ Batch 4/40 complete!

================================================================================
BATCH 5/40: Processing samples 40000 to 50000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5865

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.5832

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9949

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.7742

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.5832

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 50
Loss: 18.0339

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 60
Loss: 16.9028

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 70
Loss: 16.4183

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2590

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1970

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.1236

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0545

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9953

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.9339

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 140
Loss: 15.8735

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.8133

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7533

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6939

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.6353

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5764

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 595.589 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.154    0.154  595.589  595.589 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  128.850    0.644  335.994    1.680 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  255.928    1.280 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  255.927    1.280 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  255.920    1.280 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  255.918    1.280  255.918    1.280 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.732    0.624  127.756    0.639 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    5.947    0.027   26.904    0.122 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.308    0.036   21.308    0.036 {built-in method torch.log}
      220    0.002    0.000   14.651    0.067 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_40000_50000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_40000_50000.pt
Cleaning up memory...
✓ Batch 5/40 complete!

================================================================================
BATCH 6/40: Processing samples 50000 to 60000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4570

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4511

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.8663

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6476

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.4557

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9064

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7761

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.2922

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1335

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.0722

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.9994

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.9312

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.8729

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8124

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7533

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.6940

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6353

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5773

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5199

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4625

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 588.741 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.148    0.148  588.741  588.741 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  126.720    0.634  333.106    1.666 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  252.042    1.260 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  252.041    1.260 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  252.034    1.260 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  252.032    1.260  252.032    1.260 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.246    0.621  127.280    0.636 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    5.933    0.027   26.695    0.121 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.786    0.036   21.786    0.036 {built-in method torch.log}
      220    0.002    0.000   14.561    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_50000_60000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_50000_60000.pt
Cleaning up memory...
✓ Batch 6/40 complete!

================================================================================
BATCH 7/40: Processing samples 60000 to 70000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5024

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.4843

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.9060

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6939

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5001

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9492

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8180

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3334

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1739

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1117

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0382

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.9690

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8483

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7881

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7278

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6680

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6089

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5508

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4925

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 592.380 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.141    0.141  592.380  592.380 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  125.949    0.630  333.888    1.669 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  254.882    1.274 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  254.881    1.274 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  254.874    1.274 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  254.873    1.274  254.873    1.274 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.819    0.624  127.863    0.639 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.163    0.028   26.922    0.122 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.788    0.036   21.788    0.036 {built-in method torch.log}
      220    0.002    0.000   14.495    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_60000_70000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_60000_70000.pt
Cleaning up memory...
✓ Batch 7/40 complete!

================================================================================
BATCH 8/40: Processing samples 70000 to 80000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5304

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.4990

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9420

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.7269

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5318

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9822

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8522

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3688

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2105

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1496

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0773

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0093

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9512

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8907

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8313

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7718

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7127

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6541

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5961

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5381

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 600.906 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.131    0.131  600.906  600.906 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  128.948    0.645  336.786    1.684 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  260.538    1.303 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  260.537    1.303 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  260.530    1.303 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  260.529    1.303  260.529    1.303 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.546    0.623  127.588    0.638 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.019    0.027   26.770    0.122 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.830    0.036   21.830    0.036 {built-in method torch.log}
      220    0.002    0.000   14.281    0.065 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_70000_80000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_70000_80000.pt
Cleaning up memory...
✓ Batch 8/40 complete!

================================================================================
BATCH 9/40: Processing samples 80000 to 90000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5519

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.5462

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.9581

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.7448

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5521

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.0022

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8715

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3875

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2287

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1673

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.0257

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.9668

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.9055

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8453

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7851

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6659

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.6074

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.5486

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.001

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 606.381 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.134    0.134  606.381  606.381 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  130.033    0.650  338.016    1.690 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  264.642    1.323 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  264.641    1.323 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  264.634    1.323 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  264.632    1.323  264.632    1.323 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  123.572    0.618  126.620    0.633 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.479    0.029   27.831    0.127 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.802    0.036   21.802    0.036 {built-in method torch.log}
      220    0.002    0.000   14.545    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_80000_90000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_80000_90000.pt
Cleaning up memory...
✓ Batch 9/40 complete!

================================================================================
BATCH 10/40: Processing samples 90000 to 100000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7008

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.6942

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.1082

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.8904

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.6970

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1475

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0168

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5324

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3733

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3116

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2384

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1698

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.1110

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0500

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9903

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9305

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8713

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8126

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7547

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.6964

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.001

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 604.586 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.135    0.135  604.586  604.586 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  129.893    0.649  337.455    1.687 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  263.458    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  263.456    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  263.450    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  263.448    1.317  263.448    1.317 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  123.365    0.617  126.387    0.632 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.336    0.029   27.546    0.125 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.859    0.036   21.859    0.036 {built-in method torch.log}
      220    0.002    0.000   14.471    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_90000_100000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_90000_100000.pt
Cleaning up memory...
✓ Batch 10/40 complete!

================================================================================
BATCH 11/40: Processing samples 100000 to 110000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4814

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4783

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.8924

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6722

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.4782

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9282

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7969

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3120

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1523

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.0900

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0161

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.9467

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.8871

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7646

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7039

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6437

Monitoring signature responses:
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5840

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4662

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 607.713 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.142    0.142  607.713  607.713 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  129.826    0.649  339.562    1.698 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  264.485    1.322 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  264.483    1.322 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  264.476    1.322 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  264.475    1.322  264.475    1.322 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  125.267    0.626  128.347    0.642 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.233    0.028   27.356    0.124 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.057    0.037   22.057    0.037 {built-in method torch.log}
      220    0.002    0.000   14.359    0.065 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_100000_110000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_100000_110000.pt
Cleaning up memory...
✓ Batch 11/40 complete!

================================================================================
BATCH 12/40: Processing samples 110000 to 120000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5306

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.5305

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9387

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.7210

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5298

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9810

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8507

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3669

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2084

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1471

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0743

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0059

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9472

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8860

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8258

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7655

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7053

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6457

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5865

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5273

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 605.748 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.135    0.135  605.748  605.748 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  129.897    0.649  338.675    1.693 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  263.447    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  263.446    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  263.439    1.317 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  263.437    1.317  263.437    1.317 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  125.227    0.626  128.283    0.641 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.065    0.028   26.890    0.122 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.824    0.036   21.824    0.036 {built-in method torch.log}
      220    0.002    0.000   14.287    0.065 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_110000_120000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_110000_120000.pt
Cleaning up memory...
✓ Batch 12/40 complete!

================================================================================
BATCH 13/40: Processing samples 120000 to 130000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2996

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.3150

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.7089

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.4879

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.2973

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7486

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6181

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1340

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.9751

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8405

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.7717

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7127

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6515

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.5914

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5311

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.4713

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4121

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.3536

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.2951

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.025
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 607.038 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.138    0.138  607.038  607.038 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  129.921    0.650  338.276    1.691 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  265.106    1.326 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  265.105    1.326 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  265.098    1.325 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  265.096    1.325  265.096    1.325 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.803    0.624  127.867    0.639 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.114    0.028   26.990    0.123 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.714    0.036   21.714    0.036 {built-in method torch.log}
      220    0.002    0.000   14.429    0.066 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_120000_130000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_120000_130000.pt
Cleaning up memory...
✓ Batch 13/40 complete!

================================================================================
BATCH 14/40: Processing samples 130000 to 140000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6695

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.6546

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.0740

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.8601

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.6665

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1169

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.9856

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5009

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3413

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.2788

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2049

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1353

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.0754

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0133

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9522

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.8912

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8302

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.7699

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7101

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.014
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.6504

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.016
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 626.172 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.156    0.156  626.172  626.172 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  134.785    0.674  348.302    1.742 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  273.902    1.370 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  273.901    1.370 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  273.894    1.369 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  273.892    1.369  273.892    1.369 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  127.052    0.635  130.261    0.651 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.365    0.029   28.483    0.129 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.518    0.038   22.518    0.038 {built-in method torch.log}
      220    0.003    0.000   15.439    0.070 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_130000_140000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_130000_140000.pt
Cleaning up memory...
✓ Batch 14/40 complete!

================================================================================
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
BATCH 15/40: Processing samples 140000 to 150000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5780

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.5648

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9849

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.7679

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.5753

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.0259

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8950

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.4105

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2514

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1895

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.1163

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0475

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9885

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.9273

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8673

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.8074

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7476

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6888

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.6304

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5721

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 627.590 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.155    0.155  627.590  627.590 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  137.413    0.687  352.251    1.761 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  271.367    1.357 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  271.365    1.357 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  271.358    1.357 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  271.356    1.357  271.356    1.357 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  128.263    0.641 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
 131.468    0.657 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.259    0.028   28.515    0.130 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.918    0.038   22.918    0.038 {built-in method torch.log}
      220    0.003    0.000   15.513    0.071 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_140000_150000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_140000_150000.pt
Cleaning up memory...
✓ Batch 15/40 complete!

================================================================================
BATCH 16/40: Processing samples 150000 to 160000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2602

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.2740

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.6709

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.4501

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.2611

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7138

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.5840

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1008

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.9429

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.8824

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8104

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.7426

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.6846

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6243

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.5651

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5058

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.4468

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.3886

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.3310

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.2734

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 670.990 seconds

/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.166    0.166  670.990  670.990 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  147.113    0.736  374.235    1.871 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  292.601    1.463 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  292.600    1.463 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  292.592    1.463 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  292.591    1.463  292.591    1.463 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.425    0.672  137.851    0.689 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.892    0.031   30.687    0.139 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   24.915    0.042   24.915    0.042 {built-in method torch.log}
      220    0.003    0.000   16.253    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_150000_160000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_150000_160000.pt
Cleaning up memory...
✓ Batch 16/40 complete!

================================================================================
BATCH 17/40: Processing samples 160000 to 170000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7013

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.6875

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.1027

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.8908

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.6971

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1459

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0137

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5281

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3677

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3046

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2302

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1602

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.1001

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0379

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9769

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9159

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8553

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.7957

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7364

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.6775

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 681.124 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.153    0.153  681.124  681.124 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  151.923    0.760  381.614    1.908 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  295.268    1.476 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  295.266    1.476 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  295.258    1.476 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  295.256    1.476  295.256    1.476 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.164    0.671  137.666    0.688 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.013    0.032   31.688    0.144 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.792    0.043   25.792    0.043 {built-in method torch.log}
      220    0.003    0.000   16.769    0.076 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_160000_170000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_160000_170000.pt
Cleaning up memory...
✓ Batch 17/40 complete!

================================================================================
BATCH 18/40: Processing samples 170000 to 180000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4819

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4631

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.8827

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6737

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.4809

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9309

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7999

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3155

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1563

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 90
Loss: 16.0945

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 100
Loss: 16.0212

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.9523

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.8934

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8322

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7724

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7124

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6531

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5942

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5363

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.4784

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.030 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 610.913 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.132    0.132  610.913  610.913 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  131.332    0.657  343.485    1.717 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  263.724    1.319 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  263.723    1.319 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  263.716    1.319 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  263.714    1.319  263.714    1.319 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  126.384    0.632  129.547    0.648 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    5.978    0.027   27.452    0.125 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.467    0.037   22.467    0.037 {built-in method torch.log}
      220    0.002    0.000   14.978    0.068 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_170000_180000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_170000_180000.pt
Cleaning up memory...
✓ Batch 18/40 complete!

================================================================================
BATCH 19/40: Processing samples 180000 to 190000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7673

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.7519

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.1759

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.9557

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.7608

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.2101

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0778

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5923

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.4319

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3688

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.2243

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.1642

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 16.1018

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.0407

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9797

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.9190

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8590

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7999

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.7407

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 616.340 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.136    0.136  616.340  616.340 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  132.029    0.660  343.748    1.719 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  268.815    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  268.814    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  268.807    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  268.805    1.344  268.805    1.344 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  125.929    0.630  129.039    0.645 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.302    0.029   28.003    0.127 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.203    0.037   22.203    0.037 {built-in method torch.log}
      220    0.002    0.000   15.052    0.068 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_180000_190000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_180000_190000.pt
Cleaning up memory...
✓ Batch 19/40 complete!

================================================================================
BATCH 20/40: Processing samples 190000 to 200000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7084

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.6960

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.1085

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.9000

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.7059

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1552

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0239

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5393

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3798

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3176

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2440

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1749

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.1155

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0541

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9937

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9334

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8733

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8141

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7555

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.6969

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 617.923 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.145    0.145  617.923  617.923 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  131.717    0.659  344.782    1.724 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  269.237    1.346 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  269.236    1.346 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  269.229    1.346 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  269.227    1.346  269.227    1.346 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  127.449    0.637  130.664    0.653 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.120    0.028   27.807    0.126 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.102    0.037   22.102    0.037 {built-in method torch.log}
      220    0.003    0.000   15.266    0.069 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_190000_200000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_190000_200000.pt
Cleaning up memory...
✓ Batch 20/40 complete!

================================================================================
BATCH 21/40: Processing samples 200000 to 210000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4257

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4266

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.8350

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6196

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.4255

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.8756

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7450

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.2612

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1025

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.0412

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.9684

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.8999

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.8412

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.7803

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7205

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.6606

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6010

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5421

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4840

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4257

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 620.781 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.133    0.133  620.781  620.781 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  132.380    0.662  346.012    1.730 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  270.953    1.355 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  270.952    1.355 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  270.945    1.355 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  270.943    1.355  270.943    1.355 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  126.940    0.635  130.099    0.650 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.656    0.030   28.713    0.131 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.293    0.037   22.293    0.037 {built-in method torch.log}
      220    0.003    0.000   15.160    0.069 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_200000_210000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_200000_210000.pt
Cleaning up memory...
✓ Batch 21/40 complete!

================================================================================
BATCH 22/40: Processing samples 210000 to 220000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6866

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.6546

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.0890

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.8776

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.6826

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1322

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0009

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5162

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3566

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.2944

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2209

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1518

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.0927

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 16.0315

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9717

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9118

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8524

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.7938

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7359

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.6779

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 627.130 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.142    0.142  627.130  627.130 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  135.884    0.679  350.896    1.754 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  272.373    1.362 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  272.372    1.362 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  272.365    1.362 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  272.363    1.362  272.363    1.362 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  127.982    0.640  131.202    0.656 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.616    0.030   28.932    0.132 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.698    0.038   22.698    0.038 {built-in method torch.log}
      220    0.003    0.000   15.430    0.070 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_210000_220000.pt
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_210000_220000.pt
Cleaning up memory...
✓ Batch 22/40 complete!

================================================================================
BATCH 23/40: Processing samples 220000 to 230000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2079

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.2059

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.6109

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.3996

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.2084

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 50
Loss: 17.6596

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 60
Loss: 16.5296

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 70
Loss: 16.0463

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 80
Loss: 15.8882

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 90
Loss: 15.8276

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 100
Loss: 15.7556

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.6879

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.6302

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.5703

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 140
Loss: 15.5115

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 150
Loss: 15.4527

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 160
Loss: 15.3943

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.3366

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.2796

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.2225

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 624.747 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.139    0.139  624.747  624.747 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  135.115    0.676  348.395    1.742 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  272.550    1.363 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  272.549    1.363 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
      200    0.001    0.000  272.542    1.363 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  272.540    1.363  272.540    1.363 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  126.662    0.633  129.826    0.649 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.693    0.030   28.747    0.131 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.356    0.037   22.356    0.037 {built-in method torch.log}
      220    0.002    0.000   15.088    0.069 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_220000_230000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_220000_230000.pt
Cleaning up memory...
✓ Batch 23/40 complete!

================================================================================
BATCH 24/40: Processing samples 230000 to 240000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2433

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.2433

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.6517

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.4370

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.2445

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.6946

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.5643

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.0806

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.9221

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.8611

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.7886

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.7206

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.6624

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6022

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.5430

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.4838

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.4251

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.3671

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.3096

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.2522

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.002

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 616.710 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.139    0.139  616.710  616.710 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  132.779    0.664  343.608    1.718 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  269.308    1.347 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  269.307    1.347 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  269.300    1.346 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  269.298    1.346  269.298    1.346 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  125.814    0.629  128.901    0.645 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.697    0.030   28.349    0.129 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.815    0.036   21.815    0.036 {built-in method torch.log}
      220    0.002    0.000   14.694    0.067 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_230000_240000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_230000_240000.pt
Cleaning up memory...
✓ Batch 24/40 complete!

================================================================================
BATCH 25/40: Processing samples 240000 to 250000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7375

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.7328

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.1450

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.9279

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.7326

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1832

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0521

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5672

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.4073

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3448

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2708

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.2011

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.1412

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0790

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.0181

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9571

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8965

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8365

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7773

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002

Epoch 190
Loss: 15.7181

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 614.088 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.141    0.141  614.088  614.088 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  132.596    0.663  341.461    1.707 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  268.734    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.001    0.000  268.732    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  268.726    1.344 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  268.724    1.344  268.724    1.344 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.722    0.624  127.782    0.639 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.594    0.030   28.279    0.129 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.413    0.036   21.413    0.036 {built-in method torch.log}
      220    0.002    0.000   14.726    0.067 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_240000_250000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_240000_250000.pt
Cleaning up memory...
✓ Batch 25/40 complete!

================================================================================
BATCH 26/40: Processing samples 250000 to 260000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.6248

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.6228

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.0295

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.8153

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.6204

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.0697

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.9381

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.4528

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2924

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.2294

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.1548

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0846

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.0243

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.9616

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.9003

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.8389

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7780

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.7178

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.6585

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5991

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 615.332 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.139    0.139  615.332  615.332 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  132.648    0.663  341.788    1.709 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  269.763    1.349 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  269.761    1.349 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  269.755    1.349 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  269.753    1.349  269.753    1.349 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  124.973    0.625  128.027    0.640 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.339    0.029   28.092    0.128 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   21.432    0.036   21.432    0.036 {built-in method torch.log}
      220    0.002    0.000   14.864    0.068 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_250000_260000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_250000_260000.pt
Cleaning up memory...
✓ Batch 26/40 complete!

================================================================================
BATCH 27/40: Processing samples 260000 to 270000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.4671

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.4806

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.8774

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6600

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.4670

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9166

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.7857

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3014

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1422

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.0804

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0071

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.9381

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.8788

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8172

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7565

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.6958

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6354

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.5756

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5164

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4570

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 640.227 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.150    0.150  640.227  640.227 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  139.318    0.697  357.520    1.788 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  278.799    1.394 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  278.798    1.394 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  278.790    1.394 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  278.789    1.394  278.789    1.394 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  129.749    0.649  132.997    0.665 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.455    0.029   29.046    0.132 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   22.569    0.038   22.569    0.038 {built-in method torch.log}
      220    0.003    0.000   15.605    0.071 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_260000_270000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_260000_270000.pt
Cleaning up memory...
✓ Batch 27/40 complete!

================================================================================
BATCH 28/40: Processing samples 270000 to 280000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5073

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.5031

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9114

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.6982

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5048

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9559

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3407

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.1815

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1195

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0460

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.9768

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9174

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.8557

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.7952

Monitoring signature responses:
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7345

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6743

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6149

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5558

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.4970

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.020
  Theta for others: 0.030
  Proportion difference: 0.003

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 651.054 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.154    0.154  651.054  651.054 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  141.837    0.709  366.180    1.831 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  280.882    1.404 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  280.880    1.404 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  280.873    1.404 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  280.871    1.404  280.871    1.404 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  132.427    0.662  135.780    0.679 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.438    0.029   29.703    0.135 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   23.806    0.040   23.806    0.040 {built-in method torch.log}
      220    0.003    0.000   16.354    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_270000_280000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_270000_280000.pt
Cleaning up memory...
✓ Batch 28/40 complete!

================================================================================
BATCH 29/40: Processing samples 280000 to 290000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3393

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.3521

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.7475

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.5282

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.3390

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7904

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6602

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1766

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.0183

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9574

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8851

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.8171

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7589

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6984

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.6391

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5795

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5201

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4616

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4036

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.3454

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 658.036 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.154    0.154  658.036  658.036 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  144.090    0.720  371.750    1.859 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  282.266    1.411 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  282.265    1.411 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  282.257    1.411 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  282.255    1.411  282.255    1.411 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.843    0.674  138.277    0.691 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.376    0.029   29.709    0.135 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   24.100    0.040   24.100    0.040 {built-in method torch.log}
      220    0.003    0.000   16.398    0.075 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_280000_290000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_280000_290000.pt
Cleaning up memory...
✓ Batch 29/40 complete!

================================================================================
BATCH 30/40: Processing samples 290000 to 300000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5901

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.5782

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.9988

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.7806

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.5870

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.0369

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.9058

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.4212

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2618

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1997

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.1262

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.0572

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.9980

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.9367

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 140
Loss: 15.8766

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.8165

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.7567

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6977

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.6393

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5810

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.006
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 671.765 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.161    0.161  671.765  671.765 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  147.653    0.738  379.193    1.896 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  288.460    1.442 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  288.459    1.442 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  288.451    1.442 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  288.449    1.442  288.449    1.442 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  136.410    0.682  140.016    0.700 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.791    0.031   30.796    0.140 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   24.740    0.041   24.740    0.041 {built-in method torch.log}
      220    0.003    0.000   16.647    0.076 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_290000_300000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_290000_300000.pt
Cleaning up memory...
✓ Batch 30/40 complete!

================================================================================
BATCH 31/40: Processing samples 300000 to 310000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2844

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.2953

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.6996

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.4760

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.2859

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7390

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6099

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1275

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.9703

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9104

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8390

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 15.7719

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7147

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6551

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.5967

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5380

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.4795

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4217

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.3644

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.3066

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 698.764 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.157    0.157  698.764  698.764 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  154.550    0.773  393.672    1.968 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  300.748    1.504 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  300.746    1.504 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  300.738    1.504 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  300.736    1.504  300.736    1.504 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  139.793    0.699  143.544    0.718 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.235    0.033   32.544    0.148 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   26.091    0.043   26.091    0.043 {built-in method torch.log}
      220    0.003    0.000   17.305    0.079 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_300000_310000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_300000_310000.pt
Cleaning up memory...
✓ Batch 31/40 complete!

================================================================================
BATCH 32/40: Processing samples 310000 to 320000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.2528

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.2471

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.6603

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.4458

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.2544

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7048

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.5748

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.0914

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.9333

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.8725

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8002

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.7322

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.6741

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6136

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.5542

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.4946

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.4355

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.3770

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.3191

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.2612

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 707.574 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.153    0.153  707.574  707.574 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  156.864    0.784  397.129    1.986 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  306.094    1.530 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  306.093    1.530 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  306.085    1.530 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  306.083    1.530  306.083    1.530 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  140.209    0.701  143.923    0.720 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.495    0.034   32.672    0.149 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.983    0.043   25.983    0.043 {built-in method torch.log}
      220    0.003    0.000   17.025    0.077 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_310000_320000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_310000_320000.pt
Cleaning up memory...
✓ Batch 32/40 complete!

================================================================================
BATCH 33/40: Processing samples 320000 to 330000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7823

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.7607

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 50.1838

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.9707

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.7777

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.2271

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0952

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.6098

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.4496

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3866

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.3123

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 110
Loss: 16.2424

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 16.1823

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.1200

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.0589

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9978

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.9370

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8771

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)

Epoch 180
Loss: 15.8177

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.7583

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.033 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 712.253 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.158    0.158  712.253  712.253 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  156.652    0.783  398.003    1.990 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  309.783    1.549 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  309.782    1.549 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  309.774    1.549 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  309.772    1.549  309.772    1.549 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  140.416    0.702  144.108    0.721 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.740    0.035   33.486    0.152 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.892    0.043   25.892    0.043 {built-in method torch.log}
      220    0.003    0.000   17.433    0.079 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_320000_330000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_320000_330000.pt
Cleaning up memory...
✓ Batch 33/40 complete!

================================================================================
BATCH 34/40: Processing samples 330000 to 340000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3346

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.3655

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.7418

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.5228

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.3358

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7873

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6570

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1735

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.0154

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9547

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8824

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.8146

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.7565

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.6962

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.6370

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5778

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5190

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4608

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4034

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.3458

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.024
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 729.861 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.161    0.161  729.861  729.861 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  161.189    0.806  408.438    2.042 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  316.900    1.585 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  316.899    1.584 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  316.891    1.584 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  316.889    1.584  316.889    1.584 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  142.767    0.714  146.632    0.733 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.923    0.036   34.441    0.157 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   27.253    0.045   27.253    0.045 {built-in method torch.log}
      220    0.003    0.000   17.906    0.081 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_330000_340000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_330000_340000.pt
Cleaning up memory...
✓ Batch 34/40 complete!

================================================================================
BATCH 35/40: Processing samples 340000 to 350000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7254

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.7094

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.1270

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: -0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.9169

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.7211

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.1694

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.0375

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.5520

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.3917

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3286

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.2541

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.1841

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.1238

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 16.0615

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.0002

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.9390

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.8782

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.8180

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.7586

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.6992

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 748.793 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.165    0.165  748.793  748.793 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  165.617    0.828  418.979    2.095 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  325.235    1.626 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  325.233    1.626 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  325.225    1.626 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  325.223    1.626  325.223    1.626 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  146.376    0.732  150.303    0.752 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.981    0.036   35.191    0.160 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   27.625    0.046   27.625    0.046 {built-in method torch.log}
      220    0.003    0.000   18.472    0.084 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_340000_350000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_340000_350000.pt
Cleaning up memory...
✓ Batch 35/40 complete!

================================================================================
BATCH 36/40: Processing samples 350000 to 360000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.7827

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.7826

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 50.1936

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.9714

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.7802

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 18.2316

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 17.1011

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.6171

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.4584

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.3972

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.3245

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 16.2564

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 16.1982

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 16.1378

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 16.0786

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 16.0193

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.9603

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.9020

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.8443

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.7866

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 751.288 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.174    0.174  751.288  751.288 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  167.235    0.836  420.178    2.101 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  326.239    1.631 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  326.237    1.631 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  326.229    1.631 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  326.227    1.631  326.227    1.631 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  146.233    0.731  150.257    0.751 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.841    0.036   35.223    0.160 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   28.177    0.047   28.177    0.047 {built-in method torch.log}
      220    0.003    0.000   18.797    0.085 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_350000_360000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_350000_360000.pt
Cleaning up memory...
✓ Batch 36/40 complete!

================================================================================
BATCH 37/40: Processing samples 360000 to 370000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3455

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.3438

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 20
Loss: 49.7565

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 30
Loss: 19.5331

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 40
Loss: 19.3442

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7964

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6666

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1833

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.0252

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9645

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8924

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.8247

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.7669

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.7068

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 140
Loss: 15.6479

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5890

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5305

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4727

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4155

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.3585

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 724.787 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.168    0.168  724.787  724.787 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  161.555    0.808  406.276    2.031 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.002    0.000  313.936    1.570 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  313.935    1.570 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  313.927    1.570 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  313.925    1.570  313.925    1.570 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  141.705    0.709  145.510    0.728 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    7.469    0.034   34.096    0.155 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   27.162    0.045   27.162    0.045 {built-in method torch.log}
      220    0.003    0.000   18.201    0.083 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_360000_370000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_360000_370000.pt
Cleaning up memory...
✓ Batch 37/40 complete!

================================================================================
BATCH 38/40: Processing samples 370000 to 380000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.5291

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.5440

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.9417

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.7167

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.5249

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.9760

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.8447

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.3600

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.2006

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 16.1386

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 16.0652

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.9963

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.9374

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.8763

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.8165

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.7569

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.6978

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.6394

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.015
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.5820

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.017
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.5244

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.019
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 667.739 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.164    0.164  667.739  667.739 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  149.512    0.748  379.355    1.897 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  284.291    1.421 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  284.289    1.421 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  284.282    1.421 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  284.280    1.421  284.280    1.421 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.584    0.673  138.014    0.690 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.859    0.031   30.440    0.138 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.577    0.043   25.577    0.043 {built-in method torch.log}
      220    0.003    0.000   16.350    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_370000_380000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_370000_380000.pt
Cleaning up memory...
✓ Batch 38/40 complete!

================================================================================
BATCH 39/40: Processing samples 380000 to 390000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.3291

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 10
Loss: 174.3493

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: -0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.7375

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.5182

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.3298

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.7812

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.6513

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 16.1681

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 16.0102

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.9498

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.8780

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.8107

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 120
Loss: 15.7532

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 130
Loss: 15.6934

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.6348

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.5761

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.5177

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.4598

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.4026

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.3450

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.025 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.012
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001
         118974 function calls (116974 primitive calls) in 671.106 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.160    0.160  671.106  671.106 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:55: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.prevalence_t = torch.tensor(prevalence_t, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:99: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.signature_refs = torch.tensor(signature_references, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:129: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.Y = torch.tensor(Y, dtype=torch.float32)
/Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  150.567    0.753  380.422    1.902 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  286.639    1.433 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  286.637    1.433 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.002    0.000  286.630    1.433 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  286.628    1.433  286.628    1.433 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  135.167    0.676  138.618    0.693 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.848    0.031   30.194    0.137 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.608    0.043   25.608    0.043 {built-in method torch.log}
      220    0.002    0.000   16.269    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_380000_390000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_380000_390000.pt
Cleaning up memory...
✓ Batch 39/40 complete!

================================================================================
BATCH 40/40: Processing samples 390000 to 400000
================================================================================
Subsetting data...
Data shapes: Y=torch.Size([10000, 348, 52]), E=torch.Size([10000, 348]), G=(10000, 47)
Initializing model with fixed phi/psi/gamma/kappa...
Pre-calculated phi GP loss: 16.2175
Using fixed gamma with shape: torch.Size([47, 21])
Using fixed kappa: 2.932933
Initializing with 20 disease states + 1 healthy state
Initialization complete! (gamma and kappa are fixed)
✓ phi matches phi_total!
✓ psi matches psi_total!
✓ gamma matches gamma_pooled!
✓ kappa matches kappa_pooled! (2.932933)
Training model (estimating lambda only, gamma and kappa are fixed)...

Epoch 0
Loss: 16.1031

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: -0.000

Epoch 10
Loss: 174.1374

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 20
Loss: 49.5167

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 30
Loss: 19.2957

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 40
Loss: 19.1078

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 50
Loss: 17.5608

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.030 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 60
Loss: 16.4322

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.004
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 70
Loss: 15.9504

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.023 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 80
Loss: 15.7941

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.006
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 90
Loss: 15.7353

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.023 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.005
  Theta for others: 0.030
  Proportion difference: 0.000

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 100
Loss: 15.6650

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.006
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.000

Epoch 110
Loss: 15.5991

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.007
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 120
Loss: 15.5431

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.000

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.008
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 130
Loss: 15.4849

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.004
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.007
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.009
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.028 ± 0.020
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 140
Loss: 15.4278

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.010
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 150
Loss: 15.3704

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.008
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.031 ± 0.011
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 160
Loss: 15.3134

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.009
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.013
  Theta for others: 0.030
  Proportion difference: 0.001

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.021
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 170
Loss: 15.2571

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.010
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.014
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 180
Loss: 15.2013

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.011
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.016
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.022
  Theta for others: 0.028
  Proportion difference: 0.001

Epoch 190
Loss: 15.1452

Monitoring signature responses:

Disease 47 (signature 15, LR=87.86):
  Theta for diagnosed: 0.014 ± 0.005
  Theta for others: 0.014
  Proportion difference: 0.000

Disease 249 (signature 13, LR=73.06):
  Theta for diagnosed: 0.024 ± 0.013
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 21 (signature 13, LR=69.95):
  Theta for diagnosed: 0.024 ± 0.012
  Theta for others: 0.023
  Proportion difference: 0.001

Disease 336 (signature 9, LR=68.09):
  Theta for diagnosed: 0.032 ± 0.018
  Theta for others: 0.030
  Proportion difference: 0.002

Disease 127 (signature 0, LR=64.18):
  Theta for diagnosed: 0.029 ± 0.023
  Theta for others: 0.028
  Proportion difference: 0.002
         118974 function calls (116974 primitive calls) in 665.387 seconds

   Ordered by: cumulative time
   List reduced from 140 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.149    0.149  665.387  665.387 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:313(fit)
      200  147.795    0.739  375.985    1.880 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:187(compute_loss)
      200    0.001    0.000  285.369    1.427 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/_tensor.py:525(backward)
      200    0.002    0.000  285.367    1.427 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/__init__.py:242(backward)
      200    0.001    0.000  285.360    1.427 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/autograd/graph.py:816(_engine_run_backward)
      200  285.358    1.427  285.358    1.427 {method 'run_backward' of 'torch._C._EngineBase' objects}
      200  134.145    0.671  137.550    0.688 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:278(compute_gp_prior_loss)
      220    6.920    0.031   30.466    0.138 /Users/sarahurbut/aladynoulli2/claudefile/aws_offsetmaster/clust_huge_amp_fixedPhi_vectorized_fixed_gamma_fixed_kappa.py:178(forward)
      600   25.033    0.042   25.033    0.042 {built-in method torch.log}
      220    0.002    0.000   16.340    0.074 /opt/miniconda3/envs/new_env_pyro2/lib/python3.9/site-packages/torch/functional.py:210(einsum)


Generating predictions...
✓ Saved predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_390000_400000.pt
✓ Saved model to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/model_enroll_fixedphi_sex_390000_400000.pt
Cleaning up memory...
✓ Batch 40/40 complete!

================================================================================
ALL BATCHES COMPLETE!
================================================================================

Concatenating all predictions into single file...
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_0_10000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_10000_20000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_20000_30000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_30000_40000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_40000_50000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_50000_60000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_60000_70000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_70000_80000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_80000_90000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_90000_100000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_100000_110000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_110000_120000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_120000_130000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_130000_140000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_140000_150000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_150000_160000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_160000_170000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_170000_180000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_180000_190000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_190000_200000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_200000_210000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_210000_220000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_220000_230000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_230000_240000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_240000_250000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_250000_260000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_260000_270000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_270000_280000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_280000_290000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_290000_300000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_300000_310000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_310000_320000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_320000_330000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_330000_340000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_340000_350000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_350000_360000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_360000_370000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_370000_380000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_380000_390000.pt, shape: torch.Size([10000, 348, 52])
✓ Loaded /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_390000_400000.pt, shape: torch.Size([10000, 348, 52])

Concatenating 40 batches...
Final shape: torch.Size([400000, 348, 52])
✓ Saved combined predictions to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/pi_enroll_fixedphi_sex_FULL.pt
✓ Saved batch info to /Users/sarahurbut/Library/CloudStorage/Dropbox/enrollment_predictions_fixedphi_fixedgk_vectorized/batch_info.pt

================================================================================
DONE! Predictions use fixed gamma and kappa (only lambda was learned).
================================================================================
