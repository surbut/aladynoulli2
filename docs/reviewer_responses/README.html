<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Reviewer Response Analyses</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css" />
</head>
<body>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #24292e;
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      background-color: #ffffff;
    }
    .markdown-body {
      box-sizing: border-box;
      min-width: 200px;
      max-width: 1200px;
      margin: 0 auto;
      padding: 45px;
      background-color: #ffffff;
    }
    .markdown-body table {
      border-spacing: 0;
      border-collapse: collapse;
      width: 100%;
      margin: 20px 0;
    }
    .markdown-body table th,
    .markdown-body table td {
      padding: 12px 15px;
      border: 1px solid #dfe2e5;
      text-align: left;
    }
    .markdown-body table th {
      background-color: #f6f8fa;
      font-weight: 600;
    }
    .markdown-body table tr:nth-child(even) {
      background-color: #f6f8fa;
    }
    .markdown-body h1 {
      border-bottom: 2px solid #eaecef;
      padding-bottom: 0.3em;
      margin-top: 24px;
      margin-bottom: 16px;
    }
    .markdown-body h2 {
      border-bottom: 1px solid #eaecef;
      padding-bottom: 0.3em;
      margin-top: 24px;
      margin-bottom: 16px;
    }
    .markdown-body code {
      background-color: rgba(27, 31, 35, 0.05);
      border-radius: 3px;
      font-size: 85%;
      padding: 0.2em 0.4em;
    }
    .markdown-body pre {
      background-color: #f6f8fa;
      border-radius: 6px;
      padding: 16px;
      overflow: auto;
    }
    .markdown-body a {
      color: #0366d6;
      text-decoration: none;
    }
    .markdown-body a:hover {
      text-decoration: underline;
    }
  </style>
  <article class="markdown-body">
<header id="title-block-header">
<h1 class="title">Reviewer Response Analyses</h1>
</header>
<h1 id="reviewer-response-analyses">Reviewer Response Analyses</h1>
<p>This directory contains all interactive analyses addressing reviewer questions and concerns.</p>
<h2 id="structure">üìÅ Structure</h2>
<pre><code>reviewer_responses/
‚îú‚îÄ‚îÄ README.md                      # This file - navigation hub
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ R1/                        # Referee #1 analyses (12 notebooks)
‚îÇ   ‚îú‚îÄ‚îÄ R2/                        # Referee #2 analyses (3 notebooks)
‚îÇ   ‚îú‚îÄ‚îÄ R3/                        # Referee #3 analyses (5 notebooks)
‚îÇ   ‚îú‚îÄ‚îÄ framework/                 # Framework overview (1 notebook)
‚îÇ   ‚îî‚îÄ‚îÄ results/                   # Reviewer-specific results
‚îú‚îÄ‚îÄ preprocessing/                 # Data preprocessing utilities
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing_utils.py     # Standalone preprocessing functions
‚îÇ   ‚îú‚îÄ‚îÄ create_preprocessing_files.html  # Interactive preprocessing notebook
‚îÇ   ‚îî‚îÄ‚îÄ WORKFLOW.md                # Complete workflow documentation
‚îî‚îÄ‚îÄ SIMPLE_EXAMPLE.py              # Simple example of preprocessing functions</code></pre>
<h2 id="how-to-use">üéØ How to Use</h2>
<ol type="1">
<li>Click on any question below to navigate to its dedicated analysis notebook</li>
<li>Each notebook is self-contained and can be run independently</li>
<li>All notebooks use the same data paths and setup</li>
</ol>
<h2 id="technical-notes">üîß Technical Notes</h2>
<ul>
<li><strong>Results</strong>: Stored in <code>notebooks/results/</code> (within notebooks directory)</li>
<li><strong>Source Code</strong>: Shared code is in <code>pyScripts_forPublish/</code> (not duplicated here)</li>
<li><strong>Paths</strong>: Notebooks use absolute paths for reliability</li>
<li><strong>Data</strong>: All notebooks are self-contained and can be run independently</li>
</ul>
<hr />
<h2 id="referee-1-human-genetics-disease-risk">Referee #1: Human Genetics, Disease Risk</h2>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 35%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr>
<th>Question</th>
<th>Notebook</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Q1</strong>: Selection bias / socioeconomic bias</td>
<td><a href="notebooks/R1/R1_Q1_Selection_Bias.html"><code>notebooks/R1/R1_Q1_Selection_Bias.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q2</strong>: Lifetime risk comparisons</td>
<td><a href="notebooks/R1/R1_Q2_Lifetime_Risk.html"><code>notebooks/R1/R1_Q2_Lifetime_Risk.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q3</strong>: Clinical/biological meaningfulness</td>
<td><a href="notebooks/R1/R1_Q3_Clinical_Meaning.html"><code>notebooks/R1/R1_Q3_Clinical_Meaning.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q3</strong>: ICD vs PheCode aggregation</td>
<td><a href="notebooks/R1/R1_Q3_ICD_vs_PheCode_Comparison.html"><code>notebooks/R1/R1_Q3_ICD_vs_PheCode_Comparison.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q7</strong>: Heritability estimates</td>
<td><a href="notebooks/R1/R1_Q7_Heritability.html"><code>notebooks/R1/R1_Q7_Heritability.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q9</strong>: AUC vs clinical risk scores</td>
<td><a href="notebooks/R1/R1_Q9_AUC_Comparisons.html"><code>notebooks/R1/R1_Q9_AUC_Comparisons.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q10</strong>: Age-specific discrimination</td>
<td><a href="notebooks/R1/R1_Q10_Age_Specific.html"><code>notebooks/R1/R1_Q10_Age_Specific.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Biological plausibility (CHIP)</td>
<td><a href="notebooks/R1/R1_Biological_Plausibility_CHIP.html"><code>notebooks/R1/R1_Biological_Plausibility_CHIP.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Clinical utility (dynamic risk)</td>
<td><a href="notebooks/R1/R1_Clinical_Utility_Dynamic_Risk_Updating.html"><code>notebooks/R1/R1_Clinical_Utility_Dynamic_Risk_Updating.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Genetic validation (GWAS)</td>
<td><a href="notebooks/R1/R1_Genetic_Validation_GWAS.html"><code>notebooks/R1/R1_Genetic_Validation_GWAS.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Multi-disease patterns</td>
<td><a href="notebooks/R1/R1_Multi_Disease_Patterns_Competing_Risks.html"><code>notebooks/R1/R1_Multi_Disease_Patterns_Competing_Risks.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Robustness (LOO validation)</td>
<td><a href="notebooks/R1/R1_Robustness_LOO_Validation.html"><code>notebooks/R1/R1_Robustness_LOO_Validation.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
</tbody>
</table>
<h2 id="referee-2-ehrs">Referee #2: EHRs</h2>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 37%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr>
<th>Concern</th>
<th>Notebook</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Temporal accuracy / leakage</td>
<td><a href="notebooks/R2/R2_Temporal_Leakage.html"><code>notebooks/R2/R2_Temporal_Leakage.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td>Model validity / learning</td>
<td><a href="notebooks/R2/R2_R3_Model_Validity_Learning.html"><code>notebooks/R2/R2_R3_Model_Validity_Learning.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td>Washout analysis (continued)</td>
<td><a href="notebooks/R2/R2_Washout_Continued.html"><code>notebooks/R2/R2_Washout_Continued.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
</tbody>
</table>
<h2 id="referee-3-statistical-genetics-prs">Referee #3: Statistical Genetics, PRS</h2>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 35%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr>
<th>Question</th>
<th>Notebook</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Q4</strong>: Competing risks</td>
<td><a href="notebooks/R3/R3_Competing_Risks.html"><code>notebooks/R3/R3_Competing_Risks.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Q8</strong>: Heterogeneity definition</td>
<td><a href="notebooks/R3/R3_Q8_Heterogeneity.html"><code>notebooks/R3/R3_Q8_Heterogeneity.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Population Stratification</strong>: Continuous ancestry effects</td>
<td><a href="notebooks/R3/R3_Population_Stratification_Ancestry.html"><code>notebooks/R3/R3_Population_Stratification_Ancestry.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: FullE vs ReducedE comparison</td>
<td><a href="notebooks/R3/R3_FullE_vs_ReducedE_Comparison.html"><code>notebooks/R3/R3_FullE_vs_ReducedE_Comparison.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
<tr>
<td><strong>Additional</strong>: Linear vs Nonlinear mixing</td>
<td><a href="notebooks/R3/R3_Linear_vs_NonLinear_Mixing.html"><code>notebooks/R3/R3_Linear_vs_NonLinear_Mixing.html</code></a></td>
<td>‚úÖ Complete</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="framework-overview">Framework Overview</h2>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr>
<th>Notebook</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="notebooks/framework/Discovery_Prediction_Framework_Overview.html"><code>notebooks/framework/Discovery_Prediction_Framework_Overview.html</code></a></td>
<td>Overview of the discovery and prediction framework</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="preprocessing-workflow">Preprocessing &amp; Workflow</h2>
<p><strong>Addresses reviewer questions about data preprocessing and the complete analysis workflow.</strong></p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr>
<th>Resource</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="preprocessing/WORKFLOW.md"><code>preprocessing/WORKFLOW.md</code></a></td>
<td><strong>Complete end-to-end workflow documentation</strong> - Step-by-step guide from preprocessing ‚Üí batch training ‚Üí master checkpoint ‚Üí prediction</td>
</tr>
<tr>
<td><a href="preprocessing/create_preprocessing_files.html"><code>preprocessing/create_preprocessing_files.html</code></a></td>
<td>Interactive notebook for data preprocessing with visualizations (smoothed prevalence, clustering, signature references)</td>
</tr>
<tr>
<td><a href="preprocessing/preprocessing_utils.py"><code>preprocessing/preprocessing_utils.py</code></a></td>
<td>Standalone preprocessing functions (<code>compute_smoothed_prevalence</code>, <code>create_initial_clusters_and_psi</code>, <code>create_reference_trajectories</code>)</td>
</tr>
<tr>
<td><a href="preprocessing/SIMPLE_EXAMPLE.py"><code>preprocessing/SIMPLE_EXAMPLE.py</code></a></td>
<td>Minimal copy-paste example demonstrating how to use the preprocessing functions</td>
</tr>
</tbody>
</table>
<p><strong>Workflow Overview:</strong> 1. <strong>Preprocessing</strong>: Create smoothed prevalence, initial clusters, and reference trajectories 2. <strong>Batch Training</strong>: Run <code>run_aladyn_batch</code> with FULL E matrix 3. <strong>Master Checkpoint</strong>: Generate master checkpoint (phi and psi) 4. <strong>Prediction</strong>: Run <code>run_aladyn_predict_with_master</code> (automatically loads <code>E_enrollment_full.pt</code>)</p>
<p>See <a href="preprocessing/WORKFLOW.md"><code>preprocessing/WORKFLOW.md</code></a> for detailed instructions.</p>
<hr />
<h2 id="supporting-analyses">Supporting Analyses</h2>
<p>These notebooks provide detailed analyses that support the reviewer responses. They are located in the parent <code>new_notebooks/</code> directory:</p>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 40%" />
<col style="width: 28%" />
</colgroup>
<thead>
<tr>
<th>Notebook</th>
<th>Description</th>
<th>Used By</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../additional_notebooks/performancen_notebook_clean.html"><code>../performancen_notebook_clean.html</code></a></td>
<td>Performance evaluation (AUC, comparisons, washout, age offsets)</td>
<td>R1 Q9, R1 Q2, R1 Q10, R2</td>
</tr>
<tr>
<td><a href="../additional_notebooks/fh_analysis_summary.html"><code>../fh_analysis_summary.html</code></a></td>
<td>Familial Hypercholesterolemia carrier analysis</td>
<td>R1 Q3</td>
</tr>
<tr>
<td><a href="../additional_notebooks/ipw_analysis_summary.html"><code>../ipw_analysis_summary.html</code></a></td>
<td>Inverse Probability Weighting analysis</td>
<td>R1 Q1</td>
</tr>
<tr>
<td><a href="../additional_notebooks/pc_analysis_clean.html"><code>../pc_analysis_clean.html</code></a></td>
<td>Principal component adjustment analysis</td>
<td>R3 Population Stratification</td>
</tr>
<tr>
<td><a href="../additional_notebooks/heritability_analysis_summary.html"><code>../heritability_analysis_summary.html</code></a></td>
<td>LDSC heritability estimates</td>
<td>R1 Q7</td>
</tr>
<tr>
<td><a href="../additional_notebooks/heterogeneity_analysis_summary.html"><code>../heterogeneity_analysis_summary.html</code></a></td>
<td>Disease pathway heterogeneity</td>
<td>R3 Q8</td>
</tr>
<tr>
<td><a href="../additional_notebooks/washout_analysis_summary.html"><code>../washout_analysis_summary.html</code></a></td>
<td>Washout window analysis</td>
<td>R2, R3 Q3</td>
</tr>
<tr>
<td><a href="../additional_notebooks/delphicomp.html"><code>/delphicomp.html</code></a></td>
<td>Delphi comparison analysis</td>
<td>R1 Q9</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="quick-navigation">Quick Navigation</h2>
<h3 id="all-completed-analyses">‚úÖ All Completed Analyses</h3>
<p><strong>Referee #1 (12 notebooks):</strong> - Selection bias (IPW): <a href="notebooks/R1/R1_Q1_Selection_Bias.html"><code>notebooks/R1/R1_Q1_Selection_Bias.html</code></a> - Lifetime risk: <a href="notebooks/R1/R1_Q2_Lifetime_Risk.html"><code>notebooks/R1/R1_Q2_Lifetime_Risk.html</code></a> - Clinical meaning (FH): <a href="notebooks/R1/R1_Q3_Clinical_Meaning.html"><code>notebooks/R1/R1_Q3_Clinical_Meaning.html</code></a> - ICD vs PheCode aggregation: <a href="notebooks/R1/R1_Q3_ICD_vs_PheCode_Comparison.html"><code>notebooks/R1/R1_Q3_ICD_vs_PheCode_Comparison.html</code></a> - Heritability: <a href="notebooks/R1/R1_Q7_Heritability.html"><code>notebooks/R1/R1_Q7_Heritability.html</code></a> - AUC comparisons: <a href="notebooks/R1/R1_Q9_AUC_Comparisons.html"><code>notebooks/R1/R1_Q9_AUC_Comparisons.html</code></a> - Age-specific discrimination: <a href="notebooks/R1/R1_Q10_Age_Specific.html"><code>notebooks/R1/R1_Q10_Age_Specific.html</code></a> - Biological plausibility (CHIP): <a href="notebooks/R1/R1_Biological_Plausibility_CHIP.html"><code>notebooks/R1/R1_Biological_Plausibility_CHIP.html</code></a> - Clinical utility (dynamic risk): <a href="notebooks/R1/R1_Clinical_Utility_Dynamic_Risk_Updating.html"><code>notebooks/R1/R1_Clinical_Utility_Dynamic_Risk_Updating.html</code></a> - Genetic validation (GWAS): <a href="notebooks/R1/R1_Genetic_Validation_GWAS.html"><code>notebooks/R1/R1_Genetic_Validation_GWAS.html</code></a> - Multi-disease patterns: <a href="notebooks/R1/R1_Multi_Disease_Patterns_Competing_Risks.html"><code>notebooks/R1/R1_Multi_Disease_Patterns_Competing_Risks.html</code></a> - Robustness (LOO validation): <a href="notebooks/R1/R1_Robustness_LOO_Validation.html"><code>notebooks/R1/R1_Robustness_LOO_Validation.html</code></a></p>
<p><strong>Referee #2 (3 notebooks):</strong> - Temporal leakage: <a href="notebooks/R2/R2_Temporal_Leakage.html"><code>notebooks/R2/R2_Temporal_Leakage.html</code></a> - Model validity / learning: <a href="notebooks/R2/R2_R3_Model_Validity_Learning.html"><code>notebooks/R2/R2_R3_Model_Validity_Learning.html</code></a> - Washout analysis (continued): <a href="notebooks/R2/R2_Washout_Continued.html"><code>notebooks/R2/R2_Washout_Continued.html</code></a></p>
<p><strong>Referee #3 (5 notebooks):</strong> - Competing risks: <a href="notebooks/R3/R3_Competing_Risks.html"><code>notebooks/R3/R3_Competing_Risks.html</code></a> - Heterogeneity: <a href="notebooks/R3/R3_Q8_Heterogeneity.html"><code>notebooks/R3/R3_Q8_Heterogeneity.html</code></a> - Population stratification: <a href="notebooks/R3/R3_Population_Stratification_Ancestry.html"><code>notebooks/R3/R3_Population_Stratification_Ancestry.html</code></a> - FullE vs ReducedE comparison: <a href="notebooks/R3/R3_FullE_vs_ReducedE_Comparison.html"><code>notebooks/R3/R3_FullE_vs_ReducedE_Comparison.html</code></a> - Linear vs Nonlinear mixing: <a href="notebooks/R3/R3_Linear_vs_NonLinear_Mixing.html"><code>notebooks/R3/R3_Linear_vs_NonLinear_Mixing.html</code></a></p>
<p><strong>Framework (1 notebook):</strong> - Framework overview: <a href="notebooks/framework/Discovery_Prediction_Framework_Overview.html"><code>notebooks/framework/Discovery_Prediction_Framework_Overview.html</code></a></p>
<p><strong>Total: 21 notebooks</strong> ‚úÖ All complete</p>
  </article>
</body>
</html>
