<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aladynoulli Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 3px solid #3498db;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
            font-weight: 300;
        }
        
        .badges {
            margin: 20px 0;
        }
        
        .badges img {
            margin: 0 5px;
            vertical-align: middle;
        }
        
        .header-links {
            margin-top: 20px;
            font-size: 1.1em;
        }
        
        .header-links a {
            color: #3498db;
            text-decoration: none;
            margin: 0 10px;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        
        .header-links a:hover {
            background-color: #ecf0f1;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin: 30px 0;
            border-left: 4px solid #3498db;
        }
        
        .toc h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 8px 0;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .toc a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        h2 {
            color: #2c3e50;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.8em;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        h3 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        h4 {
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 12px;
            font-size: 1.2em;
        }
        
        p {
            margin: 15px 0;
            line-height: 1.8;
        }
        
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        
        li {
            margin: 8px 0;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }
        
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        th {
            background: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        a {
            color: #3498db;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        
        .section-divider {
            height: 2px;
            background: linear-gradient(to right, transparent, #3498db, transparent);
            margin: 40px 0;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .feature-card strong {
            color: #2c3e50;
            display: block;
            margin-bottom: 8px;
        }
        
        .workflow-steps {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px solid #ecf0f1;
            color: #7f8c8d;
            font-size: 0.9em;
        }
        
        .note-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .note-box strong {
            color: #856404;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Aladynoulli Documentation</h1>
            <div class="badges">
                <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT">
                <img src="https://img.shields.io/badge/python-3.8+-blue.svg" alt="Python 3.8+">
                <img src="https://img.shields.io/badge/PyTorch-1.9+-red.svg" alt="PyTorch">
            </div>
            <div class="subtitle">
                <strong>A Bayesian Survival Model for Disease Trajectory Prediction</strong>
            </div>
            <div class="header-links">
                <a href="https://www.medrxiv.org/content/10.1101/2024.09.29.24314557v1">Preprint</a>
                <a href="../">GitHub Repository</a>
                <a href="#quick-start">Quick Start</a>
            </div>
        </div>

        <div class="toc">
            <h2>üìñ Table of Contents</h2>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#quick-start">Quick Start</a></li>
                <li><a href="#model-architecture">Model Architecture</a></li>
                <li><a href="#complete-workflow">Complete Workflow</a></li>
                <li><a href="#reviewer-response-analyses">Reviewer Response Analyses</a></li>
                <li><a href="#documentation">Documentation</a></li>
                <li><a href="#performance-scalability">Performance & Scalability</a></li>
                <li><a href="#citation">Citation</a></li>
            </ul>
        </div>

        <h2 id="overview">üî¨ Overview</h2>
        <p><strong>Aladynoulli</strong> is a comprehensive Bayesian survival model that predicts disease trajectories by integrating genetic and clinical data. The model captures:</p>
        
        <ul>
            <li><strong>Disease Signatures</strong>: Latent disease states that capture shared patterns across diseases</li>
            <li><strong>Genetic Effects</strong>: Individual-specific genetic contributions to disease risk</li>
            <li><strong>Temporal Dynamics</strong>: Time-varying disease probabilities using Gaussian processes</li>
            <li><strong>Censoring</strong>: Proper handling of incomplete follow-up data</li>
        </ul>

        <h3>Key Features</h3>
        <table>
            <thead>
                <tr>
                    <th>Feature</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>‚úÖ <strong>Scalable</strong></td>
                    <td>Handles large-scale genetic and clinical datasets (400K+ individuals)</td>
                </tr>
                <tr>
                    <td>‚úÖ <strong>Flexible</strong></td>
                    <td>Supports both discovery and prediction modes</td>
                </tr>
                <tr>
                    <td>‚úÖ <strong>Robust</strong></td>
                    <td>Proper Bayesian uncertainty quantification</td>
                </tr>
                <tr>
                    <td>‚úÖ <strong>Fast</strong></td>
                    <td>GPU-accelerated training and inference</td>
                </tr>
                <tr>
                    <td>‚úÖ <strong>Reproducible</strong></td>
                    <td>Complete code and data processing pipelines</td>
                </tr>
            </tbody>
        </table>

        <div class="section-divider"></div>

        <h2 id="quick-start">üöÄ Quick Start</h2>
        
        <h3>Installation</h3>
        <pre><code>git clone https://github.com/surbut/aladynoulli2.git
cd aladynoulli2
pip install -r requirements.txt</code></pre>

        <h3>System Requirements</h3>
        <ul>
            <li><strong>Python</strong>: 3.8 or higher</li>
            <li><strong>RAM</strong>: 8GB minimum, 16GB+ recommended</li>
            <li><strong>Storage</strong>: 5GB free space</li>
            <li><strong>GPU</strong>: Optional but recommended (NVIDIA CUDA)</li>
        </ul>

        <p>For detailed installation instructions, see the <a href="../README.md">main README</a> or <a href="../INSTALLATION.md">INSTALLATION.md</a>.</p>

        <div class="section-divider"></div>

        <h2 id="model-architecture">üèóÔ∏è Model Architecture</h2>
        
        <h3>Core Components</h3>
        <ol>
            <li><strong>Signature States (K)</strong>: Latent disease signatures that capture shared patterns</li>
            <li><strong>Genetic Effects (Œ≥)</strong>: Individual-specific genetic contributions</li>
            <li><strong>Temporal Dynamics (Œª)</strong>: Time-varying signature proportions using GPs</li>
            <li><strong>Disease Probabilities (œÜ)</strong>: Signature-specific disease probabilities</li>
            <li><strong>Censoring Matrix (E)</strong>: Event times and censoring information</li>
        </ol>

        <h3>Mathematical Framework</h3>
        <p>The model predicts disease probability at time <code>t</code> as:</p>
        <pre><code>œÄ_i,d,t = Œ∫ √ó Œ£_k Œ∏_i,k,t √ó œÜ_k,d,t</code></pre>
        <p>Where:</p>
        <ul>
            <li><code>Œ∏_i,k,t</code> = softmax(Œª_i,k,t) (signature proportions)</li>
            <li><code>Œª_i,k,t</code> ~ GP(Œº_k + G_i Œ≥_k, K_Œª) (temporal dynamics)</li>
            <li><code>œÜ_k,d,t</code> = sigmoid(œà_k,d + GP(Œº_œÜ, K_œÜ)) (disease probabilities)</li>
        </ul>

        <div class="section-divider"></div>

        <h2 id="complete-workflow">üíª Complete Workflow</h2>
        <p>The Aladynoulli workflow consists of <strong>4 main steps</strong>:</p>
        
        <div class="workflow-steps">
            Preprocessing ‚Üí Batch Training ‚Üí Master Checkpoint ‚Üí Prediction
        </div>

        <h3>Step 1: Preprocessing</h3>
        <p>Create initialization files (prevalence, clusters, psi, reference trajectories):</p>
        
        <p><strong>Option A: Interactive Notebook</strong></p>
        <pre><code>jupyter notebook ../pyScripts/new_oct_revision/new_notebooks/reviewer_responses/preprocessing/create_preprocessing_files.ipynb</code></pre>

        <p><strong>Option B: Standalone Functions</strong></p>
        <pre><code>from pyScripts.new_oct_revision.new_notebooks.reviewer_responses.preprocessing.preprocessing_utils import (
    compute_smoothed_prevalence,
    create_initial_clusters_and_psi,
    create_reference_trajectories
)

# Compute smoothed prevalence
prevalence_t = compute_smoothed_prevalence(Y, window_size=5, smooth_on_logit=True)

# Create initial clusters and psi
clusters, psi = create_initial_clusters_and_psi(Y=Y, K=20, random_state=42)

# Create reference trajectories
signature_refs, healthy_ref = create_reference_trajectories(Y, clusters, K=20)</code></pre>

        <p><strong>Output files:</strong></p>
        <ul>
            <li><code>prevalence_t</code> - Smoothed disease prevalence (D √ó T)</li>
            <li><code>initial_clusters_400k.pt</code> - Disease-to-signature assignments</li>
            <li><code>initial_psi_400k.pt</code> - Initial signature-disease parameters (K √ó D)</li>
            <li><code>reference_trajectories.pt</code> - Signature reference trajectories</li>
        </ul>

        <h3>Step 2: Batch Training</h3>
        <p>Train the model on batches with full enrollment data:</p>
        <pre><code>python ../claudefile/run_aladyn_batch.py \
    --data_dir /path/to/data \
    --output_dir /path/to/batch_output \
    --start_index 0 \
    --end_index 10000 \
    --num_epochs 200</code></pre>

        <p><strong>What it does:</strong></p>
        <ul>
            <li>Trains model on batches using full enrollment E matrix</li>
            <li>Uses <code>clust_huge_amp.py</code> for discovery mode</li>
            <li>Saves checkpoints: <code>enrollment_model_W0.0001_batch_*_*.pt</code></li>
            <li>Each checkpoint contains learned <code>phi</code> parameters (K √ó D √ó T)</li>
        </ul>

        <h3>Step 3: Create Master Checkpoint</h3>
        <p>Pool phi from all batches and create master checkpoint:</p>
        <pre><code>python ../claudefile/create_master_checkpoints.py \
    --data_dir /path/to/data \
    --retrospective_pattern "/path/to/batch_output/enrollment_model_W0.0001_batch_*_*.pt" \
    --enrollment_pattern "/path/to/batch_output/enrollment_model_W0.0001_batch_*_*.pt" \
    --output_dir /path/to/data</code></pre>

        <p><strong>What it does:</strong></p>
        <ul>
            <li>Loads phi from all batch checkpoints</li>
            <li>Pools phi (mean across batches) for stability</li>
            <li>Combines with <code>initial_psi_400k.pt</code></li>
            <li>Creates master checkpoint: <code>master_for_fitting_pooled_all_data.pt</code></li>
        </ul>

        <h3>Step 4: Predict with Master Checkpoint</h3>
        <p>Run predictions using fixed phi from master checkpoint:</p>
        <pre><code>python ../claudefile/version_from_ec2/run_aladyn_predict_with_master.py \
    --trained_model_path /path/to/master_for_fitting_pooled_all_data.pt \
    --data_dir /path/to/data \
    --output_dir /path/to/predictions \
    --batch_size 10000 \
    --num_epochs 200</code></pre>

        <p><strong>What it does:</strong></p>
        <ul>
            <li>Loads master checkpoint (pooled phi + initial_psi)</li>
            <li>Automatically loads <code>E_enrollment_full.pt</code> (full enrollment matrix)</li>
            <li>Uses <code>clust_huge_amp_fixedPhi.py</code> for fixed-phi predictions</li>
            <li>Only estimates lambda (genetic effects) per batch</li>
            <li>Generates predictions (pi tensor) for all patients</li>
        </ul>

        <p>For detailed step-by-step instructions, see the <a href="../pyScripts/new_oct_revision/new_notebooks/reviewer_responses/preprocessing/WORKFLOW.md">Complete Workflow Guide</a>.</p>

        <div class="section-divider"></div>

        <h2 id="reviewer-response-analyses">üìä Reviewer Response Analyses</h2>
        <p>Comprehensive interactive analyses addressing reviewer questions and model validation:</p>

        <h3>üìö Navigation Hub</h3>
        <p><strong><a href="reviewer_responses/README.html">Reviewer Response README</a></strong> - Complete guide to all interactive analyses</p>

        <h3>üî¨ Analysis Categories</h3>

        <h4>Referee #1 Analyses</h4>
        <table>
            <thead>
                <tr>
                    <th>Analysis</th>
                    <th>Description</th>
                    <th>Link</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Clinical Utility</strong></td>
                    <td>Dynamic risk updating and clinical decision-making</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Clinical_Utility_Dynamic_Risk_Updating.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Lifetime Risk</strong></td>
                    <td>Long-term risk predictions across the lifespan</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q2_Lifetime_Risk.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>AUC Comparisons</strong></td>
                    <td>Performance vs. established clinical risk scores</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q9_AUC_Comparisons.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Age-Stratified</strong></td>
                    <td>Performance across different age groups</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q10_Age_Specific.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Heritability</strong></td>
                    <td>Genetic architecture and heritability estimates</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q7_Heritability.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>GWAS Validation</strong></td>
                    <td>Genome-wide association studies on signatures</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Genetic_Validation_GWAS.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Biological Plausibility</strong></td>
                    <td>CHIP analysis and biological validation</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Biological_Plausibility_CHIP.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>LOO Validation</strong></td>
                    <td>Leave-one-out cross-validation robustness</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Robustness_LOO_Validation.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Selection Bias</strong></td>
                    <td>Assessment of selection bias and participation</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q1_Selection_Bias.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Clinical Meaning</strong></td>
                    <td>ICD vs PheCode comparison and clinical interpretation</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q3_Clinical_Meaning.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>ICD vs PheCode</strong></td>
                    <td>Detailed comparison of coding systems</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Q3_ICD_vs_PheCode_Comparison.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Competing Risks</strong></td>
                    <td>Multi-disease patterns and competing risks</td>
                    <td><a href="reviewer_responses/notebooks/R1/R1_Multi_Disease_Patterns_Competing_Risks.html">View</a></td>
                </tr>
            </tbody>
        </table>

        <h4>Referee #2 Analyses</h4>
        <table>
            <thead>
                <tr>
                    <th>Analysis</th>
                    <th>Description</th>
                    <th>Link</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Temporal Leakage</strong></td>
                    <td>Washout analysis and temporal leakage assessment</td>
                    <td><a href="reviewer_responses/notebooks/R2/R2_Temporal_Leakage.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Washout Continued</strong></td>
                    <td>Comprehensive washout analysis across timepoints</td>
                    <td><a href="reviewer_responses/notebooks/R2/R2_Washout_Continued.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Washout Clean</strong></td>
                    <td>Clean version of washout analysis</td>
                    <td><a href="reviewer_responses/notebooks/R2/R2_Washout_Continued_clean.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Model Validity</strong></td>
                    <td>Model learning and validity assessment</td>
                    <td><a href="reviewer_responses/notebooks/R2/R2_R3_Model_Validity_Learning.html">View</a></td>
                </tr>
            </tbody>
        </table>

        <h4>Referee #3 Analyses</h4>
        <table>
            <thead>
                <tr>
                    <th>Analysis</th>
                    <th>Description</th>
                    <th>Link</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Competing Risks</strong></td>
                    <td>Detailed competing risks analysis</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_Competing_Risks.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Fixed vs Joint Phi</strong></td>
                    <td>Comparison of fixed vs joint phi estimation</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_Fixed_vs_Joint_Phi_Comparison.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>FullE vs ReducedE</strong></td>
                    <td>Full vs reduced event matrix comparison</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_FullE_vs_ReducedE_Comparison.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Linear vs Nonlinear</strong></td>
                    <td>Linear vs nonlinear mixing approaches</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_Linear_vs_NonLinear_Mixing.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Population Stratification</strong></td>
                    <td>Ancestry-stratified analysis</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_Population_Stratification_Ancestry.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Heterogeneity</strong></td>
                    <td>Patient heterogeneity analysis</td>
                    <td><a href="reviewer_responses/notebooks/R3/R3_Q8_Heterogeneity.html">View</a></td>
                </tr>
            </tbody>
        </table>

        <h4>Framework & Preprocessing</h4>
        <table>
            <thead>
                <tr>
                    <th>Resource</th>
                    <th>Description</th>
                    <th>Link</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Framework Overview</strong></td>
                    <td>Discovery vs prediction framework</td>
                    <td><a href="reviewer_responses/notebooks/framework/Discovery_Prediction_Framework_Overview.html">View</a></td>
                </tr>
                <tr>
                    <td><strong>Preprocessing</strong></td>
                    <td>Preprocessing file creation guide</td>
                    <td><a href="reviewer_responses/preprocessing/create_preprocessing_files.html">View</a></td>
                </tr>
            </tbody>
        </table>

        <div class="section-divider"></div>

        <h2 id="documentation">üìö Documentation</h2>

        <h3>Core Model Files</h3>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>File</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Discovery Model</strong></td>
                    <td><a href="../pyScripts_forPublish/clust_huge_amp.py">clust_huge_amp.py</a></td>
                    <td>Full model that learns phi and psi</td>
                </tr>
                <tr>
                    <td><strong>Prediction Model</strong></td>
                    <td><a href="../pyScripts_forPublish/clust_huge_amp_fixedPhi.py">clust_huge_amp_fixedPhi.py</a></td>
                    <td>Fixed-phi model for fast predictions</td>
                </tr>
                <tr>
                    <td><strong>Discovery Notebook</strong></td>
                    <td><a href="../pyScripts_forPublish/aladynoulli_fit_for_understanding_and_discovery.ipynb">aladynoulli_fit_for_understanding_and_discovery.ipynb</a></td>
                    <td>Interactive discovery mode</td>
                </tr>
                <tr>
                    <td><strong>Prediction Notebook</strong></td>
                    <td><a href="../pyScripts_forPublish/aladynoulli_fit_for_prediction.ipynb">aladynoulli_fit_for_prediction.ipynb</a></td>
                    <td>Interactive prediction mode</td>
                </tr>
            </tbody>
        </table>

        <h3>Workflow Scripts</h3>
        <table>
            <thead>
                <tr>
                    <th>Script</th>
                    <th>Location</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Preprocessing</strong></td>
                    <td><a href="../pyScripts/new_oct_revision/new_notebooks/reviewer_responses/preprocessing/preprocessing_utils.py">preprocessing_utils.py</a></td>
                    <td>Preprocessing utilities</td>
                </tr>
                <tr>
                    <td><strong>Batch Training</strong></td>
                    <td><a href="../claudefile/run_aladyn_batch.py">run_aladyn_batch.py</a></td>
                    <td>Batch model training</td>
                </tr>
                <tr>
                    <td><strong>Master Checkpoint</strong></td>
                    <td><a href="../claudefile/create_master_checkpoints.py">create_master_checkpoints.py</a></td>
                    <td>Create pooled checkpoints</td>
                </tr>
                <tr>
                    <td><strong>Prediction</strong></td>
                    <td><a href="../claudefile/version_from_ec2/run_aladyn_predict_with_master.py">run_aladyn_predict_with_master.py</a></td>
                    <td>Run predictions</td>
                </tr>
            </tbody>
        </table>

        <h3>Additional Resources</h3>
        <ul>
            <li><strong>Complete Workflow Guide</strong>: <a href="../pyScripts/new_oct_revision/new_notebooks/reviewer_responses/preprocessing/WORKFLOW.md">WORKFLOW.md</a></li>
            <li><strong>Main Repository README</strong>: <a href="../README.md">README.md</a></li>
            <li><strong>Installation Guide</strong>: <a href="../INSTALLATION.md">INSTALLATION.md</a></li>
        </ul>

        <div class="section-divider"></div>

        <h2 id="performance-scalability">‚è±Ô∏è Performance & Scalability</h2>

        <h3>Typical Runtime</h3>
        <table>
            <thead>
                <tr>
                    <th>Configuration</th>
                    <th>Training Time</th>
                    <th>Memory Usage</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>CPU (Apple M4 Max)</td>
                    <td>~70 minutes</td>
                    <td>~12GB per 10,000 individuals</td>
                </tr>
            </tbody>
        </table>

        <h3>Scalability</h3>
        <ul>
            <li><strong>Individuals</strong>: Tested up to <strong>400,000</strong></li>
            <li><strong>Diseases</strong>: Tested <strong>350</strong></li>
            <li><strong>Time Points</strong>: Tested <strong>52</strong> (ages 30-81)</li>
            <li><strong>Genetic Features</strong>: Tested with <strong>36 PRS</strong> and <strong>10 PCs</strong></li>
        </ul>

        <div class="section-divider"></div>

        <h2 id="citation">üìÑ Citation</h2>
        <p>If you use this code in your research, please cite:</p>
        <pre><code>@article{urbut2024aladynoulli,
  title={Aladynoulli: A Bayesian Survival Model for Disease Trajectory Prediction},
  author={Urbut, Sarah and others},
  journal={medRxiv},
  year={2024},
  doi={10.1101/2024.09.29.24314557}
}</code></pre>

        <div class="section-divider"></div>

        <h2>üìû Contact & Support</h2>
        <ul>
            <li><strong>Author</strong>: Sarah Urbut</li>
            <li><strong>Email</strong>: <a href="mailto:surbut@mgh.harvard.edu">surbut@mgh.harvard.edu</a></li>
            <li><strong>Institution</strong>: Massachusetts General Hospital</li>
            <li><strong>GitHub</strong>: <a href="https://github.com/surbut">@surbut</a></li>
        </ul>

        <div class="section-divider"></div>

        <h2>üìú License</h2>
        <p>This project is licensed under the MIT License - see the <a href="../LICENSE">LICENSE</a> file for details.</p>

        <div class="section-divider"></div>

        <h2>üôè Acknowledgments</h2>
        <p>We thank the UK Biobank participants and the research community for making this work possible.</p>

        <div class="footer">
            <div class="note-box">
                <p><strong>Note</strong>: This software is provided for research purposes. Please ensure you have appropriate data use agreements and ethical approvals before using with real patient data.</p>
            </div>
        </div>
    </div>
</body>
</html>
