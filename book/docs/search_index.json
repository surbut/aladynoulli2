[["index.html", "ALADYNOULLI: Dynamic Disease Modeling A Bayesian Framework for Genomic Discovery and Clinical Prediction Preface Who This Book Is For How This Book Is Organized Acknowledgments Code and Data", " ALADYNOULLI: Dynamic Disease Modeling A Bayesian Framework for Genomic Discovery and Clinical Prediction Sarah M. Urbut 2026-02-04 Preface “The shape of a story is the shape of a life.” — Kurt Vonnegut This book began, as many things do, with a patient. A 34-year-old man arrives in the emergency department with chest pain. His ECG shows ST elevations. His troponin is 870. The diagnosis seems clear: acute coronary syndrome. But everything is moving—his risk was different yesterday than it is today, and it will be different tomorrow. Traditional risk models assume that hazards are proportional: that the relative risk between two individuals stays constant over time. But we know this isn’t true. A 40-year-old with high genetic risk for coronary disease faces different dynamics than a 70-year-old with the same genes. Risk evolves. Diseases interact. Biology unfolds over decades. This book describes ALADYNOULLI, a Bayesian framework that models how disease risk changes over the lifespan by integrating longitudinal electronic health records with genetic data. The name combines “Aladdin” (the genie grants wishes—and predictions) with “Bernoulli” (the distribution underlying our likelihood). The model identifies latent disease signatures from patterns of diagnosis, learns how individuals traverse these signatures over time, and incorporates genetic information to improve both biological discovery and clinical prediction. Who This Book Is For This book is written for: Biostatisticians interested in longitudinal modeling, Bayesian methods, and survival analysis Genetic epidemiologists working with biobank data and polygenic risk scores Clinical researchers developing risk prediction tools Data scientists applying machine learning to healthcare Graduate students in biostatistics, bioinformatics, or computational biology We assume familiarity with basic probability, linear algebra, and some exposure to Bayesian statistics. Code examples are in Python (PyTorch), with R used for visualization. How This Book Is Organized Part I: The Clinical Problem motivates why we need dynamic risk models, what electronic health records offer, and why genetics matters for disease trajectories. Part II: The ALADYNOULLI Model presents the mathematical framework, from the Bayesian formulation through Gaussian process priors to computational implementation. Part III: Discovering Disease Signatures shows how the model identifies latent patterns of disease co-occurrence and what these signatures mean biologically. Part IV: Genetic Validation demonstrates that signatures capture real biology through GWAS, rare variant analysis, and heritability estimation. Part V: Clinical Prediction evaluates prediction accuracy against established risk scores and shows how dynamic updating improves forecasts. Part VI: Robustness and Validation addresses selection bias, population stratification, temporal leakage, and other methodological concerns. Part VII: Advanced Topics covers competing risks, alternative architectures, and future directions. Appendices provide mathematical details, complete validation analyses, and code for reproducibility. Acknowledgments This work would not have been possible without the UK Biobank, Mass General Brigham Biobank, and All of Us Research Program participants who contributed their data for research. I am deeply grateful to my mentors Giovanni Parmigiani, Pradeep Natarajan, and Alexander Gusev for their guidance and support. Special thanks to the many collaborators who contributed to this work: Yi Ding, Tetsushi Nakao, Satoshi Koyama, Xilin Jiang, Achyutha Harish, Leslie Gaffney, Whitney Hornsby, and Jordan Smoller. Code and Data All code is available at: https://github.com/surbut/aladynoulli2 Interactive results: https://surbut.github.io/aladynoulli2/ Web application: https://aladynoulli.hms.harvard.edu Boston, Massachusetts January 2026 "],["everyone-moving.html", "Chapter 1 Everyone is Moving 1.1 The Emergency Department at 3 AM 1.2 The Proportional Hazards Assumption 1.3 When Proportionality Fails 1.4 Dynamic Hazard: Different Roles, Same End 1.5 A Preview", " Chapter 1 Everyone is Moving 1.1 The Emergency Department at 3 AM The pager goes off. A 34-year-old man has arrived with crushing chest pain that started an hour ago. The ECG shows ST-segment elevations in leads V1-V4. His high-sensitivity troponin comes back at 870 ng/L—markedly elevated. The diagnosis seems clear: ST-elevation myocardial infarction (STEMI). But pause for a moment. What was this man’s risk of MI yesterday? Last year? A decade ago? And what will it be tomorrow, next year, in the decades to come—assuming he survives? Traditional risk models struggle with these questions because they assume something that isn’t quite true: that hazards are proportional. 1.2 The Proportional Hazards Assumption The Cox proportional hazards model, introduced in 1972, revolutionized survival analysis. It models the hazard rate—the instantaneous risk of an event—as: \\[h(t|X) = h_0(t) \\exp(\\beta^T X)\\] where \\(h_0(t)\\) is the baseline hazard (which can vary with time) and \\(\\exp(\\beta^T X)\\) captures the effect of covariates. The key assumption is proportional hazards: the ratio of hazards between any two individuals remains constant over time. If Alice has twice the hazard of Bob at age 40, she has twice the hazard at age 60, 70, and 80. Hazard rate ^ | Alice (high risk) | / | / | / Bob (low risk) | / / | / / | / / |/______/____________&gt; Time This assumption is convenient—it allows us to estimate covariate effects without specifying the baseline hazard. But is it realistic? 1.3 When Proportionality Fails Consider two 40-year-olds: - Alice has a strong family history of early heart disease and carries multiple genetic risk variants - Bob has no family history and low genetic risk At age 40, Alice might have 5 times Bob’s risk of MI. But what about at age 80? By then, both have accumulated decades of exposure to other risk factors—hypertension, diabetes, smoking, stress. The relative difference between them may shrink, even as their absolute risks converge. Conversely, consider genetic risk for breast cancer. BRCA1/2 carriers face dramatically elevated lifetime risk, but the timing of that risk varies. The hazard ratio isn’t constant—it depends on age, parity, hormone exposure, and prior diagnoses. The proportional hazards assumption is a modeling convenience, not a biological truth. 1.4 Dynamic Hazard: Different Roles, Same End What if we could model how risk evolves over time? Not just static risk factors, but dynamic trajectories that adapt as new clinical information emerges? This is the central idea behind ALADYNOULLI: risk is not a fixed quantity but a trajectory that unfolds over the lifespan. The model captures this through: Time-varying signatures: Latent disease patterns that can strengthen or weaken over time Gaussian process priors: Smooth temporal dynamics that share information across ages Bayesian updating: Posterior risk that adapts as diagnoses accumulate The result is a risk profile that can answer not just “what is Alice’s risk?” but “how has Alice’s risk evolved, and how might it change in the future?” 1.5 A Preview The 34-year-old man in the ED survives his STEMI. He receives a stent, starts on medications, enters cardiac rehabilitation. His risk profile has changed dramatically. Traditional models would recalculate his static risk factors. ALADYNOULLI does more: it updates his entire trajectory, recognizing that this event reveals something about his underlying biology—his latent signature profile—that was present but hidden before. In the chapters that follow, we’ll develop this framework mathematically, validate it across three biobanks and millions of patients, and show how it improves both biological discovery and clinical prediction. But first, we need to understand the data that makes this possible. "],["longitudinal-data.html", "Chapter 2 The Promise of Longitudinal Data 2.1 Electronic Health Records: A Window Into Disease Progression 2.2 Three Biobanks, Three Healthcare Systems 2.3 The Challenge: 348 Diseases, Millions of Patients 2.4 From Reactive to Predictive Medicine 2.5 The Role of Time", " Chapter 2 The Promise of Longitudinal Data 2.1 Electronic Health Records: A Window Into Disease Progression Modern healthcare generates vast amounts of data. Every diagnosis, medication, lab test, and procedure leaves a digital trace in the electronic health record (EHR). For researchers, this represents an unprecedented opportunity to study how diseases develop, interact, and progress over time. Consider a single patient in the UK Biobank: Patient ID: 1002769 Observation period: 1995-2015 (20 years) Diagnoses: - Hypertension (age 52) - Hyperlipidemia (age 54) - Type 2 diabetes (age 58) - Angina (age 62) - Myocardial infarction (age 65) Medications: - Anti-hypertensive (started age 52) - Statin (started age 54) Biomarkers: - LDL: 120 → 85 mg/dL (after statin) - SBP: 155 → 130 mmHg (after treatment) This timeline tells a story. We see the progression from risk factors (hypertension, hyperlipidemia) to diabetes to cardiovascular disease. We see the effect of treatments. We see, ultimately, that despite interventions, the MI occurred. Now multiply this by 500,000 patients in UK Biobank, 200,000 in Mass General Brigham, 400,000 in All of Us. The patterns that emerge from millions of such trajectories form the foundation for ALADYNOULLI. 2.2 Three Biobanks, Three Healthcare Systems Our analyses span three major biobanks: 2.2.1 UK Biobank (UKB) N: ~500,000 participants Ages: 40-69 at enrollment (2006-2010) Follow-up: Up to 52 years (including retrospective linkage) Setting: UK National Health Service Strengths: Large, well-characterized, extensive genetic data Limitations: Healthy volunteer bias, predominantly White British 2.2.2 Mass General Brigham Biobank (MGB) N: ~200,000 participants Ages: All ages Follow-up: Variable (real-world clinical data) Setting: Academic medical center, Boston Strengths: Dense clinical phenotyping, diverse patient mix Limitations: Referral bias, complex care population 2.2.3 All of Us Research Program (AoU) N: ~400,000 participants Ages: All ages Follow-up: Growing (launched 2018) Setting: Multiple US healthcare systems Strengths: Diversity by design, whole genome sequencing Limitations: Shorter follow-up, evolving data These biobanks represent different healthcare systems, populations, and data collection methods. A model that works across all three demonstrates genuine generalizability. 2.3 The Challenge: 348 Diseases, Millions of Patients Analyzing this data is not straightforward. Consider the dimensions: Individuals: 400,000+ per biobank Diseases: 348 phecodes (phenotype codes) Time points: 51 annual intervals (ages 30-80) Genetic variants: Millions of SNPs A naive approach might model each disease separately. But diseases don’t occur in isolation. Diabetes increases the risk of heart disease. Cancer treatments cause cardiotoxicity. Psychiatric conditions affect medication adherence. The interactions matter. ALADYNOULLI addresses this through dimensionality reduction: instead of modeling 348 diseases independently, we identify latent signatures—patterns of diseases that tend to co-occur. This reduces the problem from 348 diseases to ~20 signatures while preserving (and revealing) biologically meaningful structure. 2.4 From Reactive to Predictive Medicine The traditional use of EHR data is reactive: a patient develops symptoms, seeks care, receives a diagnosis. The record captures what has already happened. But the same data can be used predictively: given what has happened so far, what is likely to happen next? This is the shift from reactive to predictive medicine. Traditional (Reactive): Symptoms → Diagnosis → Treatment → Outcome Predictive: History → Risk Model → Intervention → Better Outcome The patient who will have an MI at age 57 already has data in their record—hypertension diagnoses, medication patterns, biomarker trajectories—that could have identified their elevated risk years earlier. The question is whether we can build models that recognize these patterns. 2.5 The Role of Time A critical insight is that timing matters. Two patients with identical diagnoses may have very different futures depending on when those diagnoses occurred: Diabetes at age 40 vs. age 70 Breast cancer at age 35 vs. age 65 Hypertension before vs. after other cardiovascular diagnoses ALADYNOULLI explicitly models time through: Age-indexed observations: Disease status at each year of age Gaussian processes: Smooth trajectories that capture temporal dynamics Event times: Explicit modeling of censoring and competing risks This temporal structure is what allows the model to capture progression—not just snapshots, but trajectories. "],["genetics-matters.html", "Chapter 3 Genetics Matters 3.1 Beyond Static Risk Factors 3.2 Genetics Impacts Early Disease 3.3 Genetics Impacts All Disease, Early 3.4 The γ Parameter: Genetics Meets Signatures 3.5 When Do You Ask the Question? 3.6 The Joint Goal: Discovery and Prediction", " Chapter 3 Genetics Matters 3.1 Beyond Static Risk Factors Traditional risk models rely on risk factors measured at a single point in time: blood pressure, cholesterol, smoking status, family history. These factors are important, but they share a limitation: they change over time. Genetics is different. Your genome is fixed at conception and remains constant throughout life. A polygenic risk score (PRS) measured at age 30 gives the same result at age 70. This stability makes genetic information uniquely valuable for risk prediction: Early identification: Genetic risk is present before clinical risk factors manifest Causal anchoring: Mendelian randomization establishes causal relationships Lifetime trajectory: Genetic effects can be modeled across the entire lifespan 3.2 Genetics Impacts Early Disease It’s well established that high polygenic risk scores identify individuals at elevated risk for disease. What’s less appreciated is that genetics affects not just whether disease occurs, but when. For coronary artery disease, high-PRS individuals develop disease earlier: Age at CAD Diagnosis by PRS Quintile: Q1 (lowest risk): median age 68 Q2: median age 65 Q3: median age 63 Q4: median age 60 Q5 (highest risk): median age 56 This 12-year difference between top and bottom quintiles represents a decade of earlier disease burden—and a decade of opportunity for intervention. 3.3 Genetics Impacts All Disease, Early The relationship between genetic risk and age has another dimension: high-PRS individuals are more likely to be diagnosed with disease at any given age, but the effect is strongest at younger ages. Hazard Ratio by Age (CAD PRS top vs bottom quintile): Age 40-50: HR = 4.2 Age 50-60: HR = 3.1 Age 60-70: HR = 2.3 Age 70-80: HR = 1.7 This attenuation of genetic effects with age reflects multiple factors: - Competing risks (other causes of death) - Environmental exposures accumulating - Selection effects (high-risk individuals already affected) For ALADYNOULLI, this means genetic effects should be modeled as time-varying, not constant. The parameter \\(\\gamma\\) captures the association between genetics and disease signatures, but this effect operates through the temporal dynamics of \\(\\lambda\\)—stronger at younger ages, attenuating over time. 3.4 The γ Parameter: Genetics Meets Signatures In ALADYNOULLI, genetic effects enter through the parameter \\(\\gamma\\), which connects individual genetic profiles to latent signatures: \\[\\mathbb{E}[\\lambda_{ik}] = r_k + g_i^T \\gamma_k\\] where: - \\(\\lambda_{ik}\\) is individual \\(i\\)’s affinity for signature \\(k\\) - \\(r_k\\) is the population-average affinity for signature \\(k\\) - \\(g_i\\) is individual \\(i\\)’s genetic profile (e.g., standardized PRSs) - \\(\\gamma_k\\) is the genetic effect on signature \\(k\\) This formulation has several advantages: Dimensionality reduction: Instead of modeling genetic effects on 348 diseases, we model effects on ~20 signatures Information sharing: Diseases within a signature share genetic signal Biological interpretation: Signatures correspond to biological pathways 3.5 When Do You Ask the Question? A key insight from our work is that the answer to “what is your disease risk?” depends on when you ask the question. At age 40, an individual with high cardiovascular PRS has dramatically elevated relative risk but modest absolute risk (events are rare at this age). At age 70, the same individual has lower relative risk but higher absolute risk (events are common at this age). This creates a clinical dilemma: - Early intervention (age 40): Large relative risk reduction possible, but few events prevented - Late intervention (age 70): Smaller relative risk reduction, but more events prevented ALADYNOULLI addresses this by providing dynamic predictions that update as individuals age and accumulate diagnoses. The model doesn’t give a single risk estimate—it gives a trajectory that evolves over the lifespan. 3.6 The Joint Goal: Discovery and Prediction A crucial feature of ALADYNOULLI is that it simultaneously enables genomic discovery and clinical prediction: Discovery: Identifying genetic variants associated with disease signatures Prediction: Forecasting individual disease risk over time These goals are often treated separately, with discovery studies (GWAS) and prediction models developed independently. But they’re fundamentally connected: the same genetic signal that improves prediction also reveals biology. In later chapters, we’ll show how ALADYNOULLI: - Identifies 151 genome-wide significant loci across 21 signatures - Discovers cardiovascular associations not found in single-trait GWAS - Achieves heritability exceeding component diseases - Improves prediction over established clinical risk scores The joint consideration of discovery and prediction—not one or the other, but both—is what makes the Bayesian framework powerful. "],["bayesian.html", "Chapter 4 Everyone is a Bayesian 4.1 Thomas Bayes and the Art of Updating Beliefs 4.2 Why Bayesian? The Case for Updating 4.3 Prior Knowledge: Signatures as Population Patterns 4.4 Individual Data: The Likelihood 4.5 Continuously Updated Posteriors 4.6 Joint Consideration: Discovery and Prediction", " Chapter 4 Everyone is a Bayesian 4.1 Thomas Bayes and the Art of Updating Beliefs In 1763, Richard Price published a paper by the late Reverend Thomas Bayes titled “An Essay towards solving a Problem in the Doctrine of Chances.” The problem Bayes addressed was deceptively simple: given observed data, what can we infer about the underlying probability that generated it? Bayes’ insight was that we should combine our prior beliefs with the evidence from data to arrive at posterior beliefs: \\[P(\\theta | \\text{Data}) \\propto P(\\text{Data} | \\theta) \\times P(\\theta)\\] Or in words: \\[\\text{Posterior} \\propto \\text{Likelihood} \\times \\text{Prior}\\] This formula—Bayes’ theorem—is the foundation of modern Bayesian statistics and the heart of ALADYNOULLI. 4.2 Why Bayesian? The Case for Updating Consider a patient presenting to clinic. Before any tests, you have prior beliefs about their disease status based on demographics, chief complaint, and prevalence. Then you observe data—their symptoms, physical exam findings, test results—that update your beliefs to a posterior probability. This is exactly how clinicians think: Prior: &quot;50-year-old smoker with chest pain... probably cardiac&quot; → P(MI) ≈ 15% Data: &quot;ECG shows ST elevations, troponin elevated&quot; → Strong evidence for MI Posterior: P(MI | data) ≈ 95% Bayesian reasoning formalizes this intuitive process. 4.3 Prior Knowledge: Signatures as Population Patterns In ALADYNOULLI, the prior encodes population-level knowledge about disease patterns: Signatures (\\(\\phi\\)): Which diseases tend to co-occur? Prevalence (\\(\\mu_d\\)): How common is each disease over time? Genetic effects (\\(\\gamma\\)): How do genetic factors influence signatures? These population parameters are learned from large biobank data and represent what we know before seeing any individual patient. 4.4 Individual Data: The Likelihood The likelihood captures how well the model explains an individual’s observed diagnoses: Which diseases have they been diagnosed with? At what ages? What hasn’t been diagnosed (censoring)? For individual \\(i\\) with disease history \\(Y_i\\), the likelihood is: \\[P(Y_i | \\theta_i, \\phi) = \\prod_{d=1}^{D} \\prod_{t=1}^{T} P(Y_{idt} | \\pi_{idt})\\] where \\(\\pi_{idt}\\) is the modeled disease probability. 4.5 Continuously Updated Posteriors The posterior combines prior and likelihood to give individualized disease trajectories: \\[P(\\lambda_i | Y_i, \\phi, \\gamma) \\propto P(Y_i | \\lambda_i, \\phi) \\times P(\\lambda_i | \\gamma, g_i)\\] As new diagnoses accumulate, the posterior updates: At enrollment: Prior dominated by genetics and demographics First diagnosis: Posterior shifts toward associated signatures Multiple diagnoses: Pattern becomes clearer, predictions sharpen This continuous updating is what enables dynamic risk prediction—the model learns from each patient’s evolving history. 4.6 Joint Consideration: Discovery and Prediction A key philosophical point: in ALADYNOULLI, discovery (learning population parameters) and prediction (inferring individual risk) happen jointly. Traditional workflows separate these: 1. Run GWAS → discover genetic associations 2. Build PRS → create risk score 3. Develop model → predict outcomes ALADYNOULLI integrates them: - Population parameters (\\(\\phi\\), \\(\\gamma\\), \\(\\psi\\)) are learned from all individuals - Individual parameters (\\(\\lambda_i\\)) are inferred given the population - Both improve together as more data accumulates This joint optimization is why the model achieves both strong prediction and novel biological discovery. "],["math-framework.html", "Chapter 5 The Mathematical Framework 5.1 Model Overview 5.2 The λ Parameter: Individual Signature Affinities 5.3 The φ Parameter: Signature-Disease Associations 5.4 The Likelihood Function 5.5 The Complete Model 5.6 Identifiability Considerations", " Chapter 5 The Mathematical Framework 5.1 Model Overview ALADYNOULLI models the probability that individual \\(i\\) is diagnosed with disease \\(d\\) at time \\(t\\) through a hierarchical Bayesian structure: \\[\\pi_{idt} = \\sum_{k=1}^{K} \\theta_{ikt} \\cdot \\phi_{kdt}\\] where: - \\(\\pi_{idt}\\) ∈ [0,1] is the disease probability - \\(\\theta_{ikt}\\) is individual \\(i\\)’s proportion in signature \\(k\\) at time \\(t\\) - \\(\\phi_{kdt}\\) ∈ [0,1] is signature \\(k\\)’s association with disease \\(d\\) at time \\(t\\) - \\(K\\) is the number of signatures (typically 20-21) This decomposition separates individual trajectories (\\(\\theta\\)) from population-level disease patterns (\\(\\phi\\)). 5.2 The λ Parameter: Individual Signature Affinities Each individual has a latent affinity \\(\\lambda_{ikt}\\) for each signature at each time point. These affinities are transformed to proportions via softmax: \\[\\theta_{ik}(t) = \\frac{\\exp(\\lambda_{ik}(t))}{\\sum_{k&#39;=1}^{K} \\exp(\\lambda_{ik&#39;}(t))}\\] The softmax ensures that \\(\\sum_k \\theta_{ikt} = 1\\)—individuals are distributed across signatures. The λ parameters follow Gaussian processes in time: \\[\\lambda_{ik}(t) \\sim \\mathcal{GP}(m_{ik}(t), \\Omega_\\lambda)\\] where: - \\(m_{ik}(t) = r_k + g_i^T \\gamma_k\\) is the mean function - \\(r_k\\) is the population reference for signature \\(k\\) - \\(g_i^T \\gamma_k\\) is the genetic effect - \\(\\Omega_\\lambda\\) is the temporal covariance kernel 5.3 The φ Parameter: Signature-Disease Associations The φ parameters capture how strongly each signature is associated with each disease: \\[\\phi_{kd}(t) = \\sigma(\\psi_{kd} + \\mu_d(t))\\] where: - \\(\\sigma(\\cdot)\\) is the sigmoid function - \\(\\psi_{kd}\\) is the signature-disease loading (time-invariant) - \\(\\mu_d(t)\\) is the population prevalence of disease \\(d\\) at time \\(t\\) The φ parameters also follow Gaussian processes to ensure smooth temporal dynamics: \\[\\phi_{kd}(t) \\sim \\mathcal{GP}(\\mu_d(t) + \\psi_{kd}, \\Omega_\\phi)\\] 5.4 The Likelihood Function The observed data are binary disease indicators \\(Y_{idt} \\in \\{0,1\\}\\). The likelihood incorporates censoring through event times \\(E_{id}\\): \\[\\mathcal{L} = \\prod_{i=1}^{N} \\prod_{d=1}^{D} \\prod_{t=1}^{T} \\begin{cases} (1-\\pi_{idt}) &amp; \\text{if } t &lt; E_{id} \\text{ (at risk, no event)} \\\\ \\pi_{idt}^{Y_{idt}} (1-\\pi_{idt})^{1-Y_{idt}} &amp; \\text{if } t = E_{id} \\text{ (event or censor)} \\end{cases}\\] This accounts for: - Left truncation: Individuals enter observation at different ages - Right censoring: Follow-up ends before disease occurs - Interval censoring: Disease occurs between observation times 5.5 The Complete Model Putting it together: Data: - \\(Y_{idt}\\): Disease status (0/1) - \\(E_{id}\\): Event/censoring time - \\(g_i\\): Genetic profile Parameters: - \\(\\lambda_{ikt}\\): Individual signature affinities (N × K × T) - \\(\\phi_{kdt}\\): Signature-disease associations (K × D × T) - \\(\\psi_{kd}\\): Signature-disease loadings (K × D) - \\(\\gamma_k\\): Genetic effects on signature \\(k\\) (P × K) - \\(r_k\\): Population reference for signature \\(k\\) (K) Priors: - \\(\\lambda \\sim \\mathcal{GP}(r + G\\gamma, \\Omega_\\lambda)\\) - \\(\\phi \\sim \\mathcal{GP}(\\mu + \\psi, \\Omega_\\phi)\\) - \\(\\gamma \\sim \\mathcal{N}(0, \\sigma_\\gamma^2 I)\\) Likelihood: \\[P(Y | \\lambda, \\phi) = \\prod_{i,d,t} \\text{Bernoulli}(Y_{idt} | \\pi_{idt})\\] 5.6 Identifiability Considerations A natural question arises: with so many parameters, is the model identifiable? What is identifiable: - Signature-disease associations (\\(\\phi\\), \\(\\psi\\)): Well-identified from co-occurrence patterns - Genetic effects on level (\\(\\gamma\\)): Identified through cross-sectional associations - Relative genetic effects on progression: Identified as differences between signatures What requires constraints: - Absolute scale of \\(\\lambda\\): Fixed by signature references \\(r_k\\) - Absolute genetic slopes: Only relative differences identifiable (due to softmax) The softmax transformation means that if all signatures increase at the same rate, this is observationally equivalent to no signature changing. We can identify which signatures are differentially accelerated, but not absolute acceleration rates. This is a feature, not a bug: the clinically meaningful quantity is “does high PRS shift disease profile toward cardiovascular signatures?” not “what is the absolute slope of signature 0?” "],["gaussian-processes.html", "Chapter 6 Gaussian Processes for Temporal Dynamics 6.1 Why Gaussian Processes? 6.2 The Squared Exponential Kernel 6.3 GP Priors as Soft Constraints 6.4 Computational Considerations", " Chapter 6 Gaussian Processes for Temporal Dynamics 6.1 Why Gaussian Processes? Disease risk doesn’t jump erratically from year to year. A 50-year-old’s risk is similar to their risk at 49 and 51. This temporal smoothness is biologically plausible and statistically useful. Gaussian processes (GPs) provide a principled way to encode this smoothness. A GP defines a distribution over functions such that any finite collection of function values follows a multivariate normal distribution: \\[f(t_1), f(t_2), \\ldots, f(t_n) \\sim \\mathcal{N}(\\mu, K)\\] where \\(K_{ij} = k(t_i, t_j)\\) is determined by a covariance (kernel) function. 6.2 The Squared Exponential Kernel We use the squared exponential (RBF) kernel: \\[k(t, t&#39;) = \\sigma^2 \\exp\\left(-\\frac{(t-t&#39;)^2}{2\\ell^2}\\right)\\] where: - \\(\\sigma^2\\) is the amplitude (variance of the function) - \\(\\ell\\) is the length scale (how quickly correlations decay) For disease trajectories: - λ length scale: T/4 ≈ 12.5 years (individual trajectories can change over decades) - φ length scale: T/3 ≈ 17 years (population patterns change slowly) 6.3 GP Priors as Soft Constraints In ALADYNOULLI, GPs serve as soft constraints on temporal dynamics. The prior pulls \\(\\lambda\\) toward the genetic mean: \\[\\lambda_{ik}(t) \\sim \\mathcal{GP}(r_k + g_i^T \\gamma_k, \\Omega_\\lambda)\\] But \\(\\lambda\\) is also a free parameter that can deviate from this mean to fit the observed data. The GP prior acts like a spring: - Weak prior (low precision): \\(\\lambda\\) can deviate freely → better fit, less interpretability - Strong prior (high precision): \\(\\lambda\\) stays near genetic mean → more interpretability, potential underfit The balance is controlled by the GP weight parameter \\(W\\) in the loss function: \\[\\mathcal{L}_{\\text{total}} = \\mathcal{L}_{\\text{NLL}} + W \\cdot \\mathcal{L}_{\\text{GP}}\\] 6.4 Computational Considerations GPs are computationally expensive: naive evaluation scales as \\(O(T^3)\\) due to matrix inversion. For \\(T=51\\) time points, this is manageable. For larger \\(T\\), approximations would be needed. Our implementation: 1. Pre-compute Cholesky decomposition of kernel matrices 2. Vectorize across individuals and signatures 3. Use PyTorch for automatic differentiation This enables fitting on 400,000 individuals in hours rather than days. "],["genetic-effects.html", "Chapter 7 Genetic Effects on Disease Trajectories 7.1 The γ_level Parameter 7.2 Initialization from Linear Regression 7.3 Relative vs Absolute Effects 7.4 Validation: Known Risk Populations", " Chapter 7 Genetic Effects on Disease Trajectories 7.1 The γ_level Parameter Genetic effects enter ALADYNOULLI through the parameter \\(\\gamma\\), which we call \\(\\gamma_{\\text{level}}\\) to distinguish from potential slope effects: \\[\\mathbb{E}[\\lambda_{ik}(t)] = r_k + g_i^T \\gamma_{\\text{level},k}\\] This captures the baseline genetic effect: individuals with certain genetic profiles tend to have higher (or lower) affinity for specific signatures, on average across all ages. 7.2 Initialization from Linear Regression A key practical insight is that \\(\\gamma_{\\text{level}}\\) can be initialized from simple linear regression: Compute cluster-specific disease burden for each individual Regress burden on genetic profile \\(G\\) Use regression coefficients as initial \\(\\gamma_{\\text{level}}\\) This “warm start” is crucial for practical identifiability. Without it, the free \\(\\lambda\\) parameters can absorb genetic signal, leaving \\(\\gamma\\) near zero. 7.3 Relative vs Absolute Effects Due to the softmax transformation, genetic effects are identified as relative differences: Scenario: TRUE genetic slopes on λ are [0.05, 0.03, 0.02] per year (all positive) What the model identifies: Signature 0: +0.017 (fastest—above average) Signature 1: -0.003 (middle—near average) Signature 2: -0.013 (slowest—below average) The signs appear different because softmax makes everything relative to the mean. But the clinical interpretation is the same: “High PRS individuals shift their disease profile toward Signature 0 (cardiovascular) over time, relative to other signatures.” This is actually the meaningful quantity—we care about relative shifts, not absolute rates. 7.4 Validation: Known Risk Populations We validate genetic effects through enrichment in known risk populations: Familial Hypercholesterolemia (FH) carriers: - FH carriers have higher cardiovascular signature (SIG5) values than non-carriers with similar LDL levels - This confirms the model captures genetic biology beyond observable phenotypes CHIP (Clonal Hematopoiesis): - CHIP carriers show elevated cardiovascular and inflammatory signatures - Consistent with known CHIP biology These validations demonstrate that \\(\\gamma\\) captures real biological signal, not just statistical associations. "],["implementation.html", "Chapter 8 Computational Implementation 8.1 The Vectorization Challenge 8.2 Vectorized Likelihood 8.3 PyTorch and Automatic Differentiation 8.4 Real-Time Patient Refitting 8.5 Scalability", " Chapter 8 Computational Implementation 8.1 The Vectorization Challenge The original ALADYNOULLI implementation used nested loops: for i in range(N): # 400,000 individuals for d in range(D): # 348 diseases for t in range(T): # 51 time points # compute likelihood contribution With \\(N \\times D \\times T \\approx 7\\) billion operations per epoch, training took days. 8.2 Vectorized Likelihood The breakthrough was recognizing that the likelihood can be vectorized using tensor operations: # Vectorized computation theta = torch.softmax(lambda_, dim=1) # (N, K, T) phi_prob = torch.sigmoid(phi) # (K, D, T) pi = torch.einsum(&#39;nkt,kdt-&gt;ndt&#39;, theta, phi_prob) * kappa # (N, D, T) # Vectorized likelihood log_lik = Y * torch.log(pi) + (1-Y) * torch.log(1-pi) loss = -log_lik.sum() This reduces training from days to hours—a &gt;100x speedup. 8.3 PyTorch and Automatic Differentiation ALADYNOULLI is implemented in PyTorch, leveraging: Automatic differentiation: Gradients computed automatically GPU acceleration: Large tensor operations parallelized Optimizer ecosystem: Adam with parameter groups param_groups = [ {&#39;params&#39;: [lambda_], &#39;lr&#39;: 0.01}, {&#39;params&#39;: [phi], &#39;lr&#39;: 0.001}, {&#39;params&#39;: [gamma], &#39;lr&#39;: 0.01, &#39;weight_decay&#39;: 0.001} ] optimizer = torch.optim.Adam(param_groups) 8.4 Real-Time Patient Refitting The vectorized implementation enables real-time refitting: Load pre-trained population parameters (\\(\\phi\\), \\(\\gamma\\), \\(\\psi\\)) Initialize individual \\(\\lambda\\) from genetics Fit \\(\\lambda\\) to patient’s diagnosis history (seconds, not hours) Generate updated risk predictions This is what powers the web application at https://aladynoulli.hms.harvard.edu 8.5 Scalability Current implementation handles: - N: 400,000 individuals - D: 348 diseases - T: 51 time points - K: 21 signatures - P: 5+ genetic features Training time: ~2-4 hours on a modern GPU Individual refitting: &lt;10 seconds per patient "],["latent-patterns.html", "Chapter 9 Latent Patterns of Disease 9.1 What is a Signature? 9.2 Learning Signatures from Data 9.3 The 21 Signatures 9.4 Visualizing Signatures 9.5 Time-Varying Patterns 9.6 The Healthy Signature", " Chapter 9 Latent Patterns of Disease 9.1 What is a Signature? A disease signature is a pattern of diseases that tend to co-occur and share temporal dynamics. Rather than thinking of 348 diseases independently, signatures group them into clinically meaningful clusters. Consider the cardiovascular signature (SIG5): - Coronary atherosclerosis - Angina pectoris - Myocardial infarction - Heart failure - Hyperlipidemia - Hypertension These diseases share risk factors, pathophysiology, and treatment targets. A patient with one is at elevated risk for the others. The signature captures this shared structure. 9.2 Learning Signatures from Data ALADYNOULLI learns signatures through the \\(\\psi\\) parameter, which encodes signature-disease associations: \\[\\phi_{kd} = \\sigma(\\mu_d + \\psi_{kd})\\] Diseases with high \\(\\psi_{kd}\\) are strongly associated with signature \\(k\\); diseases with low (negative) \\(\\psi_{kd}\\) are weakly associated or negatively associated. The learning process: 1. Initialize \\(\\psi\\) via spectral clustering on disease co-occurrence 2. Optimize jointly with other parameters 3. Signatures emerge that explain disease patterns 9.3 The 21 Signatures Across three biobanks, we identify 21 robust signatures: Signature Primary Pattern Key Diseases SIG1 Musculoskeletal Osteoarthritis, back pain, joint disorders SIG2 Respiratory COPD, asthma, pneumonia SIG3 Gastrointestinal GERD, IBS, diverticulosis SIG4 Neurological Headache, neuropathy, seizures SIG5 Cardiovascular CAD, MI, heart failure, hypertension SIG6 Psychiatric Depression, anxiety, insomnia SIG7 Metabolic Diabetes, obesity, metabolic syndrome SIG8 Dermatological Eczema, psoriasis, acne SIG9 Genitourinary UTI, kidney stones, BPH SIG10 Hematologic Anemia, bleeding disorders SIG11 Cancer-general Multiple cancer types SIG12 Breast/GYN Breast pathology, menstrual disorders SIG13 Autoimmune RA, lupus, IBD SIG14 Infectious Various infections SIG15 Endocrine Thyroid disorders, other endocrine SIG16 Ophthalmologic Cataracts, glaucoma, macular degeneration SIG17 ENT Hearing loss, sinusitis, tonsillitis SIG18 Trauma/Injury Fractures, sprains, accidents SIG19 Substance use Alcohol, tobacco, drug disorders SIG20 Healthy Low disease burden (reference) SIG21 Multi-system Complex multi-organ involvement 9.4 Visualizing Signatures Each signature can be visualized as a heatmap of disease associations: Cardiovascular Signature (SIG5) Disease Association (φ) ──────────────────────────────────────── Coronary atherosclerosis ████████████ 0.85 Essential hypertension ████████████ 0.82 Hyperlipidemia ███████████ 0.78 Angina pectoris ██████████ 0.72 Myocardial infarction █████████ 0.68 Heart failure ████████ 0.61 Atrial fibrillation ███████ 0.54 Stroke ██████ 0.48 ... Depression ██ 0.15 Osteoarthritis █ 0.08 The signature shows strong associations with cardiovascular diseases and weaker associations with related conditions. 9.5 Time-Varying Patterns Signatures aren’t static—they change over the lifespan: θ (Cardiovascular signature proportion) ^ 0.6 | ___________ | __/ 0.4 | __/ | __/ 0.2 | __/ | __/ 0.0 |____/ +-------------------------&gt; Age 30 40 50 60 70 80 For many individuals, cardiovascular signature proportion increases with age as risk factors accumulate and events occur. 9.6 The Healthy Signature A unique feature of ALADYNOULLI is the healthy signature (SIG20): Negative associations with most diseases Represents absence of disease burden Individuals start with high healthy signature proportion Proportion decreases as diseases accumulate This provides a natural baseline and helps with calibration. "],["cross-cohort.html", "Chapter 10 Consistency Across Populations 10.1 The Generalizability Challenge 10.2 Measuring Similarity 10.3 Results: Remarkable Consistency 10.4 What Stays the Same 10.5 What Adapts 10.6 Implications for Clinical Use", " Chapter 10 Consistency Across Populations 10.1 The Generalizability Challenge A model that works in one population but fails in another has limited value. Disease signatures discovered in UK Biobank must replicate in Mass General Brigham and All of Us to be credible. But these populations differ in important ways: - Demographics: Age, sex, ancestry composition - Healthcare systems: NHS vs US academic center vs multi-site US - Ascertainment: Volunteer vs clinical cohort vs diversity-focused - Data quality: ICD coding practices, completeness Can signatures generalize across these differences? 10.2 Measuring Similarity We quantify cross-cohort signature similarity using the Composition Preservation Probability Index (CPPI): For each UKB signature, find its best match in the comparison cohort, then calculate: \\[\\text{CPPI} = \\frac{|\\text{Diseases in both}|}{|\\text{Diseases in UKB signature}|}\\] A CPPI of 0.80 means 80% of diseases in the UKB signature also appear in the matched signature of the comparison cohort. 10.3 Results: Remarkable Consistency Across all signature comparisons: Comparison Median CPPI Range UKB vs MGB 0.82 0.65-0.95 UKB vs AoU 0.78 0.60-0.92 MGB vs AoU 0.80 0.62-0.94 Combined 0.80 0.60-0.95 These results demonstrate that disease signatures capture biologically fundamental patterns that transcend healthcare systems and populations. 10.4 What Stays the Same The signature-disease associations (\\(\\phi\\), \\(\\psi\\)) show high stability: - Cardiovascular diseases cluster together across all three biobanks - Cancer signatures maintain their composition - Psychiatric patterns replicate This suggests \\(\\phi\\) captures invariant biological relationships. 10.5 What Adapts The individual trajectories (\\(\\lambda\\), \\(\\theta\\)) adapt to local population characteristics: - Prevalence differences (higher obesity in US) - Age distributions (different enrollment criteria) - Healthcare utilization patterns This is appropriate: \\(\\lambda\\) should reflect the population being modeled. 10.6 Implications for Clinical Use Cross-cohort consistency has practical implications: Model transfer: Signatures learned in UKB can inform predictions in other populations Biological validity: Consistent patterns are more likely to reflect biology Generalizability: Results are not artifacts of a single dataset "],["heterogeneity.html", "Chapter 11 Heterogeneity Within Disease 11.1 Beyond Diagnostic Categories 11.2 Case Study: Breast Cancer 11.3 Quantifying Heterogeneity 11.4 Case Study: Major Depression 11.5 Case Study: Myocardial Infarction 11.6 Clinical Implications 11.7 Heterogeneity Matches Genotype", " Chapter 11 Heterogeneity Within Disease 11.1 Beyond Diagnostic Categories Traditional diagnostic codes (ICD, phecodes) group patients into categories: “Type 2 diabetes,” “Major depressive disorder,” “Breast cancer.” But within each category, patients differ enormously in: Disease severity and trajectory Comorbidity patterns Treatment response Outcomes ALADYNOULLI reveals this within-disease heterogeneity through signature profiles. 11.2 Case Study: Breast Cancer Consider 10,000 women diagnosed with breast cancer. All share the same diagnostic code, but their signature profiles differ: Cluster A (40% of patients): - High SIG12 (Breast/GYN): Primary breast pathology - Low other signatures - Younger age at diagnosis - Better prognosis Cluster B (35% of patients): - High SIG12 + High SIG7 (Metabolic) - Obesity, diabetes comorbidity - Older age at diagnosis - Intermediate prognosis Cluster C (25% of patients): - High SIG12 + High SIG11 (Cancer-general) + High SIG21 (Multi-system) - Multiple malignancies - Complex comorbidity - Worse prognosis These clusters have different biology, different risk factors, and different outcomes—all within “breast cancer.” 11.3 Quantifying Heterogeneity We measure signature differences between patient clusters using Cohen’s d: \\[d = \\frac{\\mu_1 - \\mu_2}{\\sigma_{\\text{pooled}}}\\] Results across diseases: - Mean Cohen’s d: 2.1 (large effect) - Maximum Cohen’s d: 4.25 (very large effect) - 95% of comparisons: p &lt; 10⁻⁸ These are not subtle differences—patients within the same diagnostic category have dramatically different signature profiles. 11.4 Case Study: Major Depression Patients with major depressive disorder (MDD) cluster into distinct subtypes: Subtype 1: Pure psychiatric - High SIG6 (Psychiatric) - Anxiety, insomnia comorbidity - Earlier onset - Responds to standard antidepressants Subtype 2: Cardiometabolic - High SIG6 + High SIG5 (Cardiovascular) + High SIG7 (Metabolic) - Obesity, diabetes, hypertension - Later onset - May need integrated treatment Subtype 3: Pain-predominant - High SIG6 + High SIG1 (Musculoskeletal) - Chronic pain comorbidity - Fibromyalgia, chronic fatigue overlap - May benefit from pain-focused interventions 11.5 Case Study: Myocardial Infarction MI patients also show signature heterogeneity: Subtype 1: Classic atherosclerotic - High SIG5 (Cardiovascular) - Long history of risk factors - Older age Subtype 2: Metabolic-driven - High SIG5 + High SIG7 (Metabolic) - Diabetes-related - May benefit from aggressive metabolic management Subtype 3: Inflammatory - High SIG5 + High SIG13 (Autoimmune) - Inflammatory component - May respond to anti-inflammatory therapy 11.6 Clinical Implications Within-disease heterogeneity has implications for: Precision medicine: Same diagnosis ≠ same treatment Prognosis: Signature profiles predict outcomes beyond diagnostic codes Trial design: Heterogeneous populations may obscure treatment effects Biological understanding: Different etiologies within a diagnosis 11.7 Heterogeneity Matches Genotype Remarkably, these clinically-defined subtypes show genetic differences: Patients cluster by signature profile Clusters have different polygenic risk scores Genetic heterogeneity mirrors phenotypic heterogeneity This suggests the subtypes reflect distinct biological processes with different genetic architectures. "],["gwas.html", "Chapter 12 Common Variant Associations (GWAS) 12.1 Signature-Based GWAS 12.2 Results: 151 Genome-Wide Significant Loci 12.3 Novel Cardiovascular Associations 12.4 Why Signatures Have More Power 12.5 Replication of Known Biology", " Chapter 12 Common Variant Associations (GWAS) 12.1 Signature-Based GWAS Traditional GWAS tests association between genetic variants and binary disease outcomes. ALADYNOULLI enables a different approach: GWAS on continuous signature values. For each individual, we compute their signature exposure: \\[\\text{Exposure}_k = \\sum_{t} \\theta_{ikt}\\] This cumulative signature exposure captures lifetime disease burden in that signature. We then test: \\[\\text{Exposure}_k \\sim \\beta_0 + \\beta_1 \\cdot \\text{SNP} + \\text{covariates}\\] 12.2 Results: 151 Genome-Wide Significant Loci Across 21 signatures, we identify 151 genome-wide significant loci (p &lt; 5×10⁻⁸): Signature Loci Top Genes SIG5 (Cardiovascular) 42 LPA, APOB, LDLR, IL6R, PCSK9 SIG7 (Metabolic) 28 FTO, MC4R, TMEM18, TCF7L2 SIG11 (Cancer) 23 TERT, ATM, TP53, BRCA2 SIG6 (Psychiatric) 18 CACNA1C, DRD2, BDNF Other signatures 40 Various 12.3 Novel Cardiovascular Associations A key finding: signature-based GWAS identifies loci not detected in single-trait GWAS of component diseases. For SIG5 (cardiovascular signature), we identified 23 lead variants annotated to genes including: - IL6R (inflammation) - SMAD3 (TGF-β signaling) - ZPR1/ZNF259 (lipid metabolism) - SCARB1 (HDL receptor) - CFDP1 (complement) - PDGFD (vascular biology) These did not reach genome-wide significance as lead loci in our single-trait GWAS of angina, MI, coronary atherosclerosis, or hypercholesterolemia conducted on the same UK Biobank data. 12.4 Why Signatures Have More Power Signatures aggregate related diseases, increasing statistical power through: Larger effective sample size: More “cases” when combining related conditions Reduced noise: Common genetic signal amplified, disease-specific noise averaged out Biological coherence: Variants affecting shared pathways detected The heritability analysis (next chapter) confirms this quantitatively. 12.5 Replication of Known Biology Many identified loci replicate established biology: LPA (Lipoprotein(a)) - Known causal risk factor for CAD - Strong signal in SIG5 PCSK9 - Target of cholesterol-lowering drugs - Strong signal in SIG5 FTO - Established obesity gene - Strong signal in SIG7 (Metabolic) TERT - Telomere maintenance, cancer susceptibility - Strong signal in SIG11 (Cancer) This replication validates the biological relevance of signatures. "],["rvas.html", "Chapter 13 Rare Variant Associations (RVAS) 13.1 Gene-Based Testing 13.2 Results: 18 Significant Genes 13.3 Pleiotropic Effects 13.4 Robust Across Masks 13.5 The DEFB1 Signal", " Chapter 13 Rare Variant Associations (RVAS) 13.1 Gene-Based Testing While GWAS focuses on common variants, rare variant association studies (RVAS) test whether rare, potentially damaging variants in a gene collectively associate with phenotype. We used REGENIE to perform gene-based RVAS with multiple variant masks: - Mask 1: Loss-of-function (LoF) only - Mask 2: LoF + predicted deleterious missense - Mask 3: LoF + all missense - Masks 4-6: Progressively inclusive categories 13.2 Results: 18 Significant Genes We identified 18 unique genes with genome-wide significant associations across 21 signatures: Gene Signature(s) Known Biology LDLR SIG5 (CV) LDL receptor, FH LPA SIG5 (CV) Lipoprotein(a) APOB SIG5, SIG7 Apolipoprotein B TTN SIG5, Multiple Cardiomyopathy BRCA2 SIG11, SIG12 DNA repair, cancer TET2 SIG5, SIG10 CHIP, clonal hematopoiesis PKD1 Multiple Polycystic kidney MSH2 Multiple Lynch syndrome DEFB1 SIG20 Defensin, immunity 13.3 Pleiotropic Effects Several genes show associations across multiple signatures, indicating pleiotropy: BRCA2: - SIG11 (Cancer-general) - SIG12 (Breast/GYN) - Consistent with known breast/ovarian cancer risk PKD1: - SIG9 (Genitourinary) - SIG5 (Cardiovascular) - Consistent with kidney-cardiovascular axis TET2: - SIG5 (Cardiovascular) - SIG10 (Hematologic) - Consistent with CHIP biology 13.4 Robust Across Masks Seven genes were significant across all 6 variant masks: - LDLR, LPA, APOB (lipid metabolism) - CDH26 (cadherin) - TTN (muscle structure) - RAD52 (DNA repair) - PKD1 (polycystic kidney) This robustness to mask definition increases confidence in the associations. 13.5 The DEFB1 Signal An intriguing finding: DEFB1 (defensin beta 1) associated with the healthy signature (SIG20). Defensins are antimicrobial peptides involved in innate immunity. The association with the healthy signature suggests a potential role in maintaining health/resisting disease. This illustrates how ALADYNOULLI can identify biologically plausible relationships that wouldn’t be found in traditional disease-focused GWAS. "],["heritability.html", "Chapter 14 Heritability and Biological Relevance 14.1 Observed-Scale Heritability 14.2 Signatures vs Component Diseases 14.3 Why Aggregation Helps 14.4 Familial Hypercholesterolemia Validation 14.5 CHIP Carrier Validation 14.6 Genetic Correlation Structure", " Chapter 14 Heritability and Biological Relevance 14.1 Observed-Scale Heritability Heritability (\\(h^2\\)) measures the proportion of phenotypic variance explained by genetics. For binary diseases, two scales are used: Liability scale: Assumes an underlying continuous liability Observed scale: Based on the binary phenotype directly Signatures are continuous phenotypes, so their heritability is inherently on the observed scale. To compare fairly with diseases, we compute disease heritability on the same observed scale. 14.2 Signatures vs Component Diseases A key finding: signature heritability often exceeds component disease heritability. Signature h² (sig) Top Disease h² (disease) SIG5 (CV) 0.18 CAD 0.12 SIG7 (Metabolic) 0.22 T2D 0.15 SIG11 (Cancer) 0.14 Breast Ca 0.10 SIG6 (Psychiatric) 0.16 Depression 0.09 This makes sense: signatures aggregate genetic signal across related diseases, while disease-specific noise is averaged out. 14.3 Why Aggregation Helps Consider the genetic architecture: - Variant A affects CAD (effect size β₁) - Variant A also affects hyperlipidemia (effect size β₂) - In single-disease GWAS: detected with power from one phenotype - In signature GWAS: detected with combined power from both phenotypes This is essentially a form of multi-trait analysis that increases effective sample size for shared genetic effects. 14.4 Familial Hypercholesterolemia Validation We validated that signatures capture genetic biology through enrichment analyses. FH carrier analysis: - Identified carriers of known FH-causing variants (LDLR, APOB, PCSK9) - Compared signature values to non-carriers with similar LDL levels - FH carriers had higher SIG5 (cardiovascular) values This demonstrates that signatures capture genetic predisposition beyond what’s visible in standard clinical measures. 14.5 CHIP Carrier Validation Similar validation with clonal hematopoiesis (CHIP): Identified carriers of CHIP-associated mutations (DNMT3A, TET2, ASXL1) CHIP carriers had elevated SIG5 (cardiovascular) and SIG10 (hematologic) values Consistent with known CHIP biology linking hematopoiesis to cardiovascular risk 14.6 Genetic Correlation Structure Signatures show interpretable genetic correlations: Genetic Correlation Matrix (partial) SIG5 SIG6 SIG7 SIG11 SIG5 (CV) 1.00 0.25 0.45 0.15 SIG6 (Psy) 0.25 1.00 0.20 0.10 SIG7 (Met) 0.45 0.20 1.00 0.18 SIG11 (Ca) 0.15 0.10 0.18 1.00 SIG5 and SIG7 show substantial correlation (cardiometabolic axis) SIG6 correlates with both (mental health-cardiovascular link) These correlations reflect known biology "],["vs-risk-scores.html", "Chapter 15 Outperforming Established Risk Scores 15.1 The Benchmark Challenge 15.2 Head-to-Head Comparison 15.3 Why ALADYNOULLI Performs Better 15.4 Calibration: Predictions Match Outcomes", " Chapter 15 Outperforming Established Risk Scores 15.1 The Benchmark Challenge Clinical risk scores have been developed and validated over decades: PCE (Pooled Cohort Equations): 10-year ASCVD risk, ACC/AHA recommended QRISK3: 10-year CVD risk, UK standard PREVENT: Updated ASCVD equations (2023) GAIL: 5-year and lifetime breast cancer risk These scores use carefully selected predictors: age, sex, blood pressure, cholesterol, smoking, diabetes status. They’ve been validated in large populations and form the basis for clinical guidelines. Can ALADYNOULLI improve on these established benchmarks? 15.2 Head-to-Head Comparison We compared ALADYNOULLI to established risk scores on held-out test data using the same individuals and outcomes. 15.2.1 ASCVD Prediction (10-year) Model AUC Improvement vs PCE PCE 0.680 — QRISK3 0.695 +2.2% PREVENT 0.657 -3.4% ALADYNOULLI 0.730 +7.3% Absolute AUC improvement: +0.050 over PCE 15.2.2 Breast Cancer Prediction Model Horizon AUC Improvement GAIL 10-year 0.548 — ALADYNOULLI 10-year 0.575 +5.0% GAIL 1-year 0.549 — ALADYNOULLI 1-year 0.782 +42.4% The short-horizon improvement is striking: ALADYNOULLI captures information in recent diagnoses that GAIL cannot. 15.2.3 Across 28 Conditions Systematic comparison across 28 conditions with established or commonly-used risk models: ALADYNOULLI better: 22/28 conditions Comparable: 4/28 conditions Worse: 2/28 conditions Mean AUC improvement: +0.062 (9.1% relative) 15.3 Why ALADYNOULLI Performs Better Several factors contribute to improved prediction: 15.3.1 1. Information from Disease History Traditional scores use demographics and labs. ALADYNOULLI uses the entire diagnosis history—hundreds of binary variables encoding disease patterns. 15.3.2 2. Temporal Dynamics ALADYNOULLI models how risk evolves over time. A recent diagnosis signals current elevated risk; an old diagnosis may be less relevant. 15.3.3 3. Disease Interactions The signature framework captures how diseases predict each other. Diabetes predicts CVD not just through shared risk factors but through shared signature loading. 15.3.4 4. Genetic Information When available, polygenic risk scores provide additional predictive signal. 15.4 Calibration: Predictions Match Outcomes Good discrimination (AUC) isn’t enough—predictions must also be calibrated. We assessed calibration across the full range of predicted risks: - MSE = 4.67 × 10⁻⁷ - Mean predicted rate: 5.55 × 10⁻⁴ - Mean observed rate: 5.45 × 10⁻⁴ - N observations: 722 million patient-years The calibration curve shows predicted risks closely matching observed rates across all risk deciles. "],["dynamic-updating.html", "Chapter 16 Dynamic Risk Updating 16.1 The Value of Updating 16.2 Annual Prediction Updates 16.3 Walking the Timeline 16.4 From Past to Future 16.5 The Competing Risk Advantage", " Chapter 16 Dynamic Risk Updating 16.1 The Value of Updating Traditional risk scores give a single snapshot: “Your 10-year ASCVD risk is 15%.” But what happens when: - You’re diagnosed with hypertension? - You have an abnormal stress test? - 5 years pass without incident? ALADYNOULLI updates predictions as new information arrives. 16.2 Annual Prediction Updates We evaluated prediction improvement from annual updates: Setup: - Predict 10-year disease risk at enrollment - Repeat prediction 1 year later with updated diagnosis history - Repeat at years 2, 3, 4, 5 - Compare discrimination Results: | Update Time | Mean AUC | Improvement vs Enrollment | |————-|———-|————————–| | Enrollment | 0.698 | — | | +1 year | 0.742 | +6.3% | | +2 years | 0.771 | +10.5% | | +3 years | 0.793 | +13.6% | | +5 years | 0.821 | +17.6% | Predictions improve substantially as more data accumulates. 16.3 Walking the Timeline Consider a hypothetical patient: Age 45 (enrollment): - No diagnoses - High PRS for CVD - Predicted: θ_CV = 0.15, 10-year MI risk = 3% Age 50 (diagnosed with hypertension): - Model updates: θ_CV increases - Predicted: θ_CV = 0.25, 10-year MI risk = 7% Age 55 (diagnosed with diabetes): - Model updates: θ_CV and θ_Metabolic increase - Predicted: θ_CV = 0.40, 10-year MI risk = 15% Age 60 (no new diagnoses): - Model updates: some normalization - Predicted: θ_CV = 0.35, 10-year MI risk = 12% The trajectory responds to new information while maintaining biological plausibility through GP smoothness. 16.4 From Past to Future A key visualization: the signature trajectory over time. θ (Cardiovascular) ^ 0.5 | ● (MI occurs) | / 0.4 | / | / 0.3 | ____/ | / (Diabetes diagnosed) 0.2 | / | / (Hypertension diagnosed) 0.1 |__/ | +-------------------------&gt; Age 45 50 55 60 65 70 The model learns from the past (left of “now”) to predict the future (right of “now”). 16.5 The Competing Risk Advantage An important feature: ALADYNOULLI naturally handles competing risks. If a patient develops cancer, their cardiovascular signature trajectory is affected: - Directly: Cancer treatment may cause cardiotoxicity - Indirectly: Competing mortality risk changes interpretation Traditional models either ignore competing risks or require complex multi-state specifications. ALADYNOULLI captures these interactions through the signature structure. "],["web-app.html", "Chapter 17 The ALADYNOULLI Web Application 17.1 From Research to Clinical Tool 17.2 User Interface 17.3 Technical Architecture 17.4 Clinical Use Cases 17.5 Limitations and Appropriate Use 17.6 Future Development", " Chapter 17 The ALADYNOULLI Web Application 17.1 From Research to Clinical Tool The computational advances enabling real-time patient refitting make clinical deployment possible. The web application at https://aladynoulli.hms.harvard.edu provides: - Interactive risk visualization - Dynamic prediction updates - Signature trajectory displays - Comparison to clinical benchmarks 17.2 User Interface The application flow: Input patient data: Demographics (age, sex) Diagnosis history (ICD/phecode) Optional: Genetic data (PRS) View predictions: Disease-specific risk trajectories Signature evolution over time Comparison to population average Update with new information: Add new diagnoses See how predictions change Explore “what if” scenarios 17.3 Technical Architecture Backend: - Pre-trained population parameters (\\(\\phi\\), \\(\\gamma\\), \\(\\psi\\)) - PyTorch inference engine - REST API for predictions Frontend: - Interactive visualizations (D3.js/Plotly) - Patient input forms - Results display Performance: - Prediction latency: &lt;2 seconds - Handles concurrent users - HIPAA-compliant infrastructure 17.4 Clinical Use Cases 17.4.1 Primary Care Annual wellness visit risk assessment Identifying patients for screening Treatment decision support 17.4.2 Cardiology Comprehensive CV risk profiling Response to risk factor modification Post-event risk stratification 17.4.3 Oncology Comorbidity assessment Survivorship care planning Multi-cancer risk evaluation 17.5 Limitations and Appropriate Use The application is a decision support tool, not a replacement for clinical judgment: Predictions are probabilistic, not deterministic Model was trained on specific populations Should be used alongside, not instead of, clinical assessment Not validated for all subpopulations 17.6 Future Development Planned enhancements: - Integration with EHR systems (FHIR) - Expanded disease coverage - Treatment effect estimation - Mobile application "],["ipw.html", "Chapter 18 Selection Bias and Inverse Probability Weighting 18.1 The Healthy Volunteer Problem 18.2 Inverse Probability Weighting 18.3 Implementing IPW in ALADYNOULLI 18.4 Validation Through Simulation 18.5 Preservation of Biological Signal 18.6 Weight Distribution", " Chapter 18 Selection Bias and Inverse Probability Weighting 18.1 The Healthy Volunteer Problem UK Biobank participants are not a random sample of the UK population. They’re healthier, wealthier, and more educated than average—the “healthy volunteer” effect. This creates potential problems: - Disease prevalence underestimated - Risk factor associations biased - Predictions may not generalize 18.2 Inverse Probability Weighting Inverse probability weighting (IPW) addresses selection bias by weighting each participant inversely by their probability of participation: \\[w_i = \\frac{1}{P(\\text{participate} | X_i)}\\] Participants who are less likely to participate (underrepresented groups) receive higher weights; over-represented participants receive lower weights. 18.3 Implementing IPW in ALADYNOULLI We modified the likelihood function to incorporate IPW weights: \\[\\mathcal{L}_{\\text{weighted}} = -\\frac{1}{N}\\sum_{i=1}^{N} w_i \\sum_{d,t} \\ell_{idt}\\] where \\(w_i\\) is derived from the Schoeler et al. participation model, which predicts UK Biobank participation based on demographics and socioeconomic factors. 18.4 Validation Through Simulation We validated IPW through controlled simulation: Create biased cohort: Drop 90% of women from training data Train without IPW: Parameters biased toward male patterns Train with IPW: Weights recover full-population patterns Results: - Without IPW: Breast cancer prevalence underestimated by 85% - With IPW: Prevalence estimates recovered (within 5% of truth) 18.5 Preservation of Biological Signal A key finding: IPW adjustment preserves biological signal while correcting bias. Signature-disease associations (\\(\\phi\\)): Correlation 0.9999 with/without IPW Individual trajectories (\\(\\lambda\\), \\(\\pi\\)): Adapt to weighted population Population parameters remain interpretable This structural separation—\\(\\phi\\) captures biology, \\(\\lambda\\) captures individuals—enables principled bias correction. 18.6 Weight Distribution IPW weights show expected patterns: - Higher weights for older participants (underrepresented) - Higher weights for non-White British (underrepresented) - Higher weights for lower SES (underrepresented) - Higher weights for less healthy (underrepresented) This confirms the weights are correcting in the expected directions. "],["stratification.html", "Chapter 19 Population Stratification 19.1 Ancestry and Disease Risk 19.2 Principal Component Adjustment 19.3 Cross-Ancestry Stability 19.4 What Differs", " Chapter 19 Population Stratification 19.1 Ancestry and Disease Risk Genetic ancestry affects disease risk through: - Population-specific genetic variants - Gene-environment interactions - Healthcare access and utilization - Social determinants of health Failing to account for ancestry can confound genetic associations. 19.2 Principal Component Adjustment ALADYNOULLI incorporates ancestry through principal components (PCs) of the genetic data: \\[\\lambda_{ik}(t) \\sim \\mathcal{GP}(r_k + g_i^T \\gamma_k + \\text{PC}_i^T \\delta_k, \\Omega_\\lambda)\\] where \\(\\delta_k\\) captures PC effects on signature \\(k\\). This is standard practice in genetic epidemiology and addresses population stratification at the individual level. 19.3 Cross-Ancestry Stability We assessed signature stability across ancestry groups in UK Biobank: Comparison \\(\\phi\\) Correlation \\(\\psi\\) Correlation White British vs South Asian 0.98 0.97 White British vs Black 0.97 0.96 White British vs Mixed 0.99 0.98 Signature-disease associations are remarkably stable across ancestry groups, supporting biological (rather than confounded) interpretation. 19.4 What Differs While \\(\\phi\\) is stable, prevalence and trajectory parameters differ: - Higher cardiovascular signature values in South Asian participants - Different age-of-onset patterns across groups - Reflects real biological and environmental differences This is appropriate: the model captures ancestry-related variation in \\(\\lambda\\) while preserving shared disease structure in \\(\\phi\\). "],["temporal.html", "Chapter 20 Temporal Leakage and Washout 20.1 The Reverse Causation Concern 20.2 Washout Analysis 20.3 Temporal Leakage Analysis 20.4 Multiple Prediction Horizons", " Chapter 20 Temporal Leakage and Washout 20.1 The Reverse Causation Concern A critical concern: could early disease symptoms cause behaviors that appear as “risk factors”? Example: Undiagnosed cancer causes fatigue → patient stops exercising → appears as low physical activity “predicting” cancer This reverse causation could artificially inflate prediction performance. 20.2 Washout Analysis We tested model robustness through washout periods—excluding diagnoses near the prediction time: Washout Period AUC (CV prediction) Change None 0.730 — 1 month 0.728 -0.3% 3 months 0.724 -0.8% 6 months 0.718 -1.6% Performance remains robust even with 6-month washout, indicating predictions aren’t driven by reverse causation. 20.3 Temporal Leakage Analysis We also tested for “temporal leakage”—using information that wouldn’t be available at prediction time: Experiment: - Predict disease at time \\(T\\) - Use only data up to time \\(T-k\\) for prediction - Vary \\(k\\) from 0 to 2 years Results: - Performance degrades gradually with longer lag - Even 2-year lag maintains clinically useful discrimination - Confirms predictions use genuinely prospective information 20.4 Multiple Prediction Horizons We evaluated predictions at multiple horizons after enrollment: Horizon Mean AUC 95% CI 1 year 0.68 [0.66, 0.70] 3 years 0.71 [0.69, 0.73] 5 years 0.73 [0.71, 0.75] 10 years 0.72 [0.70, 0.74] Performance is consistent across horizons, with slight peak at medium-term predictions. "],["diagnostics.html", "Chapter 21 Model Diagnostics 21.1 Calibration Assessment 21.2 Convergence Diagnostics 21.3 Sensitivity Analysis 21.4 Leave-One-Out Validation", " Chapter 21 Model Diagnostics 21.1 Calibration Assessment Calibration measures whether predicted probabilities match observed frequencies. Full-dataset calibration: - 722 million patient-disease-time observations - Mean predicted: 5.55 × 10⁻⁴ - Mean observed: 5.45 × 10⁻⁴ - MSE: 4.67 × 10⁻⁷ By risk decile: All deciles show predicted closely matching observed rates, with no systematic over- or under-prediction. 21.2 Convergence Diagnostics Training convergence assessed through: Loss trajectory: - Monotonic decrease over epochs - Stable plateau reached - No signs of instability Gradient norms: - Decrease over training - Final gradients near zero - No exploding/vanishing gradients Parameter stability: - Final parameters stable to initialization - Multiple random seeds give similar results 21.3 Sensitivity Analysis Model robustness to hyperparameters: Hyperparameter Range Tested Sensitivity GP length scale T/6 to T/2 Low GP amplitude 0.1 to 0.5 Low Learning rate 0.001 to 0.05 Moderate Number of signatures 15 to 25 Low Results are robust to reasonable hyperparameter choices. 21.4 Leave-One-Out Validation For cross-cohort validation, we performed leave-one-out (LOO) analysis: Train on 2 biobanks Test on held-out biobank Repeat for all combinations Training Test AUC MGB + AoU UKB 0.71 UKB + AoU MGB 0.69 UKB + MGB AoU 0.70 Performance is maintained when predicting in completely held-out populations. "],["competing-risks.html", "Chapter 22 Competing Risks and Multi-State Models 22.1 Why Competing Risks Matter 22.2 How ALADYNOULLI Handles Competition 22.3 Comparison to Multi-State Models 22.4 Empirical Comparison", " Chapter 22 Competing Risks and Multi-State Models 22.1 Why Competing Risks Matter In traditional survival analysis, we often model a single outcome. But patients face multiple potential events: A patient at risk for heart disease may die of cancer first Treatment for one condition affects risk of another Death competes with all other outcomes Competing risks occur when the occurrence of one event precludes or modifies the probability of another. 22.2 How ALADYNOULLI Handles Competition The signature framework naturally captures competing risks: Shared probability mass: θ sums to 1 across signatures Cross-signature dynamics: Diagnosis in one signature affects trajectories in others All diseases modeled jointly: No need for separate competing risk specification When a patient is diagnosed with cancer (high SIG11), their cardiovascular trajectory (SIG5) is implicitly affected—not because we specified a competing risk model, but because the multivariate structure captures these dependencies. 22.3 Comparison to Multi-State Models Traditional multi-state models (like MSGene) explicitly specify states and transitions: Healthy | ┌────┴────┐ v v Risk1 Risk2 | | └────┬────┘ v Death This is elegant but requires pre-specifying the state space, which becomes combinatorially explosive with many diseases. ALADYNOULLI’s approach: - States are implicit (signature combinations) - Transitions are learned from data - Scales to hundreds of diseases 22.4 Empirical Comparison We compared ALADYNOULLI to explicit multi-state models: Model AUC (CV events) Competing risk handling Cox (ignore) 0.68 None Fine-Gray 0.70 Subdistribution hazard Multi-state 0.71 Explicit transitions ALADYNOULLI 0.73 Implicit via signatures ALADYNOULLI matches or exceeds explicit competing risk models while offering greater flexibility. "],["linear-mixing.html", "Chapter 23 Linear vs Nonlinear Mixing 23.1 The Softmax Choice 23.2 Alternative Architectures 23.3 Why Softmax Works 23.4 The Identifiability Trade-off", " Chapter 23 Linear vs Nonlinear Mixing 23.1 The Softmax Choice ALADYNOULLI uses softmax to convert latent λ to signature proportions θ: \\[\\theta_k = \\frac{\\exp(\\lambda_k)}{\\sum_{k&#39;} \\exp(\\lambda_{k&#39;})}\\] This is a specific architectural choice. Why this and not alternatives? 23.2 Alternative Architectures Direct (no transformation): \\[\\theta_k = \\lambda_k\\] Problem: No constraint that θ sums to 1 or is positive. Sigmoid (element-wise): \\[\\theta_k = \\sigma(\\lambda_k)\\] Problem: Signatures are independent, sum isn’t constrained. Dirichlet: \\[\\theta \\sim \\text{Dir}(\\alpha)\\] Problem: Doesn’t naturally incorporate continuous λ. Neural network: \\[\\theta = f_\\text{NN}(\\lambda)\\] Problem: Loss of interpretability. 23.3 Why Softmax Works Softmax has several advantages: Compositional: θ sums to 1, like mixture proportions Smooth: Gradients well-behaved for optimization Interpretable: Higher λ → higher θ, monotonically Identifiability: Relative changes are meaningful The key insight: softmax preserves relative relationships, which is the meaningful quantity for disease trajectories. 23.4 The Identifiability Trade-off Softmax implies that only relative λ values are identifiable: - Adding constant to all λ doesn’t change θ - Absolute slopes unidentifiable, relative slopes identifiable This is acceptable because: - Clinical interpretation focuses on relative shifts - “Disease profile moves toward cardiovascular” is meaningful - Absolute rates can be recovered from π (disease probabilities) "],["other-methods.html", "Chapter 24 Connections to Other Methods 24.1 Transformer-Based Models 24.2 Topic Models 24.3 Latent Factor Analysis 24.4 Deep Survival Models", " Chapter 24 Connections to Other Methods 24.1 Transformer-Based Models Delphi-2M (Google/DeepMind) uses a transformer architecture pre-trained on health records: Aspect Delphi-2M ALADYNOULLI Architecture Transformer Bayesian hierarchical Training Pre-train + fine-tune Joint optimization Interpretability Low (black box) High (signatures) Parameters Public? No Genetic integration Limited Native Performance comparison on matched phenotypes: - ALADYNOULLI better: 19/28 diseases (68%) - Comparable: 6/28 diseases (21%) - Delphi better: 3/28 diseases (11%) 24.2 Topic Models Signatures resemble topics from topic modeling (LDA): - Documents → Patients - Words → Diseases - Topics → Signatures Key differences: - ALADYNOULLI: Continuous time, temporal dynamics, censoring - LDA: Discrete documents, no temporal structure 24.3 Latent Factor Analysis The θ·φ structure resembles factor analysis: - λ → Factor scores - φ → Factor loadings - θ·φ → Reconstruction Key difference: ALADYNOULLI incorporates temporal dynamics through GPs. 24.4 Deep Survival Models Modern deep learning approaches (DeepSurv, DeepHit) use neural networks for survival prediction: Aspect Deep Survival ALADYNOULLI Flexibility High Moderate Interpretability Low High Sample efficiency Lower Higher Uncertainty Approximate Native ALADYNOULLI trades some flexibility for interpretability and principled uncertainty. "],["future.html", "Chapter 25 Future Directions 25.1 Genetic Effects on Progression Speed 25.2 Treatment Effect Estimation 25.3 Multi-Modal Integration 25.4 Real-Time Learning 25.5 Validation in Clinical Trials", " Chapter 25 Future Directions 25.1 Genetic Effects on Progression Speed A natural extension: can we identify genetic effects on disease progression rate, not just baseline risk? Model extension: \\[\\lambda_{ik}(t) \\sim \\mathcal{GP}(r_k + g_i^T \\gamma_{\\text{level}} + t \\cdot g_i^T \\gamma_{\\text{slope}}, \\Omega)\\] Preliminary results (Chapter 6 of this book) show: - Relative slope effects are identifiable (r = 0.99 correlation) - Absolute slopes confounded by softmax (only relative detectable) - Clinical interpretation preserved: “High PRS accelerates CV signature relative to others” 25.2 Treatment Effect Estimation ALADYNOULLI could be extended for causal inference: Model disease trajectories with/without treatment Use genetic instruments for confounding control Estimate treatment effects on signature trajectories Challenges: - Treatment decisions are confounded - Need IV or other identification strategies - Model assumptions must be validated 25.3 Multi-Modal Integration Current model uses: - Diagnosis codes (ICD/phecode) - Genetic data (SNPs, PRS) Potential additions: - Laboratory values: Continuous biomarkers over time - Imaging: Derived features from medical images - Notes: NLP-extracted concepts from clinical text - Wearables: Continuous physiological monitoring Each modality requires appropriate likelihood specification. 25.4 Real-Time Learning Current workflow: 1. Train population model (offline, periodic) 2. Fit individual parameters (online, per patient) Future: - Continuous learning as new data arrives - Federated learning across institutions - Privacy-preserving updates 25.5 Validation in Clinical Trials ALADYNOULLI should be prospectively validated: - Enroll patients, make predictions - Follow for outcomes - Assess discrimination, calibration, clinical utility This is the standard for moving from research to clinical implementation. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
