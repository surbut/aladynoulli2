)
# Priors for models with PREVENT interaction only
priors_prevent <- c(
prior(normal(0, 1), class = "b"),
prior(normal(0, 0.5), class = "b", coef = "mvpa_x_prevent"),
prior(student_t(3, 0, 2.5), class = "Intercept")
)
# Atrial Fibrillation
model_af_int <- brm(
time_to_af_years | cens(1 - incd_af_accel) ~
mvpa_daily_z + pce_z + mvpa_x_pce +
age_accel + sex_f + bmi +
f.22009.0.1 + f.22009.0.2 + f.22009.0.3,
data = analysis_data,
family = weibull(),
prior = priors_pce,
chains = 4,
iter = 2000,
cores = 4,
seed = 124,
control = list(adapt_delta = 0.95)
)
# Heart Failure
model_hf_int <- brm(
time_to_hf_years | cens(1 - incd_hf_accel) ~
mvpa_daily_z + prevent_z + mvpa_x_prevent +
age_accel + sex_f + bmi +
f.22009.0.1 + f.22009.0.2 + f.22009.0.3,
data = analysis_data,
family = weibull(),
prior = priors_prevent,
chains = 4,
iter = 2000,
cores = 4,
seed = 125,
control = list(adapt_delta = 0.95)
)
# Stroke
model_stroke_int <- brm(
time_to_stroke_years | cens(1 - incd_stroke_accel) ~
mvpa_daily_z + pce_z + mvpa_x_pce +
age_accel + sex_f + bmi +
f.22009.0.1 + f.22009.0.2 + f.22009.0.3,
data = analysis_data,
family = weibull(),
prior = priors_pce,
chains = 4,
iter = 2000,
cores = 4,
seed = 126,
control = list(adapt_delta = 0.95)
)
library(data.table)
prs <- fread("all_patient_genetics.csv")
head(prs)
colnames(prs)
f=fread("../UKBWeights-main/UKBSelectionWeights.csv")
head(f)
# Search current directory
list.files(pattern = "map|link|id|key", ignore.case = TRUE, recursive = TRUE)
# Check if there's documentation
list.files(pattern = "\\.txt|\\.doc|\\.pdf|\\.md", recursive = TRUE)
# Sometimes the order matches even if IDs differ - check row counts
nrow(accel_data)  # Your number
nrow(prs_data)    # 6 shown, but what's the full count?
library(data.table)
prs <- fread("all_patient_genetics.csv")
head(prs)
colnames(prs)
prs_data=prs
# Search current directory
list.files(pattern = "map|link|id|key", ignore.case = TRUE, recursive = TRUE)
# Check if there's documentation
list.files(pattern = "\\.txt|\\.doc|\\.pdf|\\.md", recursive = TRUE)
# Sometimes the order matches even if IDs differ - check row counts
nrow(accel_data)  # Your number
nrow(prs_data)    # 6 shown, but what's the full count?
head(prs)
pid=fread("~/aladynoulli2/pyScripts/processed_ids.csv")
head(pid)
dim(pid)
prs$PatientID=pid$eid
head(prs)
write.csv(prs,"all_patient_genetics.csv",row.names = FALSE,qout)
write.csv(prs,"all_patient_genetics.csv",row.names = FALSE,quote = FALSE)
head(prs)
head(data)
head(data2)
library(tidyverse)
library(brms)
library(bayesplot)
library(tidybayes)
library(patchwork)
library(survival)
library(gt)
library(gtsummary)
library(ggdist)
library(data.table)
# Fast Bayesian options
options(brms.backend = "cmdstanr",  # Much faster than rstan
mc.cores = parallel::detectCores() - 1)
theme_set(theme_minimal(base_size = 12) +
theme(legend.position = "bottom"))
# Load accelerometer data
accel_data <- fread("complete_time_sed_with_all_activities_secondary_vars_090424.csv") %>%
mutate(sample_id = as.character(sample_id))
# Load risk scores
risk_scores <- fread("ukb_pce_prevent_scores.csv") %>%
mutate(eid = as.character(eid))
# Load genetic PCs
baseline <- readRDS("baseline_withPCS.rds") %>%
rename(sample_id = identifier) %>%
mutate(sample_id = as.character(sample_id)) %>%
select(sample_id, starts_with("f.22009"))
# Load PRS data (now with mapped sample_ids!)
prs_data <- fread("all_patient_genetics.csv") %>%
mutate(sample_id = as.character(PatientID)) %>%
select(sample_id, CAD, CVD, AF, HF = HT, T2D, BMI,
stroke = AST, HDL, LDL_SF)  # Select relevant PRS
# Merge all datasets
merged_data <- accel_data %>%
left_join(risk_scores, by = c("sample_id" = "eid")) %>%
left_join(baseline, by = "sample_id") %>%
left_join(prs_data, by = "sample_id")
cat("Total merged records:", nrow(merged_data), "\n")
cat("Records with PRS:", sum(!is.na(merged_data$CAD)), "\n")
cat("Records with risk scores:", sum(!is.na(merged_data$pce)), "\n")
# Create optimized analysis dataset
analysis_data <- merged_data %>%
# Filter for complete data
filter(!is.na(pce), !is.na(prevent_base_ascvd_risk)) %>%
filter(!is.na(CAD), !is.na(CVD)) %>%  # Require PRS
filter(!is.na(f.22009.0.1), !is.na(f.22009.0.2), !is.na(f.22009.0.3)) %>%
filter(time_accel_to_mi > 0, time_accel_to_af > 0,
time_accel_to_hf > 0, time_accel_to_stroke > 0) %>%
mutate(
# Time variables (already in years)
time_to_mi_years = time_accel_to_mi,
time_to_af_years = time_accel_to_af,
time_to_hf_years = time_accel_to_hf,
time_to_stroke_years = time_accel_to_stroke,
# Standardize accelerometer metrics
mvpa_z = scale(mvpa_daily_total)[,1],
sed_z = scale(sed_daily_total)[,1],
# Standardize clinical risk scores
pce_z = scale(pce)[,1],
prevent_z = scale(prevent_base_ascvd_risk)[,1],
risk_combined = (scale(pce)[,1] + scale(prevent_base_ascvd_risk)[,1]) / sqrt(2),
# Standardize PRS (already z-scores, but re-standardize in this cohort)
prs_cad_z = scale(CAD)[,1],
prs_cvd_z = scale(CVD)[,1],
prs_af_z = scale(AF)[,1],
prs_hf_z = scale(HF)[,1],
prs_stroke_z = scale(stroke)[,1],
prs_t2d_z = scale(T2D)[,1],
# Combined genetic risk for CVD outcomes
prs_cvd_combined = (scale(CAD)[,1] + scale(CVD)[,1]) / sqrt(2),
# Interaction terms: Activity × Risk
mvpa_x_pce = mvpa_z * pce_z,
mvpa_x_prevent = mvpa_z * prevent_z,
mvpa_x_prs_cad = mvpa_z * prs_cad_z,
mvpa_x_prs_cvd = mvpa_z * prs_cvd_z,
mvpa_x_prs_af = mvpa_z * prs_af_z,
# Combined risk interaction
mvpa_x_risk_comb = mvpa_z * risk_combined,
mvpa_x_prs_comb = mvpa_z * prs_cvd_combined,
# Covariates (standardized)
age_z = scale(age_accel)[,1],
bmi_z = scale(bmi)[,1],
pc1 = scale(f.22009.0.1)[,1],
pc2 = scale(f.22009.0.2)[,1],
pc3 = scale(f.22009.0.3)[,1],
sex = factor(sex, levels = c("Female", "Male")),
# Risk categories for visualization
prs_cad_tertile = cut(prs_cad_z,
breaks = quantile(prs_cad_z, c(0, 0.33, 0.67, 1)),
labels = c("Low PRS", "Medium PRS", "High PRS")),
pce_tertile = cut(pce_z,
breaks = quantile(pce_z, c(0, 0.33, 0.67, 1)),
labels = c("Low PCE", "Medium PCE", "High PCE"))
)
cat("\n=== FINAL ANALYSIS DATASET ===\n")
cat("Participants:", nrow(analysis_data), "\n")
cat("MI events:", sum(analysis_data$incd_mi_accel), "\n")
cat("AF events:", sum(analysis_data$incd_af_accel), "\n")
cat("HF events:", sum(analysis_data$incd_hf_accel), "\n")
cat("Stroke events:", sum(analysis_data$incd_stroke_accel), "\n")
cat("Mean follow-up:", round(mean(analysis_data$time_to_mi_years), 1), "years\n")
analysis_data %>%
select(age_accel, sex, bmi, mvpa_daily_total, sed_daily_total,
pce, prevent_base_ascvd_risk,
CAD, CVD, AF, T2D,
incd_mi_accel, incd_af_accel, incd_hf_accel, incd_stroke_accel) %>%
tbl_summary(
statistic = list(
all_continuous() ~ "{mean} ({sd})",
all_categorical() ~ "{n} ({p}%)"
),
label = list(
age_accel ~ "Age (years)",
sex ~ "Sex",
bmi ~ "BMI (kg/m²)",
mvpa_daily_total ~ "Daily MVPA (min)",
sed_daily_total ~ "Daily sedentary time (min)",
pce ~ "PCE Score",
prevent_base_ascvd_risk ~ "PREVENT Score",
CAD ~ "CAD PRS",
CVD ~ "CVD PRS",
AF ~ "AF PRS",
T2D ~ "T2D PRS",
incd_mi_accel ~ "Incident MI",
incd_af_accel ~ "Incident AF",
incd_hf_accel ~ "Incident HF",
incd_stroke_accel ~ "Incident Stroke"
)
) %>%
bold_labels() %>%
modify_caption("**Table 1. Cohort Characteristics with Polygenic Risk Scores**")
p1 <- ggplot(analysis_data, aes(x = pce)) +
geom_histogram(fill = "coral", alpha = 0.7, bins = 50) +
geom_vline(xintercept = c(0.075, 0.20), linetype = "dashed") +
labs(title = "PCE Score", x = "PCE", y = "Count")
p2 <- ggplot(analysis_data, aes(x = CAD)) +
geom_histogram(fill = "steelblue", alpha = 0.7, bins = 50) +
labs(title = "CAD Polygenic Risk Score", x = "CAD PRS", y = "Count")
p3 <- ggplot(analysis_data, aes(x = mvpa_daily_total)) +
geom_histogram(fill = "forestgreen", alpha = 0.7, bins = 50) +
labs(title = "Daily MVPA", x = "Minutes", y = "Count")
p4 <- ggplot(analysis_data, aes(x = pce_z, y = prs_cad_z)) +
geom_point(alpha = 0.2, size = 0.5) +
geom_smooth(method = "lm", color = "red") +
labs(title = "Clinical vs Genetic Risk",
x = "PCE Score (standardized)",
y = "CAD PRS (standardized)")
(p1 + p2) / (p3 + p4)
p1 <- ggplot(analysis_data, aes(x = pce_tertile, y = mvpa_daily_total, fill = pce_tertile)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Reds") +
labs(title = "MVPA by Clinical Risk (PCE)",
x = "PCE Tertile", y = "Daily MVPA (min)") +
theme(legend.position = "none")
p2 <- ggplot(analysis_data, aes(x = prs_cad_tertile, y = mvpa_daily_total, fill = prs_cad_tertile)) +
geom_boxplot(alpha = 0.7) +
scale_fill_brewer(palette = "Blues") +
labs(title = "MVPA by Genetic Risk (CAD PRS)",
x = "CAD PRS Tertile", y = "Daily MVPA (min)") +
theme(legend.position = "none")
p1 + p2
# Priors
priors_vb <- c(
prior(normal(0, 1), class = "b"),
prior(normal(0, 0.5), class = "b", coef = "mvpa_x_pce"),
prior(normal(0, 0.5), class = "b", coef = "mvpa_x_prs_cad_z"),
prior(student_t(3, 0, 2.5), class = "Intercept")
)
cat("Fitting variational Bayes model (fast!)...\n")
system.time({
model_vb_mi <- brm(
time_to_mi_years | cens(1 - incd_mi_accel) ~
mvpa_z + pce_z + prs_cad_z +
mvpa_x_pce + mvpa_x_prs_cad_z +
sed_z + age_z + sex + bmi_z +
pc1 + pc2 + pc3,
data = analysis_data,
family = weibull(),
prior = priors_vb,
algorithm = "meanfield",
seed = 123
)
})
head(analysis_data)
names(analysis_data)
head(prs)
install.packages("cmdstanr'")
install.packages("cmdstanr")
install.packages("cmdstanr")
install.packages("cmdstanr")
install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))
cmdstanr::install_cmdstan()
setwd("~/Library/CloudStorage/Dropbox-PartnersHealthCare/NatarajanLab/MGBB/Historical Identified Data Requests/MGBB_2025_Jan/With Genomic Data/swc51_012425100138280571_6387333529057527351-1_Med.txt")
setwd("~/Library/CloudStorage/Dropbox-PartnersHealthCare/NatarajanLab/MGBB/Historical Identified Data Requests/MGBB_2025_Jan/With Genomic Data/")
df=fread("swc51_012425100138280571_6387333529057527351-1_Med.txt")
head(df)
dim(df)
length(unique(df$Medication)
)
length(unique(df$Medication))
readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal (9-23-25 4:48 PM)/mgbbtopic/merged_demo_diag.rds")
d=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal (9-23-25 4:48 PM)/mgbbtopic/merged_demo_diag.rds")
dim(d)
d=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal (9-23-25 4:48 PM)/mgbbtopic/E_for_py.rds")
head(d)
dim(d)
dim(df[df$EMPI%in%rownames(d),])
length(unique(df[df$EMPI%in%rownames(d),EMPI])
)
length(unique(df[df$EMPI%in%rownames(d),EMPI]))
write.table(rownames(d),"~/Library/CloudStorage/Dropbox-Personal/mgbnames.csv")
setwd("~/Library/CloudStorage/Dropbox-PartnersHealthCare/NatarajanLab/MGBB/Historical Identified Data Requests/MGBB_2025_Jan/With Genomic Data/")
df=fread("swc51_012425100138280571_6387333529057527351-1_Med.txt")
df2=fread("swc51_012425100138280571_6387333529057527351-3_Med.txt")
df2=fread("swc51_012425100138280571_6387333529057527352-2_Med.txt")
df23=fread("swc51_012425100138280571_6387333529057527353-3_Med.txt")
d5=rbind(df1,df2)
d5=rbind(df23,(df,df2))
d5=rbind(df23,rbind(df,df2))
)
dim(d5)
gooddf=df[d5$EMPI%in%rownames(d),]
dim(d)
gooddf=d5[d5$EMPI%in%rownames(d),]
dim(gooddf)
length(unique(gooddf$EMPI))
write.table(gooddf,"~/Dropbox-Personal/medsformgbtopic.rds"
write.table(gooddf,"~/Dropbox-Personal/medsformgbtopic.csv",quote=FALSE,row.names = FALSE)
length(unique(gooddf$Medication))
library(dplyr)
gooddf%>%group_by(Medication)%>%summarise(num=length(EMPI))
a=gooddf%>%group_by(Medication)%>%summarise(num=length(EMPI))
a[sort(a$num,decreasing = T),]
head(a)
head(a)
sort(a$num,decreasing = T)
a[sort(a$num,decreasing = T),]
tail(a[sort(a$num,decreasing = T),])
a=na.omit(a)
tail(a[sort(a$num,decreasing = T),])
dim(a)
dim(gooddf)
print(a,n=100)
a=a[order(a$num,decreasing = T),]
dim(a)
head(a)
print(a,n=100)
gp_scripts=fread("~/Library/CloudStorage/Dropbox-Personal/gp_scripts.txt")
ukb=gp_scripts%>%group_by(drug_name)%>%summarise(num=length(eid))
ukb=ukb[order(ukb$num,decreasing = T),]
head(ukb)
print(ukb,n=100)
dim(d5)
grep(x = d5$Medication,pattern = "Romo")
head(df5)
head(d5)
a=gooddf[gooddf$Inpatient_Outpatient=="Outpatient",]%>%group_by(Medication)%>%summarise(num=length(EMPI))
dim(a)
inpt=gooddf[gooddf$Inpatient_Outpatient=="Inpatient",]%>%group_by(Medication)%>%summarise(num=length(EMPI))
dim(inpt)
head(a)
outpt_ordered_mgb=a[order(a$num,decreasing = T),]
head(outpt_ordered_mgb)
tail(outpt_ordered_mgb)
inpt_ordered_mgb=inpt[order(inpt$num,decreasing = T),]
head(inpt_ordered_mgb)
tail(inpt_ordered_mgb)
head(gooddf)
head(gooddf[gooddf$Inpatient_Outpatient=="Outpatient",])
head(gooddf[gooddf$Inpatient_Outpatient=="Inpatient",])
head(gooddf[gooddf$Inpatient_Outpatient=="Inpatient",])
print(inpt_ordered_mgb)
print(inpt_ordered_mgb)
print(outpt_ordered_mgb)
summary(as.factor(gooddf$Code_Type))
summary(as.factor(gooddf$Clinic))
dim(gooddf)
length(unique(gooddf$EMPI))
E=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal (9-23-25 4:48 PM)/mgbbtopic/E_for_py.rds")
head(E)
dim(E)
E=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/Y_sub.rds")
Y=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/Y_sub.rds")
dim(Y)
E=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/e_sub.rds.rds")
E=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds")
dim(E)
E=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/e_sub.rds")
dim(E)
g=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/G_sub.rdsrds")
g=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/mgbbtopic/G_sub.rds")
dim(g)
write.table(rownames(g),"~/Library/CloudStorage/Dropbox-Personal/mgbnames.csv")
dim(d5)
mgb_scripts=df[df$EMPI%in%rownames(g),]
dim(mgb_scripts)
mgb_scripts=d5[d5$EMPI%in%rownames(g),]
head(mgb_scripts)
mgb_scripts=d5[d5$EMPI%in%rownames(g),]
head(mgb_scripts)
head(d5)
mgb_scripts=d5[d5$EMPI%in%rownames(E),]
head(mgb_scripts)
summary(as.factor(mgb_scripts$Clinic))
mgb_scripts=mgb_scripts[!mgb_scripts%in%not_r]
mgb_scripts=mgb_scripts[!mgb_scripts%in%"not recorded",]
head(prs)
write.table(prs,"~/aladynoulli2/pyScripts/prs_with_eid.csv",quote = FALSE,row.names = FALSE)
dim(prs)
r=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/UKBWeights-main/FILES/CVLassoProbitVarSet4.rds")
head(r)
str(r)
head(prs)
write.csv(prs,"~/aladynoulli2/pyScripts/prs_with_eid.csv",quote = FALSE,row.names = FALSE)
library(atm)
library(ATM)
devtools::install_github("Xilin-Jiang/ATM")
library(ATM)
library(AgeTopicModels)
AgeTopicModels::short_icd10cm
dim(AgeTopicModels::short_icd10cm)
dim(AgeTopicModels::phecode_icd10)
dim(AgeTopicModels::phecode_icd10cm)
head(AgeTopicModels::phecode_icd10cm)
?AgeTopicModels::phecode_icd10cm
?AgeTopicModels::phecode_icd10
dim(AgeTopicModels::phecode_icd10cm)
?AgeTopicModels::phecode_icd10
?AgeTopicModels::short_icd10cm
AgeTopicModels::disease_info_phecode_icd10
dim(AgeTopicModels::disease_info_phecode_icd10)
write.table(AgeTopicModels::disease_info_phecode_icd10,"~/aladynoulli2/detailed_icdtophe.txt",quote = FALSE,row.names = FALSE)
write.csv(AgeTopicModels::disease_info_phecode_icd10,"~/aladynoulli2/detailed_icdtophe.txt",quote = FALSE,row.names = FALSE)
write.csv(AgeTopicModels::disease_info_phecode_icd10,"~/aladynoulli2/detailed_icdtophe.csv",quote = FALSE,row.names = FALSE)
head(detailed_icdtophe)
d=AgeTopicModels::disease_info_phecode_icd10
summary(d$phenotype)
summary(as.factor(d$phenotype))
summary(as.factor(d$exclude_name))
as.factor(d$exclude_name)
print(as.factor(d$exclude_name))
tail(d)
head(short_icd10)
head(short_icd10cm)
icdlab=readRDS("/Users/sarahurbut/Library/CloudStorage/Dropbox-Personal/icd2phecode.rds")
head(icdlab)
length(unique(icdlab))
length(unique(icdlab$diag_icd10))
length(unique(d$ICD10))
m=merge(icdlab,d,by.x="diag_icd10",by.y="ICD10")
dim(m)
length(unique(m$diag_icd10))
head()
head(m)
m$phenotype
head(m)
length(unique(m$phecode))
length(unique(m$diag_icd10))
saveRDS(m,"~/Dropbox-Personal/icd2phecode_mergedwithdetailedphecode.rds")
head(m)
mean(m$diag_icd10%in%d$ICD10)
m$diag_icd10%in%"I21"
sum(m$diag_icd10%in%"I21")
sum(m$diag_icd10%in%"I213")
grep(x=m$diag_icd10,pattern="I21")
grep(x=m$diag_icd10,pattern="I23")
m[grep(x=m$diag_icd10,pattern="I23"),]
m[grep(x=m$diag_icd10,pattern="I22"),]
m[grep(x=m$diag_icd10,pattern="I20"),]
m[grep(x=m$diag_icd10,pattern="I24"),]
ls()
icdlab[grep(x=icdlab$diag_icd10,pattern="I21"),]
m[grep(x=m$diag_icd10,pattern="I21"),]
d[grep(x=d$ICD10,pattern="I21"),]
AgeTopicModels::UKB_349_disease
head(D)
head(d)
levels(as.factor(d$exclude_name))
head(m)
dim(m[grep(x=m$diag_icd10,pattern="I24"),])
dim(d)
head(icd)
head(icdlab)
dim(icdlab)
length(unique(icdlab$eid))
icdlab%>%group_by(eid)%>%summarize(length(unique(diag_icd10)),length(diag_icd10),min(age_diag))
idf=icdlab%>%group_by(eid)%>%summarize(length(unique(diag_icd10)),length(diag_icd10),min(age_diag))
hist(idf$`min(age_diag)`)
hist(round(as.numeric(idf$`min(age_diag)`))
)
hist(round(as.numeric(idf$`length(diag_icd10)`)))
hist(round(as.numeric(idf$`length(diag_icd10)`)),nclass = 1000)
boxplot(round(as.numeric(idf$`length(diag_icd10)`)))
hist(round(as.numeric(idf$`length(diag_icd10)`)),nclass = 1000)
summary(round(as.numeric(idf$`length(diag_icd10)`)))
summary(round(as.numeric(idf$`length(unique(diag_icd10))`)))
icdlab_abbrev=readRDS("~/Library/CloudStorage/Dropbox-Personal/icd10phe_lab.rds")
idfshort=icdlab_abbrev%>%group_by(eid)%>%summarize(length(unique(diag_icd10)),length(diag_icd10),min(age_diag))
summary(idfshort$`min(age_diag)`)
summary(idfshort$`length(unique(diag_icd10))`
)
summary(idfshort$`length(diag_icd10)`)
head(icdlab)
unique(icdlab$diag_icd10)
length(unique(icdlab$diag_icd10))
length(unique(icdlab_abbrev$diag_icd10))
head(icdlab)
head(icdlab_abbrev)
dim(idfshort)
length(idfshort)
dim(idfshort)
head(idfshort)
head(pid)
length(pid)
length(pid$eid)
m2=merge(pid,idfshort,by.x="eid",all.x = TRUE,sort=FALSE)
m2=merge(pid,idfshort,by="eid",all.x = TRUE,sort=FALSE)
dim(m2)
head(m2)
colnames(m2)=c("eid","unique_codes","total_codes","min_diag")
head(m2)
write.csv(m2,"~/aladynoulli2/icd_code_data.csv")
write.csv(m2,"~/aladynoulli2/icd_code_data.csv",quote = FALSE,row.names = FALSE)
setwd("~/aladynoulli2/pyScripts/new_oct_revision/output_10yr")
source("~/Library/CloudStorage/Dropbox-Personal/UKBWeights-main/runningviasulizingweights.R")
