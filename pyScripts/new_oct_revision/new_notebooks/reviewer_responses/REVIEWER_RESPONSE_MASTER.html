<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aladynoulli: Reviewer Response Document</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
        }
        h3 {
            color: #7f8c8d;
        }
        .question {
            background-color: #ecf0f1;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
        }
        .response {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 4px solid #27ae60;
            margin: 20px 0;
        }
        .findings {
            background-color: #fff9e6;
            padding: 15px;
            border-left: 4px solid #f39c12;
            margin: 20px 0;
        }
        .notebook-link {
            color: #3498db;
            text-decoration: none;
        }
        .notebook-link:hover {
            text-decoration: underline;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <h1>Aladynoulli: Reviewer Response Document</h1>
    <p><em>Generated: November 27, 2025</em></p>
    
    <h2>Table of Contents</h2>
    <ul>
        <li><a href="#R1_Q1_Selection_Bias">R1_Q1_Selection_Bias</a></li>
        <li><a href="#R1_Q3_Clinical_Meaning">R1_Q3_Clinical_Meaning</a></li>
        <li><a href="#R1_Q7_Heritability">R1_Q7_Heritability</a></li>
        <li><a href="#R2_Temporal_Leakage">R2_Temporal_Leakage</a></li>
        <li><a href="#R3_Q8_Heterogeneity">R3_Q8_Heterogeneity</a></li>
    </ul>
    
    <hr>

    <section id="R1_Q1_Selection_Bias">
        <h2>R1 Q1 Selection Bias</h2>
        
        <div class="question">
            <h3>Reviewer Question</h3>
            <p>## Reviewer Question</p>
        </div>
        
        <div class="response">
            <h3>Our Response</h3>
            <p>We address selection bias through multiple complementary approaches: (1) **Inverse Probability Weighting**: We applied Lasso-derived participation weights to rebalance the UK Biobank sample. The weighted model shows minimal impact on signature structure (mean difference <0.002), demonstrating robustness to selection bias. (2) **Cross-Cohort Validation**: Signature consistency across UKB, MGB, and AoU (79% concordance) suggests robustness to different selection biases. (3) **Population Prevalence Comparison**: Our cohort prevalence aligns within 1-2% of ONS/NHS statistics, validating representativeness.</p>
        </div>
        
        <div class="findings">
            <h3>Key Findings</h3>
            <div># R1 Q1: Selection Bias / Socioeconomic Bias

## Reviewer Question

**Referee #1, Question 1**: "EHR data coming from one health care provider are typically highly biased in terms of the socio-economic background of the patients. Similarly, UKBB has a well-documented bias towards healthy upper socioeconomic participants. How do these selection processes affect the models and their predictive ability?"

## Why This Matters

Selection bias can affect:
- Generalizability of findings to broader populations
- Model calibration and prediction accuracy
- Interpretation of disease signatures and trajectories

## Our Approach

We address selection bias through **three complementary approaches**:

1. **Inverse Probability Weighting (IPW)**: Weight participants to match population demographics
2. **Cross-Cohort Validation**: Compare signatures across UKB, MGB, and AoU (different selection biases)
3. **Population Prevalence Comparison**: Compare cohort prevalence with ONS/NHS statistics

---

## Key Findings

✅ **IPW shows minimal impact on signature structure** (mean difference <0.002)  
✅ **Cross-cohort signature consistency** (79% concordance)  
✅ **Population prevalence aligns** with ONS/NHS (within 1-2%)

---

## 3. Summary & Response Text

### Key Findings

1. **IPW rebalances sample** toward under-represented groups (older, less healthy, non-White British)
2. **Minimal impact on signatures**: Mean phi difference <0.002, correlation >0.999
3. **Model robustness**: Signatures remain stable despite reweighting

### Response to Reviewer

> "We address selection bias through multiple complementary approaches: (1) **Inverse Probability Weighting**: We applied Lasso-derived participation weights to rebalance the UK Biobank sample. The weighted model shows minimal impact on signature structure (mean difference <0.002), demonstrating robustness to selection bias. (2) **Cross-Cohort Validation**: Signature consistency across UKB, MGB, and AoU (79% concordance) suggests robustness to different selection biases. (3) **Population Prevalence Comparison**: Our cohort prevalence aligns within 1-2% of ONS/NHS statistics, validating representativeness."

### References

- Model training: `pyScripts_forPublish/aladynoulli_fit_for_understanding_and_discovery_withweights.ipynb`
- Weighted implementation: `pyScripts_forPublish/weighted_aladyn.py`
- Population weighting: `UKBWeights-main/runningviasulizingweights.R`
</div>
        </div>
        
        <p><a href="notebooks/R1_Q1_Selection_Bias.ipynb" class="notebook-link">→ Open interactive notebook</a></p>
        
        <hr>
    </section>

    <section id="R1_Q3_Clinical_Meaning">
        <h2>R1 Q3 Clinical Meaning</h2>
        
        <div class="question">
            <h3>Reviewer Question</h3>
            <p>## Reviewer Question</p>
        </div>
        
        <div class="response">
            <h3>Our Response</h3>
            <p>We demonstrate clinical and biological meaningfulness through multiple lines of evidence: (1) **Genetic Pathway Validation**: Familial Hypercholesterolemia (FH) carriers show 2.3× enrichment of Signature 5 (cardiovascular signature) rise before ASCVD events (OR=2.3, p<0.001), validating the LDL/cholesterol → cardiovascular disease pathway. (2) **CHIP Mutation Analysis**: Clonal hematopoiesis mutations (DNMT3A, TET2) show enrichment of inflammatory signatures before hematologic events, demonstrating capture of somatic mutation pathways. (3) **Pathway Heterogeneity**: We identify 4 distinct biological pathways to myocardial infarction (metabolic, inflammatory, progressive ischemia, hidden risk), showing that signatures capture biological diversity within clinical diagnoses.</p>
        </div>
        
        <div class="findings">
            <h3>Key Findings</h3>
            <div># R1 Q3: Clinical/Biological Meaningfulness

## Reviewer Question

**Referee #1, Question 3**: "The authors say in several places that the models describe clinically meaningful biological processes without giving any proof of the clinical and certainly not biological meaningfulness."

## Why This Matters

Demonstrating clinical and biological meaningfulness is critical for:
- Validating that signatures capture real biological pathways
- Ensuring model interpretability for clinical translation
- Building trust that predictions reflect underlying biology

## Our Approach

We demonstrate clinical meaningfulness through **biological pathway validation**:

1. **FH Carrier Analysis**: Familial Hypercholesterolemia carriers show Signature 5 enrichment before ASCVD events
2. **CHIP Analysis**: Clonal hematopoiesis mutations (DNMT3A, TET2) show inflammatory signature enrichment
3. **Pathway Analysis**: Identifies distinct biological pathways to the same disease

---

## Key Findings

✅ **FH carriers show 2.3× enrichment** of Signature 5 rise before ASCVD events (p<0.001)  
✅ **Validates LDL/cholesterol pathway** → cardiovascular disease  
✅ **CHIP mutations show inflammatory signature enrichment** before hematologic events

---

## 2. Summary & Response Text

### Key Findings

1. **FH carriers show 2.3× enrichment** of Signature 5 rise before ASCVD events
2. **Validates biological pathway**: LDL/cholesterol → cardiovascular disease
3. **Demonstrates clinical meaningfulness**: Signatures capture known genetic risk pathways

### Response to Reviewer

> "We demonstrate clinical and biological meaningfulness through multiple lines of evidence: (1) **Genetic Pathway Validation**: Familial Hypercholesterolemia (FH) carriers show 2.3× enrichment of Signature 5 (cardiovascular signature) rise before ASCVD events (OR=2.3, p<0.001), validating the LDL/cholesterol → cardiovascular disease pathway. (2) **CHIP Mutation Analysis**: Clonal hematopoiesis mutations (DNMT3A, TET2) show enrichment of inflammatory signatures before hematologic events, demonstrating capture of somatic mutation pathways. (3) **Pathway Heterogeneity**: We identify 4 distinct biological pathways to myocardial infarction (metabolic, inflammatory, progressive ischemia, hidden risk), showing that signatures capture biological diversity within clinical diagnoses."

### References

- FH analysis: `analyze_fh_carriers_signature.py`
- CHIP analysis: `analyze_chip_carriers_signature.py`
- Pathway analysis: `heterogeneity_analysis_summary.ipynb`
</div>
        </div>
        
        <p><a href="notebooks/R1_Q3_Clinical_Meaning.ipynb" class="notebook-link">→ Open interactive notebook</a></p>
        
        <hr>
    </section>

    <section id="R1_Q7_Heritability">
        <h2>R1 Q7 Heritability</h2>
        
        <div class="question">
            <h3>Reviewer Question</h3>
            <p>## Reviewer Question</p>
        </div>
        
        <div class="response">
            <h3>Our Response</h3>
            <p>We report LDSC heritability estimates for all signatures. Signature 5 (cardiovascular) shows h² = 0.0033 ± 0.0013, which is low compared to direct CVD heritability (h² ≈ 0.03-0.05 for component traits). This is expected because signatures are composite measures combining multiple diseases. The low signature heritability reflects the composite nature rather than lack of genetic signal—component diseases retain appreciable heritability. Signature 5's attenuation ratio of 0.43 indicates that ~43% of observed inflation is explained by baseline burden/confounding, consistent with its role as a composite cardiovascular risk signature.</p>
        </div>
        
        <div class="findings">
            <h3>Key Findings</h3>
            <div># R1 Q7: Heritability Estimates

## Reviewer Question

**Referee #1, Question 7**: "The heritability estimates on lines 294-296 seem very low. How do they compare with direct CVD and other diagnoses?"

## Why This Matters

Heritability estimates validate:
- Whether signatures capture genetic signal
- Comparison with known disease heritabilities
- Understanding of genetic vs. environmental contributions

## Our Approach

We report LDSC (Linkage Disequilibrium Score Regression) heritability estimates for:
1. **Signature-level heritabilities**: All 21 signatures
2. **Trait-level heritabilities**: Component diseases (MI, CAD, etc.)
3. **Comparison**: Signature 5 vs. direct CVD heritability

---

## Key Findings

✅ **Signature 5 h² = 0.0033 ± 0.0013** (low, as expected for composite signature)  
✅ **Component CVD traits show h² ≈ 0.03-0.05** (aligned with literature)  
✅ **Low signature heritability reflects composite nature**, not lack of genetic signal

---

## Summary & Response Text

### Key Findings

1. **Signature 5 h² = 0.0033 ± 0.0013**: Low heritability reflects composite nature (multiple diseases)
2. **Component CVD traits**: Show h² ≈ 0.03-0.05, aligned with literature expectations
3. **Attenuation ratio ≈ 0.43**: Indicates ~43% of inflation explained by intercept (baseline burden)

### Response to Reviewer

> "We report LDSC heritability estimates for all signatures. Signature 5 (cardiovascular) shows h² = 0.0033 ± 0.0013, which is low compared to direct CVD heritability (h² ≈ 0.03-0.05 for component traits). This is expected because signatures are composite measures combining multiple diseases. The low signature heritability reflects the composite nature rather than lack of genetic signal—component diseases retain appreciable heritability. Signature 5's attenuation ratio of 0.43 indicates that ~43% of observed inflation is explained by baseline burden/confounding, consistent with its role as a composite cardiovascular risk signature."

### References

- LDSC results: `ldsc_summary.tsv` (signatures), `ldsc_summary_bytrait.tsv` (component diseases)
</div>
        </div>
        
        <p><a href="notebooks/R1_Q7_Heritability.ipynb" class="notebook-link">→ Open interactive notebook</a></p>
        
        <hr>
    </section>

    <section id="R2_Temporal_Leakage">
        <h2>R2 Temporal Leakage</h2>
        
        <div class="question">
            <h3>Reviewer Question</h3>
            <p>## Reviewer Question</p>
        </div>
        
        <div class="response">
            <h3>Our Response</h3>
            <p>We acknowledge the concern about temporal accuracy of ICD codes. To address potential leakage from diagnostic cascades, we implemented washout window analyses (0yr, 1yr, 2yr). Results show minimal performance degradation with 1-year washout (mean AUC drop <2%), suggesting that our predictions are not primarily driven by diagnostic procedures. For example, ASCVD AUC remains >0.89 with 1-year washout, compared to 0.89 with 0-year washout. This indicates that while ICD code dates may not be perfectly accurate, our model's predictive performance is robust to temporal uncertainty and does not rely heavily on diagnostic cascades.</p>
        </div>
        
        <div class="findings">
            <h3>Key Findings</h3>
            <div># R2: Temporal Accuracy / Leakage

## Reviewer Question

**Referee #2**: "The authors claim on pg 13 to use a 'leakage-free validation strategy' by evaluating model performance at 30 timepoints. While this 'landmark methodology' is nice and really clean from a methods standpoint, it relies on an assumption that the ICD codes are temporally accurate. This assumption is very shaky. Indeed, we know that the first date of diagnosis for an ICD code can be much later than the actual date of diagnosis, in part due to EHR fragmentation and/or missing information."

## Why This Matters

Temporal leakage can:
- Artificially inflate prediction performance
- Make models appear more accurate than they are in practice
- Lead to incorrect clinical conclusions

## Our Approach

We address temporal leakage through **washout window analyses**:

1. **Washout Windows**: Exclude events within 0, 1, and 2 years before prediction
2. **Performance Comparison**: Compare AUCs with and without washout
3. **Minimal Performance Drop**: <2% AUC reduction with 1-year washout suggests minimal leakage

---

## Key Findings

✅ **1-year washout shows <2% AUC drop** (minimal leakage)  
✅ **Performance remains robust** across washout windows  
✅ **Model predictions are not driven by diagnostic cascades**

---

## Summary & Response Text

### Key Findings

1. **Minimal performance drop**: 1-year washout shows <2% AUC reduction
2. **Robust predictions**: Performance remains strong across washout windows
3. **No diagnostic cascade effect**: Model predictions are not driven by diagnostic procedures

### Response to Reviewer

> "We acknowledge the concern about temporal accuracy of ICD codes. To address potential leakage from diagnostic cascades, we implemented washout window analyses (0yr, 1yr, 2yr). Results show minimal performance degradation with 1-year washout (mean AUC drop <2%), suggesting that our predictions are not primarily driven by diagnostic procedures. For example, ASCVD AUC remains >0.89 with 1-year washout, compared to 0.89 with 0-year washout. This indicates that while ICD code dates may not be perfectly accurate, our model's predictive performance is robust to temporal uncertainty and does not rely heavily on diagnostic cascades."

### References

- Washout analysis: `generate_washout_predictions.py`
- Comparison: `compare_age_offset_washout.py`
- Results: `results/washout/pooled_retrospective/`
</div>
        </div>
        
        <p><a href="notebooks/R2_Temporal_Leakage.ipynb" class="notebook-link">→ Open interactive notebook</a></p>
        
        <hr>
    </section>

    <section id="R3_Q8_Heterogeneity">
        <h2>R3 Q8 Heterogeneity</h2>
        
        <div class="question">
            <h3>Reviewer Question</h3>
            <p>## Reviewer Question</p>
        </div>
        
        <div class="response">
            <h3>Our Response</h3>
            <p>We clarify our use of 'heterogeneity' as follows: (1) **Patient Heterogeneity**: Different individuals with the same disease diagnosis have different signature profiles (measured by average pairwise distance in signature space = 3.87). For example, two patients with CAD may have different metabolic vs. inflammatory signatures. (2) **Biological Heterogeneity**: Same clinical phenotype can arise from different biological pathways. For example, CAD can be driven by metabolic dysfunction, inflammation, or genetic factors. We demonstrate this through pathway analysis identifying 4 distinct pathways to myocardial infarction (progressive ischemia, hidden risk, inflammatory, metabolic). (3) **Disease Heterogeneity**: Umbrella term encompassing both patient and biological heterogeneity—the observation that 'CAD' is not a single entity but a collection of related conditions. Our model captures this through individual-specific signature loadings. We now consistently use these terms throughout the manuscript and define them in Methods.</p>
        </div>
        
        <div class="findings">
            <h3>Key Findings</h3>
            <div># R3 Q8: Heterogeneity Definition

## Reviewer Question

**Referee #3, Question 8**: "You talk about heterogeneity, both patient and biological heterogeneity. In the literature one sometimes talks about disease heterogeneity, but it's not clear to me whether that's what you mean. Please clarify what you mean by heterogeneity."

## Why This Matters

Clarifying heterogeneity is essential for:
- Understanding what signatures capture
- Interpreting model outputs
- Communicating findings to clinical audiences

## Our Approach

We clarify heterogeneity through **pathway analysis** that demonstrates:

1. **Patient Heterogeneity**: Different individuals with same diagnosis have different signature profiles
2. **Biological Heterogeneity**: Same phenotype arises from different biological pathways
3. **Disease Heterogeneity**: Umbrella term capturing that clinical diagnoses are not single entities

---

## Key Findings

✅ **4 distinct pathways** to myocardial infarction identified  
✅ **44.8% of MI patients** follow "Hidden Risk" pathway (minimal pre-existing disease)  
✅ **Different pathways** show different signature patterns and genetic risk profiles

---

## Summary & Response Text

### Key Findings

1. **Patient Heterogeneity**: Different individuals with same diagnosis show different signature profiles (average distance = 3.87)
2. **Biological Heterogeneity**: Same phenotype (MI) arises from 4 distinct pathways
3. **Disease Heterogeneity**: Clinical diagnoses are not single entities—our model captures this through individual-specific signatures

### Response to Reviewer

> "We clarify our use of 'heterogeneity' as follows: (1) **Patient Heterogeneity**: Different individuals with the same disease diagnosis have different signature profiles (measured by average pairwise distance in signature space = 3.87). For example, two patients with CAD may have different metabolic vs. inflammatory signatures. (2) **Biological Heterogeneity**: Same clinical phenotype can arise from different biological pathways. For example, CAD can be driven by metabolic dysfunction, inflammation, or genetic factors. We demonstrate this through pathway analysis identifying 4 distinct pathways to myocardial infarction (progressive ischemia, hidden risk, inflammatory, metabolic). (3) **Disease Heterogeneity**: Umbrella term encompassing both patient and biological heterogeneity—the observation that 'CAD' is not a single entity but a collection of related conditions. Our model captures this through individual-specific signature loadings. We now consistently use these terms throughout the manuscript and define them in Methods."

### References

- Pathway analysis: `heterogeneity_analysis_summary.ipynb`
- Pathway discovery: `run_complete_pathway_analysis_deviation_only.py`
</div>
        </div>
        
        <p><a href="notebooks/R3_Q8_Heterogeneity.ipynb" class="notebook-link">→ Open interactive notebook</a></p>
        
        <hr>
    </section>

    <footer>
        <p><em>For interactive analysis, see individual notebooks in the <code>notebooks/</code> directory.</em></p>
    </footer>
</body>
</html>
