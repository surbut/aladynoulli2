head(dg)
merge(diag_per_age,disease_info_phecode_icd10[,c("phecode","phenotype")],by.x="diag_icd10",by.y="phecode")->dg
head(dg)
age_sum=aou%>%group_by(age_diag)%>%summarise(length(diag_icd10))
ggplot(dg,aes(x=age_diag, y=count/age,col=code))+geom_point()+facet_wrap(~sig)
# Count cases per disease per age
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype","sig")],
by.x="diag_icd10", by.y="phecode")
head(dg)
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype","sig")],
by.x="diag_icd10", by.y="phecode")
head(df)
head(dg)
head(sigs)
merge(dg,sigs,by.x="phenotype",by.y="disease_Names")->dg
head(dg)
head(sigs)
dg$incidence = dg$count / dg$total_people
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype","sig")],
by.x="diag_icd10", by.y="phecode")
head(dg)
merge(dg,sigs,by.x="phenotype",by.y="disease_name")->dg
head(dg)
ggplot(dg, aes(x=age_diag, y=incidence, col=phenotype)) +
geom_point() +
facet_wrap(~signature)
head(dg)
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype","sig")],
by.x="diag_icd10", by.y="phecode")
# Count cases per disease per age
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype")],
by.x="diag_icd10", by.y="phecode")
# Merge with age_sum to get denominator
dg = merge(dg, age_sum, by="age_diag")
# Calculate incidence
dg$incidence = dg$count / dg$total_people
merge(dg,sigs,by.x="phenotype",by.y="disease_name")->dg
# Plot by signature
ggplot(dg, aes(x=age_diag, y=incidence, col=phenotype)) +
geom_point() +
facet_wrap(~signature)
# Filter to top diseases per signature (by max incidence)
dg_top = dg %>%
group_by(signature, phenotype) %>%
summarise(max_inc = max(incidence)) %>%
group_by(signature) %>%
top_n(7, max_inc) %>%  # Top 7 per signature
select(signature, phenotype)
dg_filtered = merge(dg, dg_top, by=c("signature", "phenotype"))
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
# Plot with lines and better legend
ggplot(dg_filtered, aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_line(size=1) +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
dg_filtered = merge(dg, dg_top, by=c("signature", "phenotype"))
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered, aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
ggplot(dg_filtered[dg_filtered$signature==0,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
head(sig)
head(sigs)
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype")],
by.x="diag_icd10", by.y="phecode")
# Merge with age_sum to get denominator
dg = merge(dg, age_sum, by="age_diag")
# Calculate incidence
dg$incidence = dg$count / dg$total_people
merge(dg,sigs,by.x="phenotype",by.y="disease_name")->dg
# Plot by signature
ggplot(dg, aes(x=age_diag, y=incidence, col=phenotype)) +
geom_point() +
facet_wrap(~signature)
# Filter to top diseases per signature (by max incidence)
dg_top = dg %>%
group_by(signature, phenotype) %>%
summarise(max_inc = max(incidence)) %>%
group_by(signature) %>%
top_n(7, max_inc) %>%  # Top 7 per signature
select(signature, phenotype)
dg_filtered = merge(dg, dg_top, by=c("signature", "phenotype"))
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==0,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Filter to top diseases per signature (by max incidence)
dg_top = dg %>%
group_by(signature, phenotype) %>%
summarise(max_inc = max(incidence)) %>%
group_by(signature) %>%
top_n(7, max_inc) %>%  # Top 7 per signature
select(signature, phenotype)
dg_filtered = merge(dg, dg_top, by=c("signature", "phenotype"))
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==16,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==0,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered, aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==2,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==3,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==4,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==0,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==10,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==11,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
%load_ext autoreload
data_path = "/Users/sarahurbut/Dropbox-Personal/aou_fromdl/"
Y=readRDS(paste0(data_path,"Y_binary.rds")
)
Y=readRDS("~/Library/CloudStorage/DB_backup_5132025941p/aou_fromdl/Y_binary.rds"
)
head(Y)
head(mgb)
head(Y)
dim(Y)
dim(aou)
aou=fread('/Users/sarahurbut/aladynoulli2/aou_icd10.csv')
head(aou)
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
a=aou[aou$eid%in%rownames(Y),]
head(a)
dim(a)
length(unique(a))
length(unique(a$eid)
)
a=aou[aou$eid%in%rownames(Y),]
write.csv(a,"~/aladynoulli2/aou_sub.csv",row.names = F)
head(a)
mgb=fread("/Users/sarahurbut/aladynoulli2/mgb_icd10.csv")
head(Mgb)
head(mgb)
length(unique(mgb$eid))
dim(Y_sub)
Y_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/Y_sub")
Y_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/Y_sub.rds")
dim(Y_sub)
mgb_icd=mgb_icd[mgb$eid%in%rownames(Y_sub)]
mgb_icd=mgb[mgb$eid%in%rownames(Y_sub)]
mgb_icd=mgb[mgb$eid%in%rownames(Y_sub),]
dim(mgb_icd)
head(mgb_icd)
length(unique(mgb_icd$eid))
write.csv(mgb_icd,"~/aladynoulli2/mgb_icd_sub.csv")
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered, aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
# Count cases per disease per age
aou=fread('/Users/sarahurbut/aladynoulli2/aou_icd10.csv')
sigs=fread("~/aladynoulli2/aou_clusters.csv")
diag_per_age = aou %>%
group_by(diag_icd10, age_diag) %>%
summarise(count = length(diag_icd10))
# Get total people at each age (denominator)
age_sum = aou %>%
group_by(age_diag) %>%
summarise(total_people = length(diag_icd10))
# Merge with disease info to get signatures
dg = merge(diag_per_age,
disease_info_phecode_icd10[,c("phecode","phenotype")],
by.x="diag_icd10", by.y="phecode")
# Merge with age_sum to get denominator
dg = merge(dg, age_sum, by="age_diag")
# Calculate incidence
dg$incidence = dg$count / dg$total_people
merge(dg,sigs,by.x="phenotype",by.y="disease_name")->dg
# Plot by signature
ggplot(dg, aes(x=age_diag, y=incidence, col=phenotype)) +
geom_point() +
facet_wrap(~signature)
# Filter to top diseases per signature (by max incidence)
dg_top = dg %>%
group_by(signature, phenotype) %>%
summarise(max_inc = max(incidence)) %>%
group_by(signature) %>%
top_n(7, max_inc) %>%  # Top 7 per signature
select(signature, phenotype)
dg_filtered = merge(dg, dg_top, by=c("signature", "phenotype"))
# Smooth the incidence (optional but helpful)
library(zoo)
dg_filtered = dg_filtered %>%
group_by(signature, phenotype) %>%
arrange(age_diag) %>%
mutate(incidence_smooth = rollmean(incidence, k=3, fill=NA, align="center"))
dg_filtered=dg_filtered[dg_filtered$age_diag>30&dg_filtered$age_diag<81,]
# Plot with lines and better legend
ggplot(dg_filtered, aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
head(Dg)
head(dg_filtered$signature)
# Plot with lines and better legend
ggplot(dg_filtered[dg_filtered$signature==0,], aes(x=age_diag, y=incidence_smooth, col=phenotype)) +
geom_smooth() +  # Use lines instead of points
facet_wrap(~signature, scales="free_y") +  # Free y-axis per signature
theme_bw() +
theme(legend.position="right",
legend.text=element_text(size=7),
axis.text.x=element_text(angle=45, hjust=1)) +
guides(col=guide_legend(ncol=1, title="Disease")) +
labs(x="Age (years)", y="Incidence Rate", title="Smoothed Incidence by Signature")
head(sigs)
head(aou)
head(aou)
dim(Y_sub)
aou=readRDS("~/Library/CloudStorage/DB_backup_5132025941p/aou_fromdl/Y_binary.rds")
write.csv(rownames(aou),"~/Library/CloudStorage/DB_backup_5132025941p/aou_fromdl/patient_names.csv")
head(aou)
dim(aou)
head(aou)
ls()
dim(mgb)
length(unique(mgb$eid))
length(unique(mgb_icd)
length(unique(mgb_icd$eid)
)
dim(Y_sub)
write.csv(rownames(Y_sub),"~/aladynoulli2/mgb_patientnames.csv")
mgb_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds
")
mgb_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds")
head(mgb_sub)
E_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/e_sub.rds")
head(E_sub)
E_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds.rds")
E_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds")
head(E_sub)
dim(E_sub)
E_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/E_for_py.rds")
dim(E_sub)
E_sub=readRDS("~/Library/CloudStorage/Dropbox-Personal/mgbbtopic/e_sub.rds")
dim(E_sub)
head(E_sub)
which(E_sub[1,]!=50)
cesnornames=fread("/Users/sarahurbut/aladynoulli2/mgb_patientnames.csv")
mgb=fread("/Users/sarahurbut/aladynoulli2/mgb_icd_sub.csv")
head(mgb)
head(cesnornames)
length(intersect(mgb$eid,cesnornames$x))
head(mgb)
mgb%>%group_by(eid)%>%summarise(max(age_diag))
max_censor=mgb%>%group_by(eid)%>%summarise(max(age_diag))
names(max_censor)=c("eid","age")
write.table(max_censor,"~/aladynoulli2/max_censor.csv")
write.table(max_censor,"~/aladynoulli2/max_censor_mgb.csv")
write.csv(max_censor,"~/aladynoulli2/max_censor_mgb.csv")
